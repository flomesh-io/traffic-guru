"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[2184],{74353:function(t,e,a){a.d(e,{Z:function(){return d}});var n=a(66252),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},i=a(33058);function r(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?Object(arguments[e]):{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})))),n.forEach((function(e){l(t,e,a[e])}))}return t}function l(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var o=function(t,e){var a=r({},t,e.attrs);return(0,n.Wm)(i.Z,r({},a,{icon:s}),null)};o.displayName="StopOutlined",o.inheritAttrs=!1;var d=o},16822:function(t,e,a){a.d(e,{Z:function(){return g}});var n=a(66252);const s={class:"statusIcon"},i={href:"javascript:void(0)"},r={key:5,class:"icon svg","aria-hidden":"true"},l=["xlink:href"];var o=a(74353),d=a(50320),c=a(70001),u=a(58721),h=a(13868),p={name:"Status",components:{StopOutlined:o.Z,LoadingOutlined:d.Z,CheckCircleFilled:c.Z,CloseCircleFilled:u.Z,WarningFilled:h.Z},props:["d"],i18n:a(89234),data(){return{iconStatus:{running:"success",pending:"pending",success:"success",stop:"stop",failed:"error",Normal:"success",Pending:"pending",Succeeded:"success",Success:"success",Completed:"success",Complete:"success",Running:"success",Warning:"warning",ImagePullBackOff:"error",ErrImagePull:"error","Init: CrashLoopBackOff":"error","Init:Error":"error","Error: ErrImagePull":"error","Back-off restarting failed container":"error"}}},computed:{status(){return this.iconStatus[this.d?this.d.status||(this.d[0]?this.d[0].status:null):"Success"]}}};var g=(0,a(83744).Z)(p,[["render",function(t,e,a,o,d,c){const u=(0,n.up)("LoadingOutlined"),h=(0,n.up)("StopOutlined"),p=(0,n.up)("CloseCircleFilled"),g=(0,n.up)("CheckCircleFilled"),m=(0,n.up)("WarningFilled"),f=(0,n.up)("a-tooltip");return(0,n.wg)(),(0,n.iD)("div",s,[(0,n.Wm)(f,{placement:"topLeft",title:a.d?a.d.message||a.d[0]&&a.d[0].message:""},{default:(0,n.w5)((()=>[(0,n._)("a",i,["pending"==c.status?((0,n.wg)(),(0,n.j4)(u,{key:0,class:"font-18 font-primary svg"})):"stop"==c.status?((0,n.wg)(),(0,n.j4)(h,{key:1,class:"danger font-18 svg"})):"error"==c.status?((0,n.wg)(),(0,n.j4)(p,{key:2,class:"danger font-18 svg"})):"success"==c.status?((0,n.wg)(),(0,n.j4)(g,{key:3,class:"font-18 success svg"})):"warning"==c.status?((0,n.wg)(),(0,n.j4)(m,{key:4,class:"font-18 svg warning"})):((0,n.wg)(),(0,n.iD)("svg",r,[(0,n._)("use",{"xlink:href":c.status},null,8,l)]))])])),_:1},8,["title"])])}],["__scopeId","data-v-5c100524"]])},62184:function(t,e,a){a.r(e),a.d(e,{default:function(){return m}});var n=a(66252),s=a(3577);const i=(t=>((0,n.dD)("data-v-0bd6d015"),t=t(),(0,n.Cn)(),t))((()=>(0,n._)("em",null," ~ ",-1))),r={key:1},l={key:2},o=["onClick"],d={key:3};a(57658);var c=a(21936),u=a(16822);const h=[{key:" ",dataIndex:"t",width:30},{key:"Type",dataIndex:"type"},{key:"as",dataIndex:"as"},{key:"time",sorter:!0,dataIndex:"updatedAt"},{key:"content",dataIndex:"content"}],p=[{key:" ",dataIndex:"t",width:30},{key:"time",sorter:!0,dataIndex:"updatedAt"},{key:"content",dataIndex:"content"}];var g={name:"EventList",components:{JsonEditor:c.Z,Status:u.Z},props:["pid","mode"],i18n:a(89234),data(){return{date:"",endDate:"",visible:!1,pageSize:10,pageNo:1,total:0,loading:!0,advanced:!0,sorter:"updatedAt",sortOrder:"end$desc",type:"l4Lb",typeOptions:[{tab:"4LB",key:"l4Lb"},{tab:"Upstream",key:"upstream"}],columns:h,embedColumns:p,list:[]}},computed:{dataColumns(){return(this.mode?this.embedColumns:this.columns).map((t=>(t.title=this.$t(t.key),t.sorter&&this.sorter==t.dataIndex&&(t.sortOrder=this.sortOrder),t)))},start(){return(this.pageNo-1)*this.pageSize}},created(){this.mode&&(this.type=this.mode),this.search()},methods:{onTabChange(t){this.type=t,this.search()},sort(t,e,a){this.sorter=a.field,this.sortOrder=a.order,this.search()},onClose(){this.visible=!1},goTarget(t,e){"l4Lb"==e&&this.$router.push({path:"/flb/4lb/detail/"+t})},detail(t){this.visible=!0,this.log=JSON.stringify(t||{})},detailInterface(t){this.visible=!0,this.log=t},search(t,e){t&&(this.pageNo=t,this.pageSize=e);let a={start:this.start,limit:this.pageSize};this.loading=!0;let n={type:{eq:this.type},isCluster:{eq:!1}};this.endDate&&(n.updatedAt={lte:this.endDate}),this.date&&(n.createdAt={gte:this.date}),this.pid&&("l4Lb"==this.type?n.l4Lb={id:{eq:this.pid}}:"upstream"==this.type&&(n.checkpoint={id:{eq:this.pid}}));let s="updatedAt:desc";this.sorter&&this.sortOrder&&(s=this.sortOrder.replace(/\$/g,""),s=s.replace(/end/g,""),s=`${this.sorter}:${s}`),this.$gql.query(`healthcheckResults(filters: $filters, pagination: $pagination, sort: "${s}"){\n\t\t\t\t\t\tdata{id,attributes{\n\t\t\t\t\t\t\tupdatedAt,\n              content,\n\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\tl4Lb{data{id,attributes{name}}},\n\t\t\t\t\t\t\tcheckpoint{data{id,attributes{name}}},\n\t\t\t\t\t\t}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}`,{filters:n,pagination:a},{filters:"HealthcheckResultFiltersInput",pagination:"PaginationArg"}).then((t=>{this.list=t.data,t.data.forEach((t=>{t.t=t.content.unhealthy.length>0?"failed":"success"})),this.total=t.pagination.total,this.loading=!1}))}}};var m=(0,a(83744).Z)(g,[["render",function(t,e,a,c,u,h){const p=(0,n.up)("a-date-picker"),g=(0,n.up)("Status"),m=(0,n.up)("a-tag"),f=(0,n.up)("a-table"),v=(0,n.up)("a-card"),k=(0,n.up)("JsonEditor"),b=(0,n.up)("a-drawer");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(v,{class:"nopd",title:a.mode?t.$t("healthcheck"):null,"tab-list":a.mode?null:u.typeOptions,"active-tab-key":u.type,loading:u.loading,onTabChange:e[8]||(e[8]=t=>h.onTabChange(t))},(0,n.Nv)({customTab:(0,n.w5)((e=>[(0,n._)("span",null,(0,s.zw)(t.$t(e.tab))+" "+(0,s.zw)(t.$t("healthcheck")),1)])),default:(0,n.w5)((()=>[(0,n._)("div",null,[(0,n.Wm)(f,{columns:h.dataColumns,"data-source":u.list,pagination:{showSizeChanger:!0,showQuickJumper:!1,onShowSizeChange:h.search,onChange:h.search,current:u.pageNo,pageSize:u.pageSize,showTotal:(e,a)=>`${t.$t("Total")} ${e}`,total:u.total},onChange:h.sort},{bodyCell:(0,n.w5)((({column:e,record:a})=>["t"===e.dataIndex?((0,n.wg)(),(0,n.j4)(g,{key:0,d:{status:a.t}},null,8,["d"])):"as"===e.dataIndex?((0,n.wg)(),(0,n.iD)("div",r,["l4Lb"==a.type?((0,n.wg)(),(0,n.j4)(m,{key:0,onClick:t=>h.goTarget(a.l4Lb.id,a.type)},{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(a.l4Lb?.name),1)])),_:2},1032,["onClick"])):"upstream"==a.type?((0,n.wg)(),(0,n.j4)(m,{key:1,onClick:t=>h.goTarget(a.l4Lb.id,a.type)},{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(a.checkpoint?.name?a.checkpoint?.name:"checkpoint"),1)])),_:2},1032,["onClick"])):(0,n.kq)("",!0)])):"content"===e.dataIndex?((0,n.wg)(),(0,n.iD)("div",l,[(0,n._)("a",{onClick:t=>h.detail(a.content)},(0,s.zw)(t.$t("detail")),9,o)])):"createdAt"===e.dataIndex?((0,n.wg)(),(0,n.iD)("div",d,(0,s.zw)(new Date(a.createdAt).toLocaleString()),1)):(0,n.kq)("",!0)])),_:1},8,["columns","data-source","pagination","onChange"])])])),_:2},[a.mode?{name:"extra",fn:(0,n.w5)((()=>[(0,n._)("div",null,[(0,n.Wm)(p,{value:u.date,"onUpdate:value":e[0]||(e[0]=t=>u.date=t),"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:t.$t("Start Date"),onChange:e[1]||(e[1]=t=>h.search())},null,8,["value","placeholder"]),i,(0,n.Wm)(p,{value:u.endDate,"onUpdate:value":e[2]||(e[2]=t=>u.endDate=t),"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:t.$t("End Date"),onChange:e[3]||(e[3]=t=>h.search())},null,8,["value","placeholder"])])])),key:"0"}:{name:"tabBarExtraContent",fn:(0,n.w5)((()=>[(0,n._)("div",null,[(0,n.Wm)(p,{value:u.date,"onUpdate:value":e[4]||(e[4]=t=>u.date=t),"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:t.$t("Start Date"),onChange:e[5]||(e[5]=t=>h.search())},null,8,["value","placeholder"]),(0,n._)("em",null," ~ "),(0,n.Wm)(p,{value:u.endDate,"onUpdate:value":e[6]||(e[6]=t=>u.endDate=t),"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:t.$t("End Date"),onChange:e[7]||(e[7]=t=>h.search())},null,8,["value","placeholder"])])])),key:"1"}]),1032,["title","tab-list","active-tab-key","loading"]),u.visible?((0,n.wg)(),(0,n.j4)(b,{key:0,"get-container":!1,title:t.$t("content"),placement:"bottom",height:"600",closable:!1,visible:u.visible,onClose:h.onClose},{default:(0,n.w5)((()=>[(0,n.Wm)(k,{"is-readonly":!0,value:t.log},null,8,["value"])])),_:1},8,["title","visible","onClose"])):(0,n.kq)("",!0)])}],["__scopeId","data-v-0bd6d015"]])}}]);