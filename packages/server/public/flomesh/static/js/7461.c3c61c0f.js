"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[7461],{9280:function(t,e,a){a.d(e,{Z:function(){return u}});var s=a(66252);const l=(0,s._)("div",{id:"DataChart",class:"height-500"},null,-1),i=(0,s._)("div",{id:"PercentilesChart",class:"height-500"},null,-1);a(57658);var n=a(21936);function o(t,e){let a=document.getElementById(t.id);a&&e.dispose(a);let s,l=e.init(a);s={title:{text:t.title},tooltip:t.tooltip,legend:{data:t.legend},grid:{left:"3%",right:"4%",bottom:t.hasZoom?"60px":"10px",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},dataZoom:t.hasZoom?[{type:"slider",start:0,end:100,labelFormatter:function(e){return Math.ceil(100*e/t.xAxisLength)+"%"}}]:null,xAxis:t.xAxis,yAxis:{boundaryGap:!0,name:t.yAxis.name,type:"value"},series:t.series},s&&"object"==typeof s&&l.setOption(s)}var r={name:"TestReportContent",i18n:a(89234),components:{JsonEditor:n.Z},props:["reports"],data(){return{}},computed:{logStringify(){return this.reports?JSON.stringify(this.reports):"{}"}},mounted(){let t=[];this.reports.forEach((e=>{1==e.status&&t.push(e.content)})),function(t,e){let a=[],s=[],l=[];t&&t.forEach((t=>{if(t.DurationHistogram&&t.DurationHistogram.Percentiles){l=[];let e=[];e.push({value:0}),l.push(0),t.DurationHistogram.Percentiles.forEach((t=>{e.push({value:1e3*t.Value}),l.push(t.Percentile)}));let i=`pipy-${t.StartTime.split(".")[0]}`;s.push(i),a.push({name:i,type:"line",areaStyle:{},smooth:!0,data:e})}})),o({id:"PercentilesChart",title:"Latency P99",legend:s,tooltip:{trigger:"axis"},xAxis:{data:l,name:"(%)",boundaryGap:!1,type:"category"},yAxis:{name:"(ms)"},series:a},e)}(t,this.$echarts),function(t,e){let a=[],s=[],l=0;t&&t.forEach((t=>{if(t.DurationHistogram&&t.DurationHistogram.Data){let e=[];t.DurationHistogram.Data.forEach((t=>{let a=Math.ceil(1e3*t.Start),s=Math.ceil(1e3*t.End);e.push({type:"start",value:[a,t.Count],start:a,end:s,lantency:s-a,count:t.Count,percent:Math.ceil(t.Percent)}),e.push({type:"end",value:[s,t.Count],start:a,end:s,lantency:s-a,count:t.Count,percent:Math.ceil(t.Percent)}),l<s&&(l=s)}));let i=`pipy-${t.StartTime.split(".")[0]}`;s.push(i),a.push({name:i,type:"line",symbol:"none",areaStyle:{},smooth:!1,data:e})}})),o({id:"DataChart",title:"TPS",hasZoom:!0,legend:s,tooltip:{trigger:"axis",formatter:function(t){let e="";return t.forEach((t=>{"end"==t.data.type&&(e+=`<span style="background:${t.color};width:10px;height:10px;display:inline-block;margin-right:10px"></span>${t.data.start}ms ~ ${t.data.end}ms (${t.data.lantency}ms) / ${t.data.count} (${t.data.percent}%)<br/>`)})),e}},xAxisLength:l,xAxis:{name:"(ms)",max:l,type:"value"},yAxis:{},series:a},e)}(t,this.$echarts)},methods:{}};var u=(0,a(83744).Z)(r,[["render",function(t,e,a,n,o,r){const u=(0,s.up)("a-col"),d=(0,s.up)("a-row"),c=(0,s.up)("a-tab-pane"),p=(0,s.up)("JsonEditor"),h=(0,s.up)("a-tabs");return a.reports&&a.reports.length>0?((0,s.wg)(),(0,s.j4)(h,{key:0,type:"card"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{key:"1",tab:t.$t("Overview")},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{class:"row-mg"},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{class:"col-pd",xl:24,lg:24,md:24,sm:24,xs:24},{default:(0,s.w5)((()=>[l,i])),_:1})])),_:1})])),_:1},8,["tab"]),(0,s.Wm)(c,{key:"2",tab:t.$t("log")},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{"is-readonly":!0,value:r.logStringify},null,8,["value"])])),_:1},8,["tab"])])),_:1})):(0,s.kq)("",!0)}]])},77461:function(t,e,a){a.r(e),a.d(e,{default:function(){return A}});var s=a(66252),l=a(3577);const i={class:"search-input"},n={class:"form-row"},o={class:"content flex"},r={class:"flex-item"},u={class:"label"},d=(t=>((0,s.dD)("data-v-48a41a01"),t=t(),(0,s.Cn)(),t))((()=>(0,s._)("em",null," ~ ",-1))),c={class:"content"},p={class:"flex"},h={class:"flex-item"},m=["onClick"],g={class:"flex-item"},f=["onClick"],v={class:"flex-item"},w={key:0},_={key:1},y={key:2},b={class:"flex-item"},x={class:"flex-item"},$={class:"font-right"};a(57658);var k=a(9280),C=a(50320),D=a(13471),W=a(2692),T=a(33907),S=a(61103),z={name:"TestcaseList",i18n:a(89234),components:{LoadingOutlined:C.Z,PageLayout:S.Z,FieldTimeOutlined:D.Z,MoreOutlined:W.Z,TestReportContent:k.Z},data(){return{selectTR:[],selectReports:[],date:"",log:"{}",arrow:"desc",visible:!1,endDate:"",sortBy:"timestamp",prefix:" ",key:"",loading:!0,timeoutCnt:1,pageNo:1,pageSize:10,total:0,testresults:[]}},computed:{...(0,T.rn)("setting",["layout","pageWidth"]),start(){return(this.pageNo-1)*this.pageSize}},created(){this.search(),this.timer()},methods:{remove(t){this.$gql.mutation(`deleteTestresult(id:${t}){data{id}}`).then((()=>{this.$message.success(this.$t("Deleted successfully"),3),this.search()}))},previewAlone(t){this.selectReports=[t],this.visible=!0},preview(){this.selectReports=[],this.selectTR.forEach((t=>{this.testresults.forEach((e=>{e.id==t&&(this.selectReports.push(e),this.visible=!0)}))}))},timer(){setTimeout((()=>{this.search(null,null,null,!0),this.timer(),this.timeoutCnt++}),2e3*this.timeoutCnt)},search(t,e,a,s){this.pageNo=t||1,s||(this.loading=!0);let l={};this.key&&(l.id={eq:this.key}),this.endDate&&(l.updatedAt={lte:this.endDate}),this.date&&(l.createdAt={gte:this.date}),this.$gql.query(`testresults(sort: "testcase.id:DESC,id:DESC", filters: $filters, pagination:{start: ${this.start}, limit: ${this.pageSize}}){\n\t\t\t\t\t\tdata{id,attributes{status,testcase{data{id,attributes{name,content,updatedAt}}},content,createdAt,updatedAt}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}`,{filters:l},{filters:"TestresultFiltersInput"}).then((t=>{this.testresults=t.data,this.total=t.pagination.total,this.loading=!1}))},add(){this.$router.push({path:"/inspector/testcase/create"})},detail(t){this.$router.push({path:"/inspector/testcase/detail/"+t})},onClose(){this.visible=!1}}};var A=(0,a(83744).Z)(z,[["render",function(t,e,a,k,C,D){const W=(0,s.up)("a-input-search"),T=(0,s.up)("a-date-picker"),S=(0,s.up)("a-form-item"),z=(0,s.up)("a-form"),A=(0,s.up)("a-card"),R=(0,s.up)("a-button"),E=(0,s.up)("a-checkbox"),P=(0,s.up)("LoadingOutlined"),Z=(0,s.up)("a-badge"),H=(0,s.up)("FieldTimeOutlined"),L=(0,s.up)("a-popconfirm"),M=(0,s.up)("a-menu-item"),Y=(0,s.up)("a-menu"),O=(0,s.up)("MoreOutlined"),U=(0,s.up)("a-dropdown"),q=(0,s.up)("a-list-item"),N=(0,s.up)("a-list"),j=(0,s.up)("a-checkbox-group"),F=(0,s.up)("TestReportContent"),I=(0,s.up)("a-modal"),J=(0,s.up)("PageLayout");return(0,s.wg)(),(0,s.j4)(J,{title:t.$t("Test Report"),"hide-breadcrumb":!0},{headerContent:(0,s.w5)((()=>[(0,s._)("div",{class:(0,l.C_)(["search-head",t.layout,t.pageWidth])},[(0,s._)("div",i,[(0,s.Wm)(W,{value:C.key,"onUpdate:value":e[0]||(e[0]=t=>C.key=t),class:"search-ipt",onSearch:e[1]||(e[1]=t=>D.search()),placeholder:t.$t("Please input")+"...",size:"large"},null,8,["value","placeholder"])]),(0,s.Wm)(A,{bordered:!1,class:"search-form"},{default:(0,s.w5)((()=>[(0,s.Wm)(z,null,{default:(0,s.w5)((()=>[(0,s._)("div",n,[(0,s._)("div",o,[(0,s._)("div",r,[(0,s.Wm)(S,null,{default:(0,s.w5)((()=>[(0,s._)("span",u,[(0,s._)("span",null,(0,l.zw)(t.$t("Time screening")),1)]),(0,s.Wm)(T,{value:C.date,"onUpdate:value":e[2]||(e[2]=t=>C.date=t),"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:t.$t("Start Date"),onChange:e[3]||(e[3]=t=>D.search())},null,8,["value","placeholder"]),d,(0,s.Wm)(T,{value:C.endDate,"onUpdate:value":e[4]||(e[4]=t=>C.endDate=t),"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:t.$t("End Date"),onChange:e[5]||(e[5]=t=>D.search())},null,8,["value","placeholder"])])),_:1})])])])])),_:1})])),_:1})],2)])),default:(0,s.w5)((()=>[(0,s.Wm)(A,{class:"search-content",loading:C.loading},{extra:(0,s.w5)((()=>[(0,s.Wm)(R,{onClick:D.preview,type:"primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(t.$t("Preview")),1)])),_:1},8,["onClick"])])),default:(0,s.w5)((()=>[(0,s.Wm)(j,{value:C.selectTR,"onUpdate:value":e[6]||(e[6]=t=>C.selectTR=t),class:"full"},{default:(0,s.w5)((()=>[(0,s.Wm)(N,{"item-layout":"vertical",pagination:{showSizeChanger:!1,showQuickJumper:!1,onShowSizeChange:D.search,onChange:D.search,current:C.pageNo,pageSize:C.pageSize,showTotal:(e,a)=>`${t.$t("Total")} ${e}`,total:C.total}},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(C.testresults,((e,a)=>((0,s.wg)(),(0,s.j4)(q,{key:a},{default:(0,s.w5)((()=>[(0,s._)("div",c,[(0,s._)("div",p,[(0,s._)("div",h,[(0,s._)("div",null,[(0,s._)("b",null,(0,l.zw)(t.$t("Testcase")),1),(0,s.Uk)(" : "),(0,s._)("a",{onClick:t=>D.detail(e.testcase.id)},[(0,s._)("b",null,(0,l.zw)(e.testcase.name),1)],8,m)])]),(0,s._)("div",g,[(0,s._)("div",null,[C.testresults.length>1?((0,s.wg)(),(0,s.j4)(E,{key:0,disabled:1!=e.status,value:e.id,class:"mr-10"},null,8,["disabled","value"])):(0,s.kq)("",!0),(0,s._)("a",{onClick:t=>D.previewAlone(e)},[(0,s._)("b",null,"#"+(0,l.zw)(e.id),1)],8,f)])]),(0,s._)("div",v,[(0,s._)("div",null,[0==e.status?((0,s.wg)(),(0,s.iD)("span",w,[(0,s.Wm)(P,{class:"font-primary"}),(0,s.Uk)(" "+(0,l.zw)(t.$t("Running")),1)])):null!=e.status?((0,s.wg)(),(0,s.iD)("span",_,[(0,s.Wm)(Z,{color:["red","processing","green"][e.status+1],text:t.$t(["Failed","Running","Done"][e.status+1])},null,8,["color","text"])])):((0,s.wg)(),(0,s.iD)("span",y,"="))])]),(0,s._)("div",b,[(0,s._)("div",null,[(0,s._)("b",null,(0,l.zw)(t.$t("Target")),1),(0,s.Uk)(" : "),(0,s._)("span",null,(0,l.zw)(e.from||"-"),1)])]),(0,s._)("div",x,[(0,s._)("div",null,[(0,s.Wm)(H),(0,s._)("span",null,(0,l.zw)(new Date(e.updatedAt).toLocaleString()),1)])]),(0,s._)("div",$,[(0,s._)("div",null,[(0,s.Wm)(U,null,{overlay:(0,s.w5)((()=>[(0,s.Wm)(Y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(M,null,{default:(0,s.w5)((()=>[(0,s.Wm)(L,{placement:"topLeft","ok-text":t.$t("Yes"),"cancel-text":t.$t("No"),onConfirm:t=>D.remove(e.id)},{title:(0,s.w5)((()=>[(0,s._)("p",null,(0,l.zw)(t.$t("Tip")),1),(0,s._)("p",null,(0,l.zw)(t.$t("Are you sure to delete this?")),1)])),default:(0,s.w5)((()=>[(0,s._)("a",null,(0,l.zw)(t.$t("delete")),1)])),_:2},1032,["ok-text","cancel-text","onConfirm"])])),_:2},1024)])),_:2},1024)])),default:(0,s.w5)((()=>[(0,s._)("a",null,[(0,s.Wm)(O)])])),_:2},1024)])])])])])),_:2},1024)))),128))])),_:1},8,["pagination"])])),_:1},8,["value"])])),_:1},8,["loading"]),(0,s.Wm)(I,{"destroy-on-close":!0,visible:C.visible,"onUpdate:visible":e[7]||(e[7]=t=>C.visible=t),title:t.$t("Test Report Detail"),footer:null,width:"70%"},{default:(0,s.w5)((()=>[(0,s.Wm)(F,{reports:C.selectReports},null,8,["reports"])])),_:1},8,["visible","title"])])),_:1},8,["title"])}],["__scopeId","data-v-48a41a01"]])}}]);