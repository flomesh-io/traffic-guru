"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[5191],{60300:function(t,e,i){i.d(e,{Z:function(){return o}});var a=i(66252),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"},s=i(33058);function n(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?Object(arguments[e]):{},a=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),a.forEach((function(e){d(t,e,i[e])}))}return t}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var r=function(t,e){var i=n({},t,e.attrs);return(0,a.Wm)(s.Z,n({},i,{icon:l}),null)};r.displayName="DatabaseOutlined",r.inheritAttrs=!1;var o=r},14941:function(t,e,i){i.d(e,{Z:function(){return o}});var a=i(66252),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M957.6 507.4L603.2 158.2a7.9 7.9 0 00-11.2 0L353.3 393.4a8.03 8.03 0 00-.1 11.3l.1.1 40 39.4-117.2 115.3a8.03 8.03 0 00-.1 11.3l.1.1 39.5 38.9-189.1 187H72.1c-4.4 0-8.1 3.6-8.1 8V860c0 4.4 3.6 8 8 8h344.9c2.1 0 4.1-.8 5.6-2.3l76.1-75.6 40.4 39.8a7.9 7.9 0 0011.2 0l117.1-115.6 40.1 39.5a7.9 7.9 0 0011.2 0l238.7-235.2c3.4-3 3.4-8 .3-11.2zM389.8 796.2H229.6l134.4-133 80.1 78.9-54.3 54.1zm154.8-62.1L373.2 565.2l68.6-67.6 171.4 168.9-68.6 67.6zM713.1 658L450.3 399.1 597.6 254l262.8 259-147.3 145z"}}]},name:"highlight",theme:"outlined"},s=i(33058);function n(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?Object(arguments[e]):{},a=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),a.forEach((function(e){d(t,e,i[e])}))}return t}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var r=function(t,e){var i=n({},t,e.attrs);return(0,a.Wm)(s.Z,n({},i,{icon:l}),null)};r.displayName="HighlightOutlined",r.inheritAttrs=!1;var o=r},50128:function(t,e,i){i.d(e,{Z:function(){return o}});var a=i(66252),l=i(3577);const s={class:"mini-chart"},n=["id"];i(57658);var d=i(85263),r={name:"MiniBar",props:["dv","id","axis","height","colors","stack","ver","unit"],data(){return{id2:Math.ceil(1e3*Math.random()),isMounted:!1,simpleImage:d.Z.PRESENTED_IMAGE_SIMPLE}},computed:{...(0,i(33907).rn)("setting",["lang"])},watch:{lang(t){this.$i18n.locale=t},dv(){this.isMounted&&setTimeout((()=>{this.renderChart()}),100)},ver(){this.isMounted&&setTimeout((()=>{this.renderChart()}),100)}},mounted(){this.isMounted=!0,this.$i18n.locale=this.lang,this.renderChart()},methods:{getLegend(){let t={};return this.dv.forEach((e=>{t[e.type]=e.type})),Object.keys(t)},getXAxis(){let t={};return this.dv.forEach((e=>{t[e.date]=e.date})),Object.keys(t).sort()},getSeriesValue(){let t={};return this.dv.forEach((e=>{t[e.date]||(t[e.date]={}),e.itemStyle?t[e.date][e.type]={value:e.value,itemStyle:e.itemStyle}:t[e.date][e.type]=e.value})),t},getSeries(t,e){let i=this.getSeriesValue(),a=[];return t.forEach((t=>{let l=[];e.forEach((e=>{l.push(i[e][t]||0)}));let s={name:t,type:"bar",smooth:!0,areaStyle:{},emphasis:{focus:"series"},data:l};this.stack&&(s.stack=this.stack),a.push(s)})),a},renderChart(){let t=this.getLegend(),e=this.getXAxis(),i=this.getSeries(t,e),a=document.getElementById(this.id+this.id2);a&&this.$echarts.dispose(a);let l=this.$echarts.init(a);l.showLoading();let s={color:this.colors?this.colors:["rgba(0, 137, 237,0.7)","rgba(255, 157, 77,0.7)","rgba(90, 216, 166,0.7)","rgba(227, 137, 163,0.7)","rgba(146, 112, 202,0.7)"],tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:t,show:!1},toolbox:{},grid:{top:"0px",right:"10px",left:"30px",bottom:"0px"},xAxis:[{axisLabel:{backgroundColor:"rgba(240,240,240,0.7)",padding:[2,3,2,3],textStyle:{color:"#6a7985"},inside:!0,borderRadius:2,minInterval:20},data:e,axisTick:{show:!1},axisLine:{show:!1},z:10}],yAxis:[{show:!!this.axis,type:"value",axisLabel:this.axis?{formatter:t=>""+t+(this.unit?this.unit:"")}:{showMinLabel:!1,showMaxLabel:!1,inside:!0,margin:-30,backgroundColor:"rgba(240,240,240,0.7)",padding:[2,3,2,3],textStyle:{color:"#6a7985"},formatter:t=>""+t+(this.unit?this.unit:"")}}],series:i};l.setOption(s,{lazyUpdate:!0}),l.hideLoading()}}};var o=(0,i(83744).Z)(r,[["render",function(t,e,i,d,r,o){const p=(0,a.up)("a-empty");return(0,a.wg)(),(0,a.iD)("div",s,[i.dv&&0!=i.dv.length?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(p,{key:0,image:r.simpleImage,description:""},null,8,["image"])),(0,a._)("div",{ref:i.id,class:"chart-content full",id:i.id+r.id2,style:(0,l.j5)({height:i.height?i.height+"px":"100px"})},null,12,n)])}],["__scopeId","data-v-64c489b5"]])},49568:function(t,e,i){i.d(e,{Z:function(){return p}});var a=i(66252),l=i(3577);const s={class:"mini-chart"},n={class:"absolute full mt-10"},d=["id"];i(57658);var r=i(85263),o={name:"MiniSector",props:["dv","noEmpty","id","height","padding","colors","ver"],data(){return{id2:Math.ceil(1e3*Math.random()),isMounted:!1,simpleImage:r.Z.PRESENTED_IMAGE_SIMPLE}},computed:{...(0,i(33907).rn)("setting",["lang"])},watch:{lang(t){this.$i18n.locale=t},dv(){this.isMounted&&setTimeout((()=>{this.renderChart()}),100)},ver(){this.isMounted&&setTimeout((()=>{this.renderChart()}),100)}},mounted(){this.isMounted=!0,this.$i18n.locale=this.lang,setTimeout((()=>{this.renderChart()}),100)},methods:{getSeries(){let t=[];return t.push({type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"40",fontWeight:"bold"}},labelLine:{show:!1},data:this.dv}),t},renderChart(){let t=this.getSeries(),e=document.getElementById(this.id+this.id2);e&&this.$echarts.dispose(e);let i=this.$echarts.init(e);i.showLoading();let a={color:this.colors?this.colors:["rgba(0, 137, 237,0.7)","rgba(255, 157, 77,0.7)","rgba(90, 216, 166,0.7)","rgba(227, 137, 163,0.7)","rgba(146, 112, 202,0.7)"],tooltip:{trigger:"item"},legend:{show:!0,orient:"vertical",right:"right",formatter:function(t){return t.length>10?t.substr(0,10)+"...":t}},toolbox:{},grid:{left:this.padding?this.padding[3]:0,right:this.padding?this.padding[1]:0,bottom:this.padding?this.padding[2]:0,top:this.padding?this.padding[0]:0,containLabel:!0},series:t};i.setOption(a,{lazyUpdate:!0}),i.hideLoading()}}};var p=(0,i(83744).Z)(o,[["render",function(t,e,i,r,o,p){const c=(0,a.up)("a-empty");return(0,a.wg)(),(0,a.iD)("div",s,[(0,a._)("div",n,[i.dv&&0!=i.dv.length||i.noEmpty?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(c,{key:0,image:o.simpleImage,description:""},null,8,["image"]))]),(0,a._)("div",{ref:i.id,class:"chart-content full",id:i.id+o.id2,style:(0,l.j5)({height:i.height?i.height+"px":"200px"})},null,12,d)])}],["__scopeId","data-v-51a6e4be"]])},1299:function(t,e,i){i.d(e,{Z:function(){return d}});var a=i(66252),l=i(3577);const s={key:0,class:"title"};var n={name:"DetailList",props:{title:{type:String,required:!1,default:""},col:{type:Number,required:!1,default:3},size:{type:String,required:!1,default:"large"},layout:{type:String,required:!1,default:"horizontal"}}};var d=(0,i(83744).Z)(n,[["render",function(t,e,i,n,d,r){const o=(0,a.up)("a-row");return(0,a.wg)(),(0,a.iD)("div",{class:(0,l.C_)(["detail-list","small"===i.size?"small":"large","vertical"===i.layout?"vertical":"horizontal"]),style:(0,l.j5)("flex-"+i.col)},[i.title?((0,a.wg)(),(0,a.iD)("div",s,(0,l.zw)(i.title),1)):(0,a.kq)("",!0),(0,a.Wm)(o,null,{default:(0,a.w5)((()=>[(0,a.WI)(t.$slots,"default")])),_:3})],6)}]])},13589:function(t,e,i){i.d(e,{Z:function(){return r}});var a=i(66252),l=i(3577);const s={class:"detail-content"};const n={1:{xs:24},2:{xs:24,sm:12},3:{xs:24,sm:12,md:8},4:{xs:24,sm:12,md:6}};var d={name:"DetailListItem",i18n:i(39945),props:{name:{type:String,required:!1,default:""},rules:{type:Array,required:!1,default(){return[]}},term:{type:String,required:!1,default:""},termTop:{type:Boolean}},data(){return{col:2,responsive:n}},computed:{getRules(){return this.rules.map((t=>(t.message=this.$t(t.message),t))),this.rules}},created(){this.$parent&&this.$parent.$parent&&this.$parent.$parent.col>0&&(this.col=this.$parent.$parent.col)},methods:{}};var r=(0,i(83744).Z)(d,[["render",function(t,e,i,n,d,r){const o=(0,a.up)("a-form-item"),p=(0,a.up)("a-col");return(0,a.wg)(),(0,a.j4)(p,(0,a.dG)({class:"detail-list-content flex"},d.responsive[d.col]),{default:(0,a.w5)((()=>[(0,a._)("div",{class:(0,l.C_)(i.termTop?"term top":"term")},(0,l.zw)(i.term),3),(0,a._)("div",s,[i.rules?((0,a.wg)(),(0,a.j4)(o,{key:0,name:i.name,rules:r.getRules},{default:(0,a.w5)((()=>[(0,a.WI)(t.$slots,"default")])),_:3},8,["name","rules"])):(0,a.WI)(t.$slots,"default",{key:1})])])),_:3},16)}]])},71900:function(t,e,i){i.d(e,{Z:function(){return d}});var a=i(66252),l=i(3577);const s={class:"head-info"};var n={name:"HeadInfo",props:["title","content"]};var d=(0,i(83744).Z)(n,[["render",function(t,e,i,n,d,r){return(0,a.wg)(),(0,a.iD)("div",s,[(0,a._)("span",null,(0,l.zw)(i.title),1),(0,a._)("p",null,[(0,a.Uk)((0,l.zw)(i.content),1),(0,a.WI)(t.$slots,"body",{},void 0,!0)])])}],["__scopeId","data-v-00006846"]])},18743:function(t,e,i){i.r(e),i.d(e,{default:function(){return ct}});var a=i(66252),l=i(3577);const s={key:0},n={key:1,class:"gray"},d={class:"absolute",style:{right:"0"}},r=["onClick"],o={key:0},p={key:1,class:"width-80"};i(57658);var c=i(96486),u=i.n(c),h=i(49702),m=i(60300),g=i(54367),y=i(62611),v=i(61103),f=i(1299),w=i(33907),b=i(71900),k=i(13589);const $={class:"mb-3"},_=(t=>((0,a.dD)("data-v-1bfc6ca1"),t=t(),(0,a.Cn)(),t))((()=>(0,a._)("svg",{class:"card-avatar icon","aria-hidden":"true"},[(0,a._)("use",{"xlink:href":"#icon-certificate"})],-1))),S={key:0,class:"meta-content"},W={key:1,class:"meta-content"};var A=i(99684),x=i(69596),C=i(50976),j=i(79332),L={name:"IdentifierList",i18n:i(89234),components:{PlusCircleTwoTone:A.Z,CardList:x.Z,AutoForm:C.Z,FormItem:j.Z},props:["col","title","identifiers"],data(){return{visible:!1,identifiersVals:{},identityTypes:[],payload:{type:null,name:"",content:""},isEdit:!1,loading:!0,identityKey:""}},computed:{...(0,w.rn)("rules",["rules"])},watch:{identifiersVals:{deep:!0,handler(){this.$emit("update:identifiers",this.identifiersVals)}},identifiers:{deep:!0,immediate:!0,handler(){}}},created(){},mounted(){this.$gql.query('systemSettings(filters:{type:{eq:"Identifier"}}){data{id,attributes{mode,content}}}').then((t=>{this.identityTypes=t.data[0].content,this.identityKey=t.data[0].content[0].value}))},methods:{setting(t,e,i){this.payload=u().cloneDeep(i),this.payload.type=e,this.payload.index=t,this.isEdit=!0,this.visible=!0},remove(t,e){this.identifiersVals=this.identifiers,this.identifiersVals[e].splice(t,1),this.$emit("identifierSave")},showModal(){this.visible=!0,this.isEdit=!1,this.payload.type=this.identityKey,this.identityTypes.forEach((t=>{t.value==this.payload.type&&(this.payload.content={fields:t.fields})}))},renderCallback(){this.identityTypes.forEach((t=>{t.value==this.payload.type&&(this.payload.content={fields:t.fields})}))},valid(){this.$refs.form.validateFields().then((()=>{this.handleOk()})).catch((()=>{}))},handleOk(){this.identifiersVals=this.identifiers,this.identifiersVals[this.payload.type]=this.identifiersVals[this.payload.type]?this.identifiersVals[this.payload.type]:[],this.isEdit?this.identifiersVals[this.payload.type][this.payload.index]={name:this.payload.name,content:this.payload.content}:this.identifiersVals[this.payload.type].push({name:this.payload.name,content:this.payload.content}),this.payload={type:null,name:"",content:""},this.visible=!1,this.$emit("identifierSave")},onTabChange(t){}}},E=i(83744);var I=(0,E.Z)(L,[["render",function(t,e,i,s,n,d){const r=(0,a.up)("PlusCircleTwoTone"),o=(0,a.up)("a-button"),p=(0,a.up)("a-tag"),c=(0,a.up)("a-space"),u=(0,a.up)("a-card-meta"),h=(0,a.up)("CardList"),m=(0,a.up)("a-tab-pane"),g=(0,a.up)("a-tabs"),y=(0,a.up)("a-card"),v=(0,a.up)("a-select-option"),f=(0,a.up)("a-select"),w=(0,a.up)("a-descriptions-item"),b=(0,a.up)("a-input"),k=(0,a.up)("FormItem"),A=(0,a.up)("AutoForm"),x=(0,a.up)("a-textarea"),C=(0,a.up)("a-descriptions"),j=(0,a.up)("a-form"),L=(0,a.up)("a-modal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(y,{title:i.title,class:"card identifier-card",bordered:!1},{extra:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(o,{type:"link",shape:"circle",onClick:d.showModal},{icon:(0,a.w5)((()=>[(0,a.Wm)(r,{class:"PlusCircleTwoTone icon-menu-sm rotate-icon"})])),_:1},8,["onClick"])])])),default:(0,a.w5)((()=>[(0,a.Wm)(g,{activeKey:n.identityKey,"onUpdate:activeKey":e[0]||(e[0]=t=>n.identityKey=t),"tab-position":"left"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.identityTypes,(e=>((0,a.wg)(),(0,a.j4)(m,{key:e.value,tab:t.$t(e.label)},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{col:i.col,"hide-action-title":!0,"data-source":i.identifiers[e.value]||[],type:e.value,loading:!1,actions:[{icon:"EditOutlined",text:t.$t("edit"),call:d.setting},{icon:"CloseOutlined",hide:!0,text:t.$t("delete"),call:d.remove}]},{default:(0,a.w5)((({item:t})=>[(0,a.Wm)(u,null,{title:(0,a.w5)((()=>[(0,a._)("div",$,(0,l.zw)(t.name),1)])),avatar:(0,a.w5)((()=>[_])),description:(0,a.w5)((()=>[t.content.fields?((0,a.wg)(),(0,a.iD)("div",S,[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.content.fields,((t,e)=>((0,a.wg)(),(0,a.iD)("span",{key:e},[t.value?((0,a.wg)(),(0,a.j4)(p,{key:0},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(t.label)+":"+(0,l.zw)("password"==t.type?t.value.replace(/./g,"*"):t.value),1)])),_:2},1024)):(0,a.kq)("",!0)])))),128))])),_:2},1024)])):((0,a.wg)(),(0,a.iD)("div",W,(0,l.zw)(t.content),1))])),_:2},1024)])),_:2},1032,["col","data-source","type","actions"])])),_:2},1032,["tab"])))),128))])),_:1},8,["activeKey"])])),_:1},8,["title"]),(0,a.Wm)(L,{visible:n.visible,"onUpdate:visible":e[4]||(e[4]=t=>n.visible=t),title:t.$t("Identity"),onOk:d.valid,width:"50%","ok-text":n.isEdit?t.$t("Save"):t.$t("create")},{default:(0,a.w5)((()=>[(0,a.Wm)(j,{model:n.payload,"wrapper-col":{span:24},ref:"form"},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{label:t.$t("Type"),span:3},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{disabled:n.isEdit,placeholder:t.$t("unset"),class:"width-200",value:n.payload.type,"onUpdate:value":e[1]||(e[1]=t=>n.payload.type=t),onChange:d.renderCallback},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.identityTypes,((e,i)=>((0,a.wg)(),(0,a.j4)(v,{key:i,value:e.value},{default:(0,a.w5)((()=>[(0,a._)("span",null,(0,l.zw)(t.$t(e.label)),1)])),_:2},1032,["value"])))),128))])),_:1},8,["disabled","placeholder","value","onChange"])])),_:1},8,["label"]),(0,a.Wm)(w,{label:t.$t("as"),span:3},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{name:"name",rules:t.rules.name},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{placeholder:t.$t("unset"),value:n.payload.name,"onUpdate:value":e[2]||(e[2]=t=>n.payload.name=t),class:"width-300"},null,8,["placeholder","value"])])),_:1},8,["rules"])])),_:1},8,["label"]),(0,a.Wm)(w,{label:t.$t("content"),span:3},{default:(0,a.w5)((()=>[n.payload.content.fields?((0,a.wg)(),(0,a.j4)(A,{key:0,col:i.col,fields:[n.payload.content.fields]},null,8,["col","fields"])):((0,a.wg)(),(0,a.j4)(x,{key:1,value:n.payload.content,"onUpdate:value":e[3]||(e[3]=t=>n.payload.content=t),placeholder:"User:Password / Token / JWT","allow-clear":"",rows:14},null,8,["value"]))])),_:1},8,["label"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title","onOk","ok-text"])],64)}],["__scopeId","data-v-1bfc6ca1"]]);const z={class:"mb-3"},D=(t=>((0,a.dD)("data-v-a514a356"),t=t(),(0,a.Cn)(),t))((()=>(0,a._)("svg",{class:"card-avatar icon","aria-hidden":"true"},[(0,a._)("use",{"xlink:href":"#icon-certificate"})],-1))),O={key:0,class:"meta-content"},q={key:1,class:"meta-content"};var T={name:"RatelimitingList",i18n:i(89234),components:{PlusCircleTwoTone:A.Z,CardList:x.Z,AutoForm:C.Z,FormItem:j.Z},props:["col","title","ratelimitings"],data(){return{visible:!1,ratelimitingVals:{},ratelimitingTypes:[],payload:{type:null,name:"",key:"",content:""},isEdit:!1,loading:!0,ratelimitingKey:""}},computed:{...(0,w.rn)("rules",["rules"])},watch:{ratelimitingVals:{deep:!0,handler(){this.$emit("update:ratelimitings",this.ratelimitingVals)}},ratelimitings:{deep:!0,immediate:!0,handler(){}}},created(){},mounted(){this.$gql.query('systemSettings(filters:{type:{eq:"Identifier"}}){data{id,attributes{mode,content}}}').then((()=>{this.ratelimitingTypes=[{label:"Header",value:"header",name:"",key:"",fields:[{name:"enable",type:"select",label:"Enable",value:"true",options:[{label:"ON",value:"true"},{label:"OFF",value:"false"}]},{name:"limit",type:"number",label:"Limit",value:""},{name:"maxWait",type:"number",label:"Max Wait",value:""},{name:"sync_rate",type:"number",label:"Sync Rate",value:""}]}],this.ratelimitingKey="header"}))},methods:{setting(t,e,i){this.payload=u().cloneDeep(i),this.payload.type=e,this.payload.index=t,this.isEdit=!0,this.visible=!0},remove(t,e){this.ratelimitingVals=this.ratelimitings,this.ratelimitingVals[e].splice(t,1),this.$emit("ratelimitingSave")},showModal(){this.visible=!0,this.isEdit=!1,this.payload.type=this.ratelimitingKey,this.ratelimitingTypes.forEach((t=>{t.value==this.payload.type&&(this.payload.name="",this.payload.key="",this.payload.content={fields:t.fields})}))},renderCallback(){this.ratelimitingTypes.forEach((t=>{t.value==this.payload.type&&(this.payload.content={fields:t.fields})}))},valid(){this.$refs.form.validateFields().then((()=>{this.handleOk()})).catch((()=>{}))},handleOk(){this.ratelimitingVals=this.ratelimitings,this.ratelimitingVals[this.payload.type]=this.ratelimitingVals[this.payload.type]?this.ratelimitingVals[this.payload.type]:[],this.isEdit?this.ratelimitingVals[this.payload.type][this.payload.index]={name:this.payload.name,key:this.payload.key,content:this.payload.content}:this.ratelimitingVals[this.payload.type].push({name:this.payload.name,key:this.payload.key,content:this.payload.content}),this.payload={type:null,name:"",key:"",enable:!0,content:""},this.visible=!1,this.$emit("ratelimitingSave")},onTabChange(t){}}};var P=(0,E.Z)(T,[["render",function(t,e,i,s,n,d){const r=(0,a.up)("PlusCircleTwoTone"),o=(0,a.up)("a-button"),p=(0,a.up)("a-tag"),c=(0,a.up)("a-space"),u=(0,a.up)("a-card-meta"),h=(0,a.up)("CardList"),m=(0,a.up)("a-tab-pane"),g=(0,a.up)("a-tabs"),y=(0,a.up)("a-card"),v=(0,a.up)("a-select-option"),f=(0,a.up)("a-select"),w=(0,a.up)("a-descriptions-item"),b=(0,a.up)("a-input"),k=(0,a.up)("FormItem"),$=(0,a.up)("AutoForm"),_=(0,a.up)("a-descriptions"),S=(0,a.up)("a-form"),W=(0,a.up)("a-modal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(y,{title:i.title,class:"card identifier-card",bordered:!1},{extra:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(o,{type:"link",shape:"circle",onClick:d.showModal},{icon:(0,a.w5)((()=>[(0,a.Wm)(r,{class:"PlusCircleTwoTone icon-menu-sm rotate-icon"})])),_:1},8,["onClick"])])])),default:(0,a.w5)((()=>[(0,a.Wm)(g,{activeKey:n.ratelimitingKey,"onUpdate:activeKey":e[0]||(e[0]=t=>n.ratelimitingKey=t),"tab-position":"left"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.ratelimitingTypes,(e=>((0,a.wg)(),(0,a.j4)(m,{key:e.value,tab:e.label},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{col:i.col,"hide-action-title":!0,"data-source":i.ratelimitings[e.value]||[],type:e.value,loading:!1,actions:[{icon:"EditOutlined",text:t.$t("edit"),call:d.setting},{icon:"CloseOutlined",hide:!0,text:t.$t("delete"),call:d.remove}]},{default:(0,a.w5)((({item:t})=>[(0,a.Wm)(u,null,{title:(0,a.w5)((()=>[(0,a._)("div",z,(0,l.zw)(t.name),1)])),avatar:(0,a.w5)((()=>[D])),description:(0,a.w5)((()=>[t.content.fields?((0,a.wg)(),(0,a.iD)("div",O,[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.content.fields,((t,e)=>((0,a.wg)(),(0,a.iD)("span",{key:e},[t.value?((0,a.wg)(),(0,a.j4)(p,{key:0},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(t.label)+":"+(0,l.zw)("password"==t.type?t.value.replace(/./g,"*"):t.value),1)])),_:2},1024)):(0,a.kq)("",!0)])))),128))])),_:2},1024)])):((0,a.wg)(),(0,a.iD)("div",q,(0,l.zw)(t.content),1))])),_:2},1024)])),_:2},1032,["col","data-source","type","actions"])])),_:2},1032,["tab"])))),128))])),_:1},8,["activeKey"])])),_:1},8,["title"]),(0,a.Wm)(W,{visible:n.visible,"onUpdate:visible":e[4]||(e[4]=t=>n.visible=t),title:t.$t("Identity"),onOk:d.valid,width:"50%","ok-text":n.isEdit?t.$t("Save"):t.$t("create")},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{model:n.payload,"wrapper-col":{span:24},ref:"form"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{bordered:""},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{label:t.$t("Type"),span:3},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{disabled:n.isEdit,placeholder:t.$t("unset"),class:"width-200",value:n.payload.type,"onUpdate:value":e[1]||(e[1]=t=>n.payload.type=t),onChange:d.renderCallback},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.ratelimitingTypes,((e,i)=>((0,a.wg)(),(0,a.j4)(v,{key:i,value:e},{default:(0,a.w5)((()=>[(0,a._)("span",null,(0,l.zw)(t.$t(e.label)),1)])),_:2},1032,["value"])))),128))])),_:1},8,["disabled","placeholder","value","onChange"])])),_:1},8,["label"]),(0,a.Wm)(w,{label:t.$t("as"),span:3},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{name:"name",rules:t.rules.name},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{placeholder:t.$t("unset"),value:n.payload.name,"onUpdate:value":e[2]||(e[2]=t=>n.payload.name=t),class:"width-300"},null,8,["placeholder","value"])])),_:1},8,["rules"])])),_:1},8,["label"]),(0,a.Wm)(w,{label:t.$t("key"),span:3},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{name:"key",rules:t.rules.required},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{placeholder:t.$t("unset"),value:n.payload.key,"onUpdate:value":e[3]||(e[3]=t=>n.payload.key=t),class:"width-300"},null,8,["placeholder","value"])])),_:1},8,["rules"])])),_:1},8,["label"]),(0,a.Wm)(w,{label:t.$t("content"),span:3},{default:(0,a.w5)((()=>[n.payload.content.fields?((0,a.wg)(),(0,a.j4)($,{key:0,col:i.col,fields:[n.payload.content.fields]},null,8,["col","fields"])):(0,a.kq)("",!0)])),_:1},8,["label"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title","onOk","ok-text"])],64)}],["__scopeId","data-v-a514a356"]]);const Z={class:"pd-0 search-content"},U={class:"mb-3"},M={class:"relative"},K={class:"content template-div-3"},V={class:"template-div"},R={class:"template-div"},H={key:0},N={key:1},F={key:2},Y={key:3},G={key:0,class:"result-chart"},B={key:1,class:"result-chart"},J=(t=>((0,a.dD)("data-v-27fc238e"),t=t(),(0,a.Cn)(),t))((()=>(0,a._)("div",{class:"swagger",id:"swagger"},null,-1)));var X=i(48551),Q=i(85263),tt=i(11416),et=i.n(tt),it=i(14941),at=i(30631),lt=i(16527),st=i(52255);let nt=i(93320);var dt={name:"SubscriptionList",components:{PageLayout:v.Z,MiniArea:X.Z,CardList:x.Z,HighlightOutlined:it.Z,EyeOutlined:at.Z,RocketOutlined:lt.Z,PauseOutlined:st.Z},props:["subApis","identifiers","authApis","loading","col"],i18n:i(89234),data(){return{simpleImage:Q.Z.PRESENTED_IMAGE_SIMPLE,visible:!1,payload:{auths:[],id:null},visibleAuth:!1,showProject:!1}},computed:{...(0,w.rn)("setting",["layout","pageWidth"]),dataleftColumns(){return[{dataIndex:"name",title:this.$t("Name")},{dataIndex:"type",title:this.$t("Type")}]},datarightColumns(){return[{dataIndex:"name",title:this.$t("Name")},{dataIndex:"type",title:this.$t("Type")}]}},mounted(){},methods:{onAuthChange(t){this.payload.auths=t;let e=[],i=this.authApis,a=!1;t.forEach((t=>{if(t){let i=t.split("-");e.push({type:i[0],name:i[1]})}})),i.forEach((t=>{this.payload.id==t.id&&(t.auths=e,a=!0)})),a||i.push({id:this.payload.id,auths:e}),this.$emit("update:authApis",i)},getRowSelection(t,e,i,a){return{getCheckboxProps:e=>({disabled:t||e.disabled}),onSelectAll(t,e){const a=e.filter((t=>!t.disabled)).map((({key:t})=>t));i(a,t)},onSelect(t,e){a(t.key,e)},selectedRowKeys:e}},apiList(){this.$router.push({path:"/openapi/api/list"})},detail(t,e,i){this.$router.push({path:"/openapi/api/detail/"+i.id})},remove(t,e,i){let a=this.authApis;this.$emit("update:authApis",a.filter((t=>i.id!=t.id))),this.$emit("remove",i.id)},getDummtSGdata(){fetch("swagger.yaml").then((t=>t.text())).then((t=>{let e=nt.load(t),i=JSON.stringify(e,null,"  ");this.swaggerchange(i)})).catch((t=>{}))},auth(t,e,i){this.payload.id=i.id,this.payload.auths=[];let a=this.authApis,l=!1;a.forEach((t=>{this.payload.id==t.id&&(t.auths.forEach((t=>{t&&this.payload.auths.push(`${t.type}-${t.name}`)})),l=!0)})),l||(this.payload.auths=[]),this.visibleAuth=!0},show(t,e,i){this.visible=!0,this.swaggerchange(i.spec)},swaggerchange(t){et()({spec:t,dom_id:"#swagger",deepLinking:!1,presets:[et().presets.apis,et().SwaggerUIStandalonePreset],plugins:[et().plugins.DownloadUrl]})},getData(){}}};var rt=(0,E.Z)(dt,[["render",function(t,e,i,s,n,d){const r=(0,a.up)("a-tag"),o=(0,a.up)("a-badge"),p=(0,a.up)("a-card-meta"),c=(0,a.up)("HighlightOutlined"),u=(0,a.up)("EyeOutlined"),h=(0,a.up)("RocketOutlined"),m=(0,a.up)("PauseOutlined"),g=(0,a.up)("MiniArea"),y=(0,a.up)("CardList"),v=(0,a.up)("a-drawer"),f=(0,a.up)("a-table"),w=(0,a.up)("a-transfer"),b=(0,a.up)("a-modal"),k=(0,a.up)("PageLayout");return(0,a.wg)(),(0,a.j4)(k,{"hide-head":!0,title:t.$t("Subscription API"),class:"pd-0",style:{"padding-top":"0 !important"}},{default:(0,a.w5)((()=>[(0,a._)("div",Z,[(0,a.Wm)(y,{loading:i.loading,add:{text:t.$t("Add to API Market"),call:d.apiList,height:"225px"},col:i.col,empty:[{link:d.apiList,text:t.$t("There is no data yet. Please select and join the subscription car in the API market")}],"custom-empty":!0,"data-source":i.subApis,"hide-action-title":!0,type:"component",actions:[{icon:"EyeOutlined",text:t.$t("Preview"),call:d.show},{icon:"DeleteOutlined",text:t.$t("Remove subscription"),call:d.remove},{icon:"KeyOutlined",text:t.$t("Authority"),call:d.auth}]},{default:(0,a.w5)((({item:e})=>[(0,a.Wm)(p,null,{title:(0,a.w5)((()=>[(0,a._)("div",U,[(0,a.Uk)((0,l.zw)(e.name)+" ",1),(0,a.Wm)(r,{color:"pink",class:"result-tag"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(e.project.name),1)])),_:2},1024),1==e.status?((0,a.wg)(),(0,a.j4)(r,{key:0,color:"orange",class:"result-tag"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(t.$t("PENDING")),1)])),_:1})):(0,a.kq)("",!0),2==e.status?((0,a.wg)(),(0,a.j4)(r,{key:1,color:"red",class:"result-tag"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(t.$t("ERROR")),1)])),_:1})):(0,a.kq)("",!0)])])),avatar:(0,a.w5)((()=>[0==e.status?((0,a.wg)(),(0,a.j4)(o,{key:0,status:"processing"})):(0,a.kq)("",!0),1==e.status?((0,a.wg)(),(0,a.j4)(o,{key:1,status:"warning"})):(0,a.kq)("",!0),2==e.status?((0,a.wg)(),(0,a.j4)(o,{key:2,status:"error"})):(0,a.kq)("",!0)])),description:(0,a.w5)((()=>[])),_:2},1024),(0,a._)("div",M,[(0,a._)("div",K,[(0,a._)("div",V,[(0,a._)("p",null,(0,l.zw)(t.$t("Subscription")),1),(0,a._)("p",null,(0,l.zw)(e.applications.length),1)]),(0,a._)("div",R,[0==e.step?((0,a.wg)(),(0,a.iD)("p",H,(0,l.zw)(t.$t("In Design")),1)):(0,a.kq)("",!0),1==e.step?((0,a.wg)(),(0,a.iD)("p",N,(0,l.zw)(t.$t("Under Review")),1)):(0,a.kq)("",!0),2==e.step?((0,a.wg)(),(0,a.iD)("p",F,(0,l.zw)(t.$t("Running")),1)):(0,a.kq)("",!0),3==e.step?((0,a.wg)(),(0,a.iD)("p",Y,(0,l.zw)(t.$t("Stop")),1)):(0,a.kq)("",!0),(0,a._)("p",null,[0==e.step?((0,a.wg)(),(0,a.j4)(c,{key:0,class:"primary"})):(0,a.kq)("",!0),1==e.step?((0,a.wg)(),(0,a.j4)(u,{key:1,class:"primary"})):(0,a.kq)("",!0),2==e.step?((0,a.wg)(),(0,a.j4)(h,{key:2,class:"primary"})):(0,a.kq)("",!0),3==e.step?((0,a.wg)(),(0,a.j4)(m,{key:3,class:"danger"})):(0,a.kq)("",!0)])])]),e.chart&&e.chart.length>0?((0,a.wg)(),(0,a.iD)("div",G,[(0,a.Wm)(g,{colors:["#8be4c1"],height:100,id:e.id,padding:[0,0,0,0],axis:!1,ver:t.screenWidth,showy:!1,dv:e.chart},null,8,["id","ver","dv"])])):((0,a.wg)(),(0,a.iD)("div",B,[(0,a.Wm)(g,{colors:["#8be4c1"],height:100,id:e.id,padding:[0,0,0,0],axis:!1,"hide-legend":!0,ver:t.screenWidth,showy:!1,dv:[{type:"-",date:(new Date).toLocaleDateString(),value:0}]},null,8,["id","ver","dv"])]))])])),_:1},8,["loading","add","col","empty","data-source","actions"])]),(0,a.Wm)(v,{title:t.$t("Specs"),placement:"right",closable:!1,width:"50%",visible:n.visible,"onUpdate:visible":e[0]||(e[0]=t=>n.visible=t)},{default:(0,a.w5)((()=>[J])),_:1},8,["title","visible"]),(0,a.Wm)(b,{title:t.$t("Identifier"),closable:!0,footer:null,width:"50%",visible:n.visibleAuth,"onUpdate:visible":e[2]||(e[2]=t=>n.visibleAuth=t)},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{titles:[t.$t("Identifier")," "+t.$t("Added")],"data-source":i.identifiers,"target-keys":n.payload.auths,"onUpdate:target-keys":e[1]||(e[1]=t=>n.payload.auths=t),"show-search":!0,"filter-option":(t,e)=>-1!==e.name.indexOf(t),"show-select-all":!1,onChange:d.onAuthChange},{children:(0,a.w5)((({direction:t,filteredItems:e,selectedKeys:i,disabled:s,onItemSelectAll:n,onItemSelect:r})=>[(0,a.Wm)(f,{"row-selection":d.getRowSelection(s,i,n,r),columns:"left"===t?d.dataleftColumns:d.datarightColumns,"data-source":e,size:"small",style:(0,l.j5)({pointerEvents:s?"none":null}),"custom-row":({key:t,disabled:e})=>({onClick:()=>{e||s||r(t,!i.includes(t))}})},null,8,["row-selection","columns","data-source","style","custom-row"])])),_:1},8,["titles","data-source","target-keys","filter-option","onChange"])])),_:1},8,["title","visible"])])),_:1},8,["title"])}],["__scopeId","data-v-27fc238e"]]),ot=i(34531),pt={name:"ApplicationDetail",i18n:i(89234),components:{HeadInfo:b.Z,DatabaseOutlined:m.Z,CardSelector:ot.Z,DetailListItem:k.Z,DetailList:f.Z,PageLayout:v.Z,IdentifierList:I,ApplicationRateLimiting:P,SubscriptionList:rt,CloseOutlined:g.Z,PartitionOutlined:y.Z,LogViewer:h.Z},props:["embed"],data(){return{DatabaseOutlined:m.Z,detail:{project:null,service:null,content:{apis:[],ratelimiting:{},identitys:{},identifiers:{},certificates:[]},name:"",apis:[]},projects:[],editorIsCreate:!0,json:"{}",activeKey:"1",services:[],functions:["func1","func2","func3"],zones:["zone1","zone2","zone3"],types:["Host","Service","Function","Zone"],protocols:["HTTP","HTTPS","Dubbo"],methods:["GET","POST","PATCH","PUT","DELETE","HEAD","OPTIONS"],visible:!1,loading:!0,logloading:!0,subscriptionLoading:!0,swaggerLoading:!0,logs:[],log:"{}",pid:"",filter:"",approvalLevels:[],applies:[],key:"",pageSize:10,pageNo:1,total:0,profiles:[],clusters:[],tps:[],tpsCnt:0,activeTabKey:"2"}},computed:{...(0,w.rn)({rules:t=>t.rules.rules,isMobile:t=>t.setting.isMobile}),identifierList(){let t=[];return Object.keys(this.detail.content.identifiers).forEach((e=>{this.detail.content.identifiers[e].forEach((i=>{t.push({...i,type:e,key:`${e}-${i.name}`})}))})),t},start(){return(this.pageNo-1)*this.pageSize}},created(){this.pid=this.$route.params.id||"",this.editorIsCreate=""==this.pid},mounted(){this.$gql.query("projects{data{id,attributes{name}}}").then((t=>{this.projects=t.data})),""!=this.pid?this.loadApplication():(this.detail={project:null,service:null,content:{apis:[],identitys:{},identifiers:{},ratelimiting:{},certificates:[]},name:"",apis:[]},this.loading=!1)},methods:{clearService(){this.detail.service=null},saveService(t){this.detail.service=t},showModal(){this.visible=!0},handleOk(){this.visible=!1},onTabChange(t){},valid(){return""!=this.detail.name||(this.$message.error(this.$t("The name cannot be empty"),3),!1)},refuseApply(t){this.$gql.mutation(`deleteSubscribeApiApply(id: ${t.id}){data{id}}`).then((()=>{this.$message.success(this.$t("Delete successfully"),3),this.loadApplication()}))},removeSubApi(t){let e=[];this.detail.apis=this.detail.apis.filter((e=>t!=e.id)),this.detail.apis.forEach((t=>{e.push(t.id)})),this.$gql.mutation(`updateApplication(id:${this.pid}, data: $data){data{id}}`,{data:{apis:e}},{data:"ApplicationInput!"}).then((()=>{this.$message.success($t("Removed successfully"),3)}))},validate(){this.$refs.layout.$refs.form.validateFields().then((()=>{this.save()})).catch((()=>{}))},save(){if(!this.valid())return;let t=u().cloneDeep(this.detail);delete t.createdAt,delete t.updatedAt,delete t.id,delete t.apis,delete t.subscribeApiApplies,t.content.certificates&&t.content.certificates.length>0&&(t.certificates=[],t.content.certificates.forEach((e=>{t.certificates.push(e.id)}))),t.service&&(t.service=t.service.id),""!=this.pid?this.$gql.mutation(`updateApplication(id:${this.pid}, data: $data){data{id}}`,{data:t},{data:"ApplicationInput!"}).then((()=>{this.$message.success(this.$t("Save successfully"),3)})):this.$gql.mutation("createApplication(data: $data){data{id}}",{data:t},{data:"ApplicationInput!"}).then((t=>{this.pid=t.data.id,this.$message.success(this.$t("Created successfully"),3)}))},handleChange(){},hide(){this.visible=!1},searchApplies(t){this.pageNo=t||1,this.loading=!0;let e={application:{id:{eq:this.pid}}};this.$gql.query(`subscribeApiApplies(filters: $filters, pagination:{start: ${this.start}, limit: ${this.pageSize}}){\n\t\t\t\t\t\tdata{id,attributes{\n\t\t\t\t\t\t\tmsg,\n\t\t\t\t\t\t\tstatus,\n\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\tapprovalStep,\n\t\t\t\t\t\t\tapi{data{id,attributes{approvalLevel,name}}},\n\t\t\t\t\t\t\tapplyUser{data{id,attributes{username}}},\n\t\t\t\t\t\t\tcreatedAt,\n\t\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\t}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}`,{filters:e},{filters:"SubscribeApiApplyFiltersInput"}).then((t=>{let e=t.data;e&&this.$gql.query('systemSettings(filters:{type:{eq:"ApiApprovalLevelType"}}){data{id,attributes{mode,content}}}').then((t=>{this.approvalLevels=t.data[0].content,this.approvalLevels.forEach((t=>{t.value=1*t.value})),e.forEach((t=>{this.approvalLevels.forEach((e=>{e.value==t.api.approvalLevel&&(t.findApprovalLevel=e)}))})),this.applies=e})),this.total=t.pagination.total}))},loadApplication(){this.loading=!0,this.subscriptionLoading=!0,this.$gql.query(`application(id: ${this.pid}){data{id,attributes{\n\t\t\t\t\t\tname,\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t\tsubscribeApiApplies{data{id,attributes{\n\t\t\t\t\t\t\tmsg,\n\t\t\t\t\t\t\tstatus,\n\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\tapprovalStep,\n\t\t\t\t\t\t\tapi{data{id,attributes{approvalLevel,name}}},\n\t\t\t\t\t\t\tapplyUser{data{id,attributes{username}}},\n\t\t\t\t\t\t\tcreatedAt,\n\t\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\t}}},\n\t\t\t\t\t\tservice{data{id,attributes{name}}},\n\t\t\t\t\t\tcertificates{data{id,attributes{name,content}}},\n\t\t\t\t\t\tapis{data{id,attributes{\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tspec,\n\t\t\t\t\t\t\tproject{data{id,attributes{name}}},\n\t\t\t\t\t\t\tstep,\n\t\t\t\t\t\t\tstatus,\n\t\t\t\t\t\t\tchart,\n\t\t\t\t\t\t\tapplications{data{id,attributes{name}}},\n\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\t}}},\n\t\t\t\t\t\tproject{data{id}},\n\t\t\t\t\t\tcreatedAt,\n\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t}}}`).then((t=>{let e=t.data;this.loading=!1,this.subscriptionLoading=!1,e.service=e.service,this.detail=e,this.detail.spec=JSON.stringify(e.spec),this.detail.project=e.project?e.project.id:null,this.detail.content.apis||(this.detail.content.apis=[]),this.detail.content.identitys||(this.detail.content.identitys={}),this.detail.content.identifiers||(this.detail.content.identifiers={}),this.detail.content.ratelimiting||(this.detail.content.ratelimiting={}),this.detail.content.certificates||(this.detail.content.certificates=[]),e.certificates&&e.certificates.length>0&&this.detail.content.certificates.forEach((t=>{e.certificates.forEach((e=>{t.id==e.id&&(t.name=e.name,t.content=e.content)}))}))})),this.searchApplies()},getServices(){const t={namespace:{eq:this.env.namespace},registry:{id:{eq:this.env.registerId}}};this.$gql.query(`getServices(pagination:{start: 0, limit: ${this.$DFT_LIMIT}}, filters: $filters){\n\t\t\t\t\t\tdata{id,attributes{\n\t\t\t\t\t\t\tuid,\n\t\t\t\t\t\t\tnamespace,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tregistry{data{id,attributes{name}}},\n\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\tcreatedAt\n\t\t\t\t\t\t}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}`,{filters:t},{filters:"ServiceFiltersInput"}).then((t=>{this.services=t.data,this.services.forEach((t=>{t.name=t.name?t.name:t.metadata.name,t.registry?t.clusterName=t.registry.name:t.fleet?t.clusterName=t.fleet.name:t.clusterName="-"}))}))},envChange(t){this.env=t,this.getServices()}}};var ct=(0,E.Z)(pt,[["render",function(t,e,i,c,u,h){const m=(0,a.up)("a-input"),g=(0,a.up)("DetailListItem"),y=(0,a.up)("a-select-option"),v=(0,a.up)("a-select"),f=(0,a.up)("a-tag"),w=(0,a.up)("CardSelector"),b=(0,a.up)("DetailList"),k=((0,a.up)("HeadInfo"),(0,a.up)("a-button")),$=(0,a.up)("IdentifierList"),_=(0,a.up)("a-col"),S=(0,a.up)("a-row"),W=(0,a.up)("ApplicationRateLimiting"),A=(0,a.up)("a-tab-pane"),x=(0,a.up)("SubscriptionList"),C=(0,a.up)("PartitionOutlined"),j=(0,a.up)("a-list-item-meta"),L=(0,a.up)("CloseOutlined"),E=(0,a.up)("a-step"),I=(0,a.up)("a-steps"),z=(0,a.up)("a-list-item"),D=(0,a.up)("a-list"),O=(0,a.up)("a-card"),q=(0,a.up)("LogViewer"),T=(0,a.up)("a-tabs"),P=((0,a.up)("DatabaseOutlined"),(0,a.up)("PageLayout")),Z=(0,a.Q2)("permission");return(0,a.wg)(),(0,a.j4)(P,{"hide-breadcrumb":i.embed,title:i.embed?" ":u.detail.name?u.detail.name:t.$t("new")+t.$t("Application"),"form-state":u.detail,ref:"layout"},(0,a.Nv)({headerContent:(0,a.w5)((()=>[(0,a.Wm)(b,{size:"small",col:1},{default:(0,a.w5)((()=>[i.embed?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(g,{key:0,term:t.$t("as"),rules:t.rules.uniqueName("applications",{id:u.pid,project:u.detail.project}),name:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{placeholder:t.$t("unset"),value:u.detail.name,"onUpdate:value":e[0]||(e[0]=t=>u.detail.name=t),class:"width-200"},null,8,["placeholder","value"])])),_:1},8,["term","rules"])),(0,a.Wm)(g,{term:t.$t("Project"),rules:t.rules.required,name:"project"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{placeholder:t.$t("unallocated"),class:"width-200",value:u.detail.project,"onUpdate:value":e[1]||(e[1]=t=>u.detail.project=t),onChange:e[2]||(e[2]=t=>h.handleChange())},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(u.projects,((t,e)=>((0,a.wg)(),(0,a.j4)(y,{key:e,value:t.id},{default:(0,a.w5)((()=>[t.id?((0,a.wg)(),(0,a.iD)("span",s,(0,l.zw)(t.name),1)):(0,a.kq)("",!0),t.id?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("i",n,(0,l.zw)(t.name),1))])),_:2},1032,["value"])))),128))])),_:1},8,["placeholder","value"])])),_:1},8,["term","rules"]),(0,a.Wm)(g,{term:t.$t("Service")},{default:(0,a.w5)((()=>[u.detail.service?((0,a.wg)(),(0,a.j4)(f,{key:0,closable:"",onClose:h.clearService},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(u.detail.service.name),1)])),_:1},8,["onClose"])):(0,a.kq)("",!0),(0,a.Wm)(w,{width:400,col:2,"env-filter":!0,search:!0,placement:"right",icon:u.DatabaseOutlined,onSelect:h.saveService,onEnvChange:h.envChange,"get-tag":t=>t.clusterName+" / "+t.namespace,options:u.services},{default:(0,a.w5)((()=>[(0,a._)("a",null,[(0,a.Wm)(f,{color:"#00adef",key:"submit",type:"primary"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(t.$t("Relation Service")),1)])),_:1})])])),_:1},8,["icon","onSelect","onEnvChange","get-tag","options"])])),_:1},8,["term"])])),_:1})])),default:(0,a.w5)((()=>[(0,a.Wm)(S,{class:"row-mg"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"col-pd",xl:24,lg:24,md:24,sm:24,xs:24},{default:(0,a.w5)((()=>[(0,a.Wm)(T,{type:"card",activeKey:u.activeKey,"onUpdate:activeKey":e[5]||(e[5]=t=>u.activeKey=t)},{default:(0,a.w5)((()=>[(0,a.Wm)(A,{key:"1",tab:t.$t("Overview")},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{class:"mb-20 row-mg"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"col-pd",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,a.w5)((()=>[(0,a.Wm)($,{identifiers:u.detail.content.identifiers,"onUpdate:identifiers":e[3]||(e[3]=t=>u.detail.content.identifiers=t),col:1,title:t.$t("Identifier"),onIdentifierSave:h.validate},null,8,["identifiers","title","onIdentifierSave"])])),_:1})])),_:1}),(0,a.Wm)(S,{class:"row-mg"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"col-pd",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{ratelimitings:u.detail.content.ratelimiting,"onUpdate:ratelimitings":e[4]||(e[4]=t=>u.detail.content.ratelimiting=t),col:1,title:t.$t("Rate Limiting"),onRatelimitingSave:h.validate},null,8,["ratelimitings","title","onRatelimitingSave"])])),_:1})])),_:1})])),_:1},8,["tab"]),u.pid?((0,a.wg)(),(0,a.j4)(A,{key:"2",tab:t.$t("Subscription API")},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{class:"row-mg"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"col-pd",xl:u.applies>0?16:24,lg:24,md:24,sm:24,xs:24},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{col:u.applies>0?3:4,loading:u.subscriptionLoading,onRemove:h.removeSubApi,"sub-apis":u.detail.apis,identifiers:h.identifierList,"auth-apis":u.detail.content.apis},null,8,["col","loading","onRemove","sub-apis","identifiers","auth-apis"])])),_:1},8,["xl"]),(0,a.Wm)(_,{class:"col-pd",xl:u.applies>0?8:0,lg:24,md:24,sm:24,xs:24},{default:(0,a.w5)((()=>[(0,a.Wm)(O,null,{title:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(t.$t("Applies")),1)])),default:(0,a.w5)((()=>[(0,a.Wm)(D,{"item-layout":"vertical","data-source":u.applies,pagination:{onChange:h.searchApplies,current:u.pageNo,pageSize:u.pageSize,showTotal:(e,i)=>`${t.$t("Total")} ${e}`,total:u.total}},{renderItem:(0,a.w5)((({item:e})=>[(0,a.Wm)(z,null,{extra:(0,a.w5)((()=>[(0,a._)("div",d,[(0,a._)("a",{href:"javascript:void(0)",onClick:t=>h.refuseApply(e)},[(0,a.Wm)(L,{class:"icon-menu"})],8,r)])])),default:(0,a.w5)((()=>[(0,a.Wm)(j,null,{description:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(new Date(e.updatedAt).toLocaleString())+" ("+(0,l.zw)(e.applyUser.username)+") "+(0,l.zw)(t.$t("applies for subscription")),1)])),title:(0,a.w5)((()=>[(0,a._)("b",null,(0,l.zw)(e.api?e.api.name:""),1)])),avatar:(0,a.w5)((()=>[(0,a.Wm)(C,{class:"primary"})])),_:2},1024),(0,a._)("div",null,[(0,a._)("div",{class:"relative vm",style:(0,l.j5)([{left:"15px"},"width:"+120*e.api.approvalLevel+"px"])},[(0,a.Wm)(I,{current:e.approvalStep,size:"small",status:["process","finish","error"][e.status]},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.findApprovalLevel.approvalRoles,((t,i)=>((0,a.wg)(),(0,a.j4)(E,{class:"pb-10",key:i,title:t.label},(0,a.Nv)({_:2},[i<=e.approvalStep&&e.content&&e.content.history&&e.content.history[i]?{name:"description",fn:(0,a.w5)((()=>[e.content.history[i].user?((0,a.wg)(),(0,a.iD)("div",o,[(0,a._)("b",null,(0,l.zw)(e.content.history[i].user.username),1)])):(0,a.kq)("",!0),e.content.history[i].time?((0,a.wg)(),(0,a.iD)("div",p,(0,l.zw)(e.content.history[i].time),1)):(0,a.kq)("",!0)])),key:"0"}:void 0]),1032,["title"])))),128))])),_:2},1032,["current","status"])],4)])])),_:2},1024)])),_:1},8,["data-source","pagination"])])),_:1})])),_:1},8,["xl"])])),_:1})])),_:1},8,["tab"])):(0,a.kq)("",!0),""!=u.pid?((0,a.wg)(),(0,a.j4)(A,{key:"11",tab:t.$t("log")},{default:(0,a.w5)((()=>[(0,a.Wm)(q,{uid:u.pid,type:"app"},null,8,["uid"])])),_:1},8,["tab"])):(0,a.kq)("",!0)])),_:1},8,["activeKey"])])),_:1})])),_:1}),(0,a.kq)("",!0)])),_:2},[void 0,i.embed?void 0:{name:"action",fn:(0,a.w5)((()=>[""!=u.pid?(0,a.wy)(((0,a.wg)(),(0,a.j4)(k,{key:0,type:"primary",onClick:h.validate},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(t.$t("save")),1)])),_:1},8,["onClick"])),[[Z,[u.detail.project?"application:update:project:"+u.detail.project:"application:update"]]]):(0,a.wy)(((0,a.wg)(),(0,a.j4)(k,{key:1,type:"primary",onClick:h.validate},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(t.$t("create")),1)])),_:1},8,["onClick"])),[[Z,[u.detail.project?"application:create:project:"+u.detail.project:"application:create"]]])])),key:"1"}]),1032,["hide-breadcrumb","title","form-state"])}]])}}]);