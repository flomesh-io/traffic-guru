"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[7086],{21002:function(t,e,n){n.d(e,{Z:function(){return i}});var a=n(66252);var r={name:"SyncBar",components:{SyncOutlined:n(21826).Z},props:["percent"],methods:{sync:function(){this.$emit("sync")}}};var i=(0,n(83744).Z)(r,[["render",function(t,e,n,r,i,s){var o=(0,a.up)("a-progress"),c=(0,a.up)("SyncOutlined"),u=(0,a.up)("a-button");return(0,a.wg)(),(0,a.iD)(a.HY,null,[n.percent>-1?((0,a.wg)(),(0,a.j4)(o,{key:0,size:"small",class:"title-progress","stroke-color":{"0%":"#00adef","100%":"#87d068"},percent:n.percent},null,8,["percent"])):(0,a.kq)("",!0),-1==n.percent?((0,a.wg)(),(0,a.j4)(u,{key:1,type:"link",shape:"circle",onClick:s.sync},{icon:(0,a.w5)((function(){return[(0,a.Wm)(c,{class:"font-20 icon-menu-sm rotate-icon"})]})),_:1},8,["onClick"])):(0,a.kq)("",!0),n.percent>-1&&n.percent<100?((0,a.wg)(),(0,a.j4)(u,{key:2,type:"link",shape:"circle"},{icon:(0,a.w5)((function(){return[n.percent>-1&&n.percent<100?((0,a.wg)(),(0,a.j4)(c,{key:0,spin:"",class:"font-12"})):(0,a.kq)("",!0)]})),_:1})):(0,a.kq)("",!0)],64)}],["__scopeId","data-v-6a8f29bb"]])},47086:function(t,e,n){n.r(e),n.d(e,{default:function(){return v}});var a=n(66252);n(74916),n(64765),n(92222),n(2707),n(68309),n(47941);var r=n(3577),i=n(49963),s={key:0},o=["onClick"],c={key:0},u={key:2},l={key:3},d=["onClick"];n(21249),n(57658),n(15306);var p=n(60459),g=n(2692),h=n(99684),m=n(21002),f=[{key:"as",dataIndex:"name"},{key:"Namespace",width:130,dataIndex:"namespaceName"},{key:"Labels",dataIndex:"labels"},{key:"Hosts",dataIndex:"hosts"},{key:"Creation Timestamp",dataIndex:"createdAt",sorter:!0},{key:"Action",width:130,dataIndex:"action"}],w={name:"IngressList",components:{EnvSelector:p.Z,MoreOutlined:g.Z,PlusCircleTwoTone:h.Z,SyncBar:m.Z},props:["hasSearch"],i18n:n(89234),data:function(){return{pageNo:1,syncLoading:-1,pageSize:10,total:0,key:"",columns:f,sorter:"name",sortOrder:"asc",loading:!0,list:[]}},computed:{dataColumns:function(){var t=this;return this.columns.map((function(e){return e.title=t.$t(e.key),e.sorter&&t.sorter==e.dataIndex&&(e.sortOrder=t.sortOrder),e}))},start:function(){return(this.pageNo-1)*this.pageSize}},created:function(){this.sync(!0)},methods:{sync:function(t){var e=this;t&&(this.syncLoading=0,this.$gql.mutation("fetchIngresses").then((function(){e.syncLoading=100,e.search(),setTimeout((function(){e.syncLoading=-1}),1e3)}))),this.syncLoading<90&&(this.syncLoading+=10,setTimeout((function(){e.sync()}),100))},remove:function(t){var e=this;this.$gql.mutation("deleteIngressSync(id:".concat(t,"){data{id}}")).then((function(){e.$message.success(e.$t("Deleted successfully"),3),e.search()}))},newItem:function(){this.$router.push({path:"/fsm/ingress/create"})},detail:function(t){this.$router.push({path:"/fsm/ingress/detail/".concat(t)})},sort:function(t,e,n){this.sorter=n.field,this.sortOrder=n.order,this.search()},search:function(t,e){var n=this;t&&(this.pageNo=t,this.pageSize=e);var a={start:this.start,limit:this.pageSize};this.loading=!0;var r={};r.name={contains:this.key};var i="name:asc";this.sorter&&this.sortOrder&&(i=(i=this.sortOrder.replace(/end/g,"")).replace(/\$/g,""),i="".concat(this.sorter,":").concat(i)),this.$gql.query('getIngresses(filters: $filters, pagination: $pagination, sort: "'.concat(i,'"){\n\t\t\t\t\t\tdata{id,attributes{\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tnamespace{data{id,attributes{\n\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\tregistry{data{id,attributes{name}}}\n\t\t\t\t\t\t\t}}},\n\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\tcreatedAt\n\t\t\t\t\t\t}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}'),{filters:r,pagination:a},{filters:"IngressFiltersInput",pagination:"PaginationArg"}).then((function(t){n.list=n.reset(t.data),n.total=t.pagination.total,n.loading=!1}))},reset:function(t){for(var e=0;e<t.length;e++){var n=t[e].content;t[e].namespaceName=t[e].namespace.name,t[e].labels=n.metadata.labels?n.metadata.labels:{},t[e].hosts=n.hosts,t[e].createdAt=new Date(t[e].createdAt).toLocaleString()}return t}}},y=n(83744);var k={name:"Ingresss",components:{IngressList:(0,y.Z)(w,[["render",function(t,e,n,p,g,h){var m=(0,a.up)("a-input-search"),f=(0,a.up)("a-divider"),w=(0,a.up)("PlusCircleTwoTone"),y=(0,a.up)("a-button"),k=(0,a.up)("SyncBar"),v=(0,a.up)("EnvSelector"),b=(0,a.up)("a-tag"),_=(0,a.up)("a-menu-item"),I=(0,a.up)("a-popconfirm"),C=(0,a.up)("a-menu"),S=(0,a.up)("MoreOutlined"),$=(0,a.up)("a-dropdown"),z=(0,a.up)("a-table"),x=(0,a.up)("a-card"),W=(0,a.Q2)("permission");return(0,a.wg)(),(0,a.j4)(x,{class:"card nopd",title:t.$t("Ingress"),loading:g.loading},(0,a.Nv)({default:(0,a.w5)((function(){return[(0,a._)("div",null,[(0,a.Wm)(z,{pagination:{showSizeChanger:!1,showQuickJumper:!1,onShowSizeChange:h.search,onChange:h.search,current:g.pageNo,pageSize:g.pageSize,showTotal:function(e,n){return"".concat(t.$t("Total")," ").concat(e)},total:g.total},onChange:h.sort,columns:h.dataColumns,"data-source":g.list,class:"bg-white"},{bodyCell:(0,a.w5)((function(e){var n=e.column,p=e.record;return["name"===n.dataIndex?((0,a.wg)(),(0,a.iD)("div",s,[(0,a._)("a",{href:"javascript:void(0)",onClick:function(t){return h.detail(p.id)}},(0,r.zw)(p.name),9,o)])):"labels"===n.dataIndex?((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[p.content.metadata&&p.content.metadata.labels?((0,a.wg)(),(0,a.iD)("div",c,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(Object.keys(p.content.metadata.labels),(function(t,e){return(0,a.wg)(),(0,a.j4)(b,{key:e,closable:!1},{default:(0,a.w5)((function(){return[(0,a.Uk)((0,r.zw)(t)+":"+(0,r.zw)(p.content.metadata.labels[t]),1)]})),_:2},1024)})),128))])):(0,a.kq)("",!0)],64)):"hosts"===n.dataIndex?((0,a.wg)(),(0,a.iD)("div",u,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(p.content.spec.rules,(function(t,e){return(0,a.wy)(((0,a.wg)(),(0,a.j4)(b,{key:e,closable:!1},{default:(0,a.w5)((function(){return[(0,a.Uk)((0,r.zw)(t.host),1)]})),_:2},1024)),[[i.F8,t.host]])})),128))])):"action"===n.dataIndex?((0,a.wg)(),(0,a.iD)("div",l,[(0,a.Wm)($,null,{overlay:(0,a.w5)((function(){return[(0,a.Wm)(C,null,{default:(0,a.w5)((function(){return[(0,a.Wm)(_,null,{default:(0,a.w5)((function(){return[(0,a.wy)(((0,a.wg)(),(0,a.iD)("a",{onClick:function(t){return h.detail(p.id)}},[(0,a.Uk)((0,r.zw)(t.$t("edit")),1)],8,d)),[[W,["ingress:update"]]])]})),_:2},1024),(0,a.Wm)(_,null,{default:(0,a.w5)((function(){return[(0,a.Wm)(I,{placement:"topLeft","ok-text":t.$t("Yes"),"cancel-text":t.$t("No"),onConfirm:function(t){return h.remove(p.id)}},{title:(0,a.w5)((function(){return[(0,a._)("p",null,(0,r.zw)(t.$t("Tip")),1),(0,a._)("p",null,(0,r.zw)(t.$t("Are you sure to delete this?")),1)]})),default:(0,a.w5)((function(){return[(0,a.wy)(((0,a.wg)(),(0,a.iD)("a",null,[(0,a.Uk)((0,r.zw)(t.$t("delete")),1)])),[[W,["ingress:delete"]]])]})),_:2},1032,["ok-text","cancel-text","onConfirm"])]})),_:2},1024)]})),_:2},1024)]})),default:(0,a.w5)((function(){return[(0,a._)("a",null,[(0,a.Wm)(S)])]})),_:2},1024)])):(0,a.kq)("",!0)]})),_:1},8,["pagination","onChange","columns","data-source"])])]})),_:2},[n.hasSearch?{name:"extra",fn:(0,a.w5)((function(){return[(0,a._)("div",null,[(0,a.Wm)(m,{value:g.key,"onUpdate:value":e[0]||(e[0]=function(t){return g.key=t}),onSearch:e[1]||(e[1]=function(t){return h.search()}),class:"right-search-input",placeholder:t.$t("search")},null,8,["value","placeholder"]),(0,a.wy)((0,a.Wm)(f,{type:"vertical"},null,512),[[W,["ingress:create"]]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(y,{type:"link",shape:"circle",onClick:h.newItem},{icon:(0,a.w5)((function(){return[(0,a.Wm)(w,{class:"font-20 icon-menu-sm rotate-icon"})]})),_:1},8,["onClick"])),[[W,["ingress:create"]]]),(0,a.wy)((0,a.Wm)(f,{type:"vertical"},null,512),[[W,["ingress:create"]]]),(0,a.wy)((0,a.Wm)(k,{percent:g.syncLoading,onSync:e[2]||(e[2]=function(t){return h.sync(!0)})},null,8,["percent"]),[[W,["ingress:create"]]]),(0,a.Wm)(f,{type:"vertical"}),(0,a.Wm)(v)])]})),key:"0"}:void 0]),1032,["title","loading"])}],["__scopeId","data-v-291d4ecc"]])},i18n:n(89234),data:function(){return{}},created:function(){}};var v=(0,y.Z)(k,[["render",function(t,e,n,r,i,s){var o=(0,a.up)("IngressList");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(o,{"has-search":!0})])}]])}}]);