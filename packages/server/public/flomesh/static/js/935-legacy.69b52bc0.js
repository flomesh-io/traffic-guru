"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[935],{47556:function(t,a,e){e.d(a,{Bl:function(){return u},Cb:function(){return I},DB:function(){return S},Gm:function(){return l},IJ:function(){return g},MZ:function(){return A},O7:function(){return h},Ru:function(){return k},Tf:function(){return Z},US:function(){return C},ZC:function(){return c},eb:function(){return L},k5:function(){return i},l1:function(){return f},lr:function(){return d},q8:function(){return o},qF:function(){return E},sl:function(){return D},ud:function(){return T},vC:function(){return p},zN:function(){return m}});var n=e(50124),r=e(48534),s=(e(69600),e(68309),e(6199)),o="system.common.ORGANIZATION_TOTAL,system.common.PROJECT_TOTAL,system.common.Space,system.common.Space,workload.dashboard.DEPLOYMENT,workload.dashboard.STATEFULSET,workload.dashboard.JOB,workload.dashboard.POD",d="flb.dashboard.TOTAL,flb.dashboard.ADDRESSPOOL,flb.dashboard.BYTES,flb.dashboard.PROCESS_MEMORY,flb.dashboard.CONNECTIONS,flb.dashboard.INACT_CONNECTIONS,flb.dashboard.FAIL_CONNECTIONS,flb.dashboard.TIME_WAIT,flb.dashboard.FREE_CPU,flb.dashboard.PROCESS_CPU,flb.dashboard.FULL_CONN_OVERFLOW_ERROR,flb.dashboard.HALF_CONN_OVERFLOW_ERROR,flb.dashboard.UNHEALTHY_UPSTREAM,flb.dashboard.RANKING,flb.dashboard.SANKEY",u="fsm.dashboard.REGISTRY_TOTAL,fsm.dashboard.NAMESPACE_TOTAL,fsm.dashboard.SERVICE_TOTAL,system.common.Space,fsm.dashboard.SERVICE_HEALTHCHECK,fsm.dashboard.SERVICE_STATUS,fsm.dashboard.INGRESS_STATUS,fsm.dashboard.MCS_TOPOLOGY",i="fsm.dashboard.NAMESPACE_MESH_TOTAL,fsm.dashboard.SERVICE_MESH_TOTAL,system.common.Space,system.common.Space,system.common.TPS_MESH,system.common.ERROR_RATE_MESH,system.common.LATENCY_MESH,workload.dashboard.POD,fsm.dashboard.TOPOLOGY",c="fsm.dashboard.TPS_ERROR,fsm.dashboard.BPS,fsm.dashboard.LATENCY,fsm.dashboard.LOAD_STATUS,fsm.dashboard.TOPOLOGY,fsm.dashboard.QOS",l="workload.dashboard.CRONJOB,workload.dashboard.DAEMONSET,workload.dashboard.DEPLOYMENT,workload.dashboard.JOB,workload.dashboard.POD,workload.dashboard.REPLICASET,workload.dashboard.REPLICATIONCONTROLLER,workload.dashboard.STATEFULSET",p="openapi.dashboard.API_TOTAL,openapi.dashboard.APP_TOTAL,system.common.ORGANIZATION_TOTAL,system.common.PROJECT_TOTAL,system.common.LATENCY,system.common.USER_AGENT,system.common.QPS,system.common.ERROR_RATE,openapi.dashboard.API_STATUS,openapi.dashboard.API_METRIC_WEEK,openapi.dashboard.API_METRIC_MONTH,system.common.Space,system.common.RANKING",h="openapi.dashboard.API_TOTAL,openapi.dashboard.APP_TOTAL,system.common.Space,system.common.Space,fsm.dashboard.QOS,fsm.dashboard.LATENCY,fsm.dashboard.LOAD_STATUS,fsm.dashboard.TPS_ERROR,fsm.dashboard.BPS,openapi.dashboard.API_STATUS,openapi.dashboard.API_METRIC_WEEK,openapi.dashboard.API_METRIC_MONTH",m="fsm.dashboard.TPS_ERROR,fsm.dashboard.BPS,fsm.dashboard.LATENCY,fsm.dashboard.LOAD_STATUS,openapi.dashboard.TOPOLOGY,fsm.dashboard.QOS,openapi.dashboard.API_METRIC_WEEK,openapi.dashboard.API_METRIC_MONTH";function f(t){return b.apply(this,arguments)}function b(){return(b=(0,r.Z)((0,n.Z)().mark((function t(a){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,s.IO)("dashboard(id:".concat(a,"){data{id,attributes{name,content,apply}}}")));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function T(t){return O.apply(this,arguments)}function O(){return(O=(0,r.Z)((0,n.Z)().mark((function t(a){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,s.IO)('dashboards(filters:{apply:{eq:"'.concat(a,'"}}){data{id,attributes{name,content,apply}}}')));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function E(t,a){return _.apply(this,arguments)}function _(){return(_=(0,r.Z)((0,n.Z)().mark((function t(a,e){var r,o;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={},o="",e.subscribes&&(o=e.subscribes.join(","),r.content={widget:o}),e.name&&e.name.length>0&&(r.name=e.name),null!=e.apply&&(r.apply=e.apply),t.abrupt("return",(0,s.QF)("updateDashboard(id:".concat(a,", data: $data){data{id}}"),{data:r},{data:"DashboardInput!"}));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function S(t){return y.apply(this,arguments)}function y(){return(y=(0,r.Z)((0,n.Z)().mark((function t(a){var e;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={},null!=a.widget&&(e.content={widget:a.widget}),a.name&&a.name.length>0&&(e.name=a.name),null!=a.apply&&(e.apply=a.apply),t.abrupt("return",(0,s.QF)("createDashboard(data: $data){data{id}}",{data:e},{data:"DashboardInput!"}));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function A(t){return w.apply(this,arguments)}function w(){return(w=(0,r.Z)((0,n.Z)().mark((function t(a){var e;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={content:a,name:a.id,shared:0},t.abrupt("return",(0,s.QF)("createWidget(data: $data){data{id}}",{data:e},{data:"WidgetInput!"}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function g(t,a){return v.apply(this,arguments)}function v(){return(v=(0,r.Z)((0,n.Z)().mark((function t(a,e){var r;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return delete e.uid,r={content:e,name:e.id},t.abrupt("return",(0,s.QF)("updateWidget(id:".concat(a,", data: $data){data{id}}"),{data:r},{data:"WidgetInput!"}));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function L(t){return R.apply(this,arguments)}function R(){return(R=(0,r.Z)((0,n.Z)().mark((function t(a){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,s.QF)("deleteWidget(id:".concat(a,"){data{id}}")));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function C(){return P.apply(this,arguments)}function P(){return(P=(0,r.Z)((0,n.Z)().mark((function t(){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,s.IO)("widgets{data{id,attributes{name,shared,user_id,content}}}"));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(t){return N.apply(this,arguments)}function N(){return(N=(0,r.Z)((0,n.Z)().mark((function t(a){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,s.IO)("widget(id:".concat(a,"){data{id,attributes{name,shared,user_id,content}}}")));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Z={id:"TEST-CUSTOM",title:"A Sample",tag:{name:"Gauge"},service:{type:"rest",path:"hk.flomesh.cn:8090/kube-dashboard/?url=%2Fapi%2Fv1%2Fjob%2Fdefault%3FitemsPerPage%3D0%26page%3D1%26sortBy%3Dd%2CcreationTimestamp",method:"GET",payload:"{}",clickhouseSQL:"",prometheusSQL:""},col:6,data:"res => {\n\tlet _data = res.data;\n\tfunction getPercentage(current,status){\n\t\tlet per = (status.running+status.succeeded+status.failed);\n\t\treturn per ==0 ?0 :Math.round(current*100/per);\n\t}\n\treturn {\n\t\tid:'WP-CUSTOM',\n\t\tvals:[\n\t\t\tgetPercentage(_data.status.running,_data.status),\n\t\t\tgetPercentage(_data.status.succeeded,_data.status),\n\t\t\tgetPercentage(_data.status.failed,_data.status)\n\t\t]\n\t}\n}"},k={id:"CLICKHOUSE-TEST-CUSTOM",title:"A Clickhouse Datasource Sample",tag:{name:"MiniSector"},service:{type:"clickhouse",path:"",method:"GET",payload:"{}",clickhouseSQL:"select count() as count,res.status from log where res.status>'0' group by res.status order by res.status",prometheusSQL:""},col:6,data:"res => {\n\tlet dv = [];\n\tres.map((item) => {\n\t\t\tdv.push({type:item[1],value:item[0],name:item[1]});\n\t});\n\treturn {\n\t\tcolors:['#8bd4a1','#fac858','#fb9690'],\n\t\tdv:dv\n\t}\n}"},D={id:"PROMETHEUS-TEST-CUSTOM",title:"A Prometheus Datasource Sample",tag:{name:"MiniArea"},service:{type:"prometheus",path:"",method:"GET",payload:"{}",clickhouseSQL:"",prometheusSQL:"sum(pipy_chunk_size)"},col:6,data:"res => {\n\tlet dv = [];\n\tif(res.data?.result){\n\t\tres.data.result.forEach((result,i) => {\n\t\t\tresult.values.forEach((value,j) => {\n\t\t\t\tif(value[1]){\n\t\t\t\t\tdv.push({\n\t\t\t\t\t\ttype:'item'+i,\n\t\t\t\t\t\tvalue:(value[1]*1).toFixed(2),\n\t\t\t\t\t\tdate:new Date(value[0]*1000).toISOString().split('.')[0].replace('T',' ')\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\treturn {\n\t\tid: 'Test-Prometheus-MiniArea',\n\t\tcolors: ['#8bd4a1', '#fb9690'],\n\t\theight: 240,\n\t\tpadding: [0, 0, 0, 0],\n\t\taxis: false,\n\t\tunit: 'unitge',\n\t\tshowy: false,\n\t\tdv\n\t}\n}"}},71900:function(t,a,e){e.d(a,{Z:function(){return d}});var n=e(66252),r=e(3577),s={class:"head-info"};var o={name:"HeadInfo",props:["title","content"]};var d=(0,e(83744).Z)(o,[["render",function(t,a,e,o,d,u){return(0,n.wg)(),(0,n.iD)("div",s,[(0,n._)("span",null,(0,r.zw)(e.title),1),(0,n._)("p",null,[(0,n.Uk)((0,r.zw)(e.content),1),(0,n.WI)(t.$slots,"body",{},void 0,!0)])])}],["__scopeId","data-v-00006846"]])},10935:function(t,a,e){e.r(a),e.d(a,{default:function(){return y}});e(74916),e(64765);var n=e(66252),r=(0,n._)("div",null,null,-1),s={class:"search-content"};var o=e(95082),d=(e(57658),e(41539),e(54747),e(15306),e(61103)),u=e(71900),i=e(47556),c=e(99684),l=e(89056),p=e(33907),h=(e(68309),e(3577)),m={class:"search-content"},f={class:"mb-3"},b={class:"content"};var T=e(69596),O={name:"DashboardListResults",i18n:e(89234),components:{CardList:T.Z,LayoutOutlined:l.Z},props:["dashboards","loading"],data:function(){return{key:"",projects:[],categray:[{value:!0,label:"All"},{value:!1,label:"Success"},{value:!1,label:"Pending"},{value:!1,label:"Error"}]}},computed:(0,o.Z)({},(0,p.rn)("setting",["layout","pageWidth"])),mounted:function(){},methods:{detail:function(t,a,e){this.$router.push({path:"/system/dashboard/detail/"+e.id})},remove:function(t,a,e){var n=this;this.$gql.mutation("deleteDashboard(id:".concat(e.id,"){data{id}}")).then((function(){n.$message.success(n.$t("Deleted successfully"),3),n.search()}))},search:function(){this.$emit("search")}}},E=e(83744);var _=(0,E.Z)(O,[["render",function(t,a,e,r,s,o){var d=(0,n.up)("LayoutOutlined"),u=(0,n.up)("a-card-meta"),i=(0,n.up)("CardList");return(0,n.wg)(),(0,n.iD)("div",m,[(0,n.Wm)(i,{"result-empty":{status:404,title:t.$t("No data")},loading:e.loading,"data-source":e.dashboards||[],"hide-action-title":!0,type:"component",actions:[{icon:"EditOutlined",text:t.$t("edit"),call:o.detail,permission:["dashboard:update"]},{icon:"DeleteOutlined",text:t.$t("delete"),call:o.remove,hide:!0,permission:["dashboard:delete"]}]},{default:(0,n.w5)((function(a){var e=a.item;return[(0,n.Wm)(u,null,{title:(0,n.w5)((function(){return[(0,n._)("div",f,(0,h.zw)(e.name),1)]})),avatar:(0,n.w5)((function(){return[(0,n.Wm)(d,{class:"LayoutOutlined primary"})]})),description:(0,n.w5)((function(){return[]})),_:2},1024),(0,n._)("div",b,[(0,n._)("div",null,[(0,n._)("p",null,(0,h.zw)(t.$t("Usage")),1),(0,n._)("p",null,(0,h.zw)(e.apply?e.apply:"-"),1)]),(0,n._)("div",null,[(0,n._)("p",null,(0,h.zw)(t.$t("Widgets")),1),(0,n._)("p",null,(0,h.zw)(e.widgets?e.widgets.length:0),1)])])]})),_:1},8,["result-empty","loading","data-source","actions"])])}],["__scopeId","data-v-6d6b9132"]]),S={name:"DashboardList",i18n:e(89234),components:{PageLayout:d.Z,DashboardListResults:_,PlusCircleTwoTone:c.Z,LayoutOutlined:l.Z,HeadInfo:u.Z},data:function(){return{dashboards:[],loading:!0}},computed:(0,o.Z)({},(0,p.rn)("setting",["layout","pageWidth"])),mounted:function(){this.search()},methods:{add:function(){var t=this;(0,i.DB)({name:"New Dashboard",widget:"",apply:""}).then((function(a){t.$router.push({path:"/system/dashboard/detail/"+a.dashboard.id})}))},search:function(){var t=this;this.loading=!0,this.$gql.query("dashboards{data{id,attributes{name,apply,content,updatedAt}}}").then((function(a){t.dashboards=a.data,t.dashboards.forEach((function(t){t.widgets=[],t.content.widget&&(t.widgets=t.content.widget.replace(/^,/g,"").split(","))})),t.loading=!1}))}}};var y=(0,E.Z)(S,[["render",function(t,a,e,o,d,u){var i=(0,n.up)("PlusCircleTwoTone"),c=(0,n.up)("HeadInfo"),l=(0,n.up)("DashboardListResults"),p=((0,n.up)("LayoutOutlined"),(0,n.up)("PageLayout")),h=(0,n.Q2)("permission");return(0,n.wg)(),(0,n.j4)(p,{avatar:t.LayoutOutlined,title:t.$t("Custom Dashboards")},{headerContent:(0,n.w5)((function(){return[r]})),extra:(0,n.w5)((function(){return[(0,n.wy)(((0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(c,{class:"split-right",title:t.$t("New Dashboard")},{body:(0,n.w5)((function(){return[(0,n._)("div",null,[(0,n.Wm)(i,{onClick:u.add,class:"font-primary icon-menu rotate-icon"},null,8,["onClick"])])]})),_:1},8,["title"])])),[[h,["dashboard:create"]]])]})),default:(0,n.w5)((function(){return[(0,n._)("div",s,[(0,n.Wm)(l,{ref:"result",loading:d.loading,dashboards:d.dashboards,onSearch:u.search},null,8,["loading","dashboards","onSearch"])]),(0,n.kq)("",!0)]})),_:1},8,["avatar","title"])}]])}}]);