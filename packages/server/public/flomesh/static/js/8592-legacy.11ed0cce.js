"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[8592],{68592:function(t,e,a){a.r(e),a.d(e,{default:function(){return u}});a(74916),a(64765),a(92222),a(2707);var n=a(66252),i=a(3577),o={key:1},r=["onClick"],s={key:2};a(21249),a(38862),a(15306),a(41539),a(54747),a(57658);var c=a(21936),d=[{key:"user",dataIndex:["user","username"]},{key:"Action",dataIndex:"action"},{key:"as",dataIndex:"name"},{key:"organization",dataIndex:["organization","name"]},{key:"From",dataIndex:"from"},{key:"Type",dataIndex:"type"},{key:"time",sorter:!0,dataIndex:"updatedAt"},{key:"content",dataIndex:"data"}],l={name:"EventList",components:{JsonEditor:c.Z},i18n:a(89234),data:function(){return{key:"",keyAction:"",visible:!1,pageSize:10,pageNo:1,total:0,loading:!0,advanced:!0,sorter:"updatedAt",sortOrder:"end$desc",columns:d,events:[]}},computed:{dataColumns:function(){var t=this;return this.columns.map((function(e){return e.title=t.$t(e.key),e.sorter&&t.sorter==e.dataIndex&&(e.sortOrder=t.sortOrder),e}))},start:function(){return(this.pageNo-1)*this.pageSize}},created:function(){this.search()},methods:{sort:function(t,e,a){this.sorter=a.field,this.sortOrder=a.order,this.search()},onClose:function(){this.visible=!1},detail:function(t){this.visible=!0,this.log=JSON.stringify(t||{})},search:function(t,e){var a=this;t&&(this.pageNo=t,this.pageSize=e);var n={start:this.start,limit:this.pageSize};this.loading=!0;var i=this.keyAction.replace(/\s*/g,""),o={user:{username:{contains:this.key}},name:{contains:i}},r="updatedAt:desc";this.sorter&&this.sortOrder&&(r=(r=this.sortOrder.replace(/\$/g,"")).replace(/end/g,""),r="".concat(this.sorter,":").concat(r)),this.$gql.query('myCustomEvents(filters: $filters, pagination: $pagination, sort: "'.concat(r,'"){\n\t\t\t\t\t\tdata{id,attributes{\n\t\t\t\t\t\t\tupdatedAt,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\taction,\n              content,\n              from,\n              type,\n\t\t\t\t\t\t\tuser{data{id,attributes{username}}},\n\t\t\t\t\t\t\torganization{data{id,attributes{name}}}\n\t\t\t\t\t\t}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}'),{filters:o,pagination:n},{filters:"CustomEventFiltersInput",pagination:"PaginationArg"}).then((function(t){a.events=t.data,t.data.forEach((function(t){t.actions=[],0==t.action.indexOf("create")?(t.actions.push("create"),t.actions.push(t.action.replace(/^create/,""))):0==t.action.indexOf("update")?(t.actions.push("update"),t.actions.push(t.action.replace(/^update/,""))):0==t.action.indexOf("delete")?(t.actions.push("delete"),t.actions.push(t.action.replace(/^delete/,""))):t.actions.push(t.action)})),a.total=t.pagination.total,a.loading=!1}))}}};var u=(0,a(83744).Z)(l,[["render",function(t,e,a,c,d,l){var u=(0,n.up)("a-input-search"),h=(0,n.up)("a-table"),p=(0,n.up)("a-card"),g=(0,n.up)("JsonEditor"),f=(0,n.up)("a-drawer");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(p,{title:t.$t("Operating record"),class:"nopd",loading:d.loading},{extra:(0,n.w5)((function(){return[(0,n._)("div",null,[(0,n.Wm)(u,{value:d.keyAction,"onUpdate:value":e[0]||(e[0]=function(t){return d.keyAction=t}),onSearch:e[1]||(e[1]=function(t){return l.search()}),class:"right-search-input",style:{width:"200px"},placeholder:t.$t("search")+" "+t.$t("Name")},null,8,["value","placeholder"]),(0,n.Wm)(u,{value:d.key,"onUpdate:value":e[2]||(e[2]=function(t){return d.key=t}),onSearch:e[3]||(e[3]=function(t){return l.search()}),class:"right-search-input",style:{width:"200px"},placeholder:t.$t("search")+" "+t.$t("User")},null,8,["value","placeholder"])])]})),default:(0,n.w5)((function(){return[(0,n._)("div",null,[(0,n.Wm)(h,{columns:l.dataColumns,"data-source":d.events,pagination:{showSizeChanger:!0,showQuickJumper:!1,onShowSizeChange:l.search,onChange:l.search,current:d.pageNo,pageSize:d.pageSize,showTotal:function(e,a){return"".concat(t.$t("Total")," ").concat(e)},total:d.total},onChange:l.sort},{bodyCell:(0,n.w5)((function(e){var a=e.column,c=e.record;return["action"===a.dataIndex?((0,n.wg)(!0),(0,n.iD)(n.HY,{key:0},(0,n.Ko)(c.actions,(function(e,a){return(0,n.wg)(),(0,n.iD)("b",{class:"mr-10",key:a},(0,i.zw)(t.$t(e)),1)})),128)):"data"===a.dataIndex?((0,n.wg)(),(0,n.iD)("div",o,[(0,n._)("a",{onClick:function(t){return l.detail(c.content)}},(0,i.zw)(t.$t("Data")),9,r)])):"createdAt"===a.dataIndex?((0,n.wg)(),(0,n.iD)("div",s,(0,i.zw)(new Date(c.createdAt).toLocaleString()),1)):(0,n.kq)("",!0)]})),_:1},8,["columns","data-source","pagination","onChange"])])]})),_:1},8,["title","loading"]),d.visible?((0,n.wg)(),(0,n.j4)(f,{key:0,"get-container":!1,title:t.$t("content"),placement:"bottom",height:"600",closable:!1,visible:d.visible,onClose:l.onClose},{default:(0,n.w5)((function(){return[(0,n.Wm)(g,{"is-readonly":!0,value:t.log},null,8,["value"])]})),_:1},8,["title","visible","onClose"])):(0,n.kq)("",!0)])}],["__scopeId","data-v-d6a49ad2"]])}}]);