"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[7102],{1299:function(t,e,a){a.d(e,{Z:function(){return u}});var n=a(66252),i=a(3577),l={key:0,class:"title"};a(9653);var r={name:"DetailList",props:{title:{type:String,required:!1,default:""},col:{type:Number,required:!1,default:3},size:{type:String,required:!1,default:"large"},layout:{type:String,required:!1,default:"horizontal"}}};var u=(0,a(83744).Z)(r,[["render",function(t,e,a,r,u,s){var o=(0,n.up)("a-row");return(0,n.wg)(),(0,n.iD)("div",{class:(0,i.C_)(["detail-list","small"===a.size?"small":"large","vertical"===a.layout?"vertical":"horizontal"]),style:(0,i.j5)("flex-"+a.col)},[a.title?((0,n.wg)(),(0,n.iD)("div",l,(0,i.zw)(a.title),1)):(0,n.kq)("",!0),(0,n.Wm)(o,null,{default:(0,n.w5)((function(){return[(0,n.WI)(t.$slots,"default")]})),_:3})],6)}]])},13589:function(t,e,a){a.d(e,{Z:function(){return s}});a(68309);var n=a(66252),i=a(3577),l={class:"detail-content"};a(21249);var r={1:{xs:24},2:{xs:24,sm:12},3:{xs:24,sm:12,md:8},4:{xs:24,sm:12,md:6}},u={name:"DetailListItem",i18n:a(39945),props:{name:{type:String,required:!1,default:""},rules:{type:Array,required:!1,default:function(){return[]}},term:{type:String,required:!1,default:""},termTop:{type:Boolean}},data:function(){return{col:2,responsive:r}},computed:{getRules:function(){var t=this;return this.rules.map((function(e){return e.message=t.$t(e.message),e})),this.rules}},created:function(){this.$parent&&this.$parent.$parent&&this.$parent.$parent.col>0&&(this.col=this.$parent.$parent.col)},methods:{}};var s=(0,a(83744).Z)(u,[["render",function(t,e,a,r,u,s){var o=(0,n.up)("a-form-item"),c=(0,n.up)("a-col");return(0,n.wg)(),(0,n.j4)(c,(0,n.dG)({class:"detail-list-content flex"},u.responsive[u.col]),{default:(0,n.w5)((function(){return[(0,n._)("div",{class:(0,i.C_)(a.termTop?"term top":"term")},(0,i.zw)(a.term),3),(0,n._)("div",l,[a.rules?((0,n.wg)(),(0,n.j4)(o,{key:0,name:a.name,rules:s.getRules},{default:(0,n.w5)((function(){return[(0,n.WI)(t.$slots,"default")]})),_:3},8,["name","rules"])):(0,n.WI)(t.$slots,"default",{key:1})])]})),_:3},16)}]])},47102:function(t,e,a){a.r(e),a.d(e,{default:function(){return g}});a(68309),a(74916),a(64765),a(92222),a(26699),a(32023);var n=a(66252),i=a(3577),l={key:0},r={key:1,class:"gray"};var u=a(66347),s=a(95082),o=(a(21249),a(41539),a(54747),a(57658),a(57327),a(9653),a(61103)),c=a(1299),d=a(33907),h=a(13589),f=[{dataIndex:"name",title:"Name"},{dataIndex:"type",title:"Type"}],m=[{dataIndex:"name",title:"Name"},{dataIndex:"type",title:"Type"}],p={name:"CheckpointDetail",i18n:a(89234),components:{DetailListItem:h.Z,DetailList:c.Z,PageLayout:o.Z},data:function(){return{detail:{healthcheck:{id:""},fleet:{id:""},content:{targets:[]},name:"",location:""},targetsVal:[],healthcheck:[],key:"",pageSize:10,pageNo:1,total:0,list:[],checkpoints:[],leftColumns:f,rightColumns:m}},computed:(0,s.Z)((0,s.Z)({},(0,d.rn)({rules:function(t){return t.rules.rules},isMobile:function(t){return t.setting.isMobile}})),{},{dataLeftColumns:function(){var t=this;return this.leftColumns.map((function(e){return e.title=t.$t(e.title),e}))},dataRightColumns:function(){var t=this;return this.leftColumns.map((function(e){return e.title=t.$t(e.title),e}))},start:function(){return(this.pageNo-1)*this.pageSize}}),created:function(){var t=this;this.pid=this.$route.params.id||"",this.uniSearch(),this.$gql.query("healthchecks{data{id,attributes{name,content}}}").then((function(e){t.healthcheck=e.data})),this.$gql.query('fleets(filters:{type:{eq:"checkpoint"}}){data{id,attributes{name}}}').then((function(e){t.checkpoints=e.data})),""!=this.pid?(this.loading=!0,this.$gql.query("dialTesting(id: ".concat(this.pid,"){data{id,attributes{\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t\thealthcheck{data{id}},\n\t\t\t\t\t\tfleet{data{id}},\n\t\t\t\t\t\tservices{data{id}},\n\t\t\t\t\t\tname,\n\t\t\t\t\t\tcreatedAt\n\t\t\t\t\t}}}")).then((function(e){var a=e.data;t.detail=a,t.detail.healthcheck=a.healthcheck,t.detail.fleet=a.fleet;var n=[];a.content.targets&&a.content.targets.forEach((function(t){n.push("".concat(t.id,",").concat(t.type,",").concat(t.name))})),t.targetsVal=n,t.loading=!1}))):(this.detail={healthcheck:{id:""},fleet:{id:""},checkpoints:[],content:{targets:[]},name:"",location:""},this.loading=!1),this.pid},methods:{onTabChange:function(t){},valid:function(){return""==this.detail.name?(this.$message.error(this.$t("The name cannot be empty"),3),!1):0!=this.targetsVal.length||(this.$message.error(this.$t("The targets cannot be empty"),3),!1)},validate:function(){var t=this;this.$refs.layout.$refs.form.validateFields().then((function(){t.save()})).catch((function(){}))},save:function(){var t=this;if(this.valid()){var e,a=[],n=(0,u.Z)(this.targetsVal);try{for(n.s();!(e=n.n()).done;){var i=e.value.split(",");a.push({id:i[0],type:i[1],name:i[2]})}}catch(t){n.e(t)}finally{n.f()}this.detail.content.targets=a;var l=a.filter((function(t){return"service"==t.type}));l=l.map((function(t){return Number(t.id)}));var r={name:this.detail.name,healthcheck:this.detail.healthcheck.id,fleet:this.detail.fleet.id,content:this.detail.content,services:l};""!=this.pid?this.$gql.mutation("updateDialTesting(id:".concat(this.pid,", data: $data){data{id}}"),{data:r},{data:"DialTestingInput!"}).then((function(){t.$message.success(t.$t("Save successfully"),3),t.$closePage(t.$route)})):this.$gql.mutation("createDialTesting(data: $data){data{id}}",{data:r},{data:"DialTestingInput!"}).then((function(e){t.pid=e.data.id,t.$message.success(t.$t("Created successfully"),3),t.$closePage(t.$route)}))}},handleChange:function(){},hide:function(){this.visible=!1,this.validate()},onChange:function(t){this.targetsVal=t},getRowSelection:function(t,e,a,n){return{getCheckboxProps:function(e){return{disabled:t||e.disabled}},onSelectAll:function(t,e){var n=e.filter((function(t){return!t.disabled})).map((function(t){return t.key}));a(n,t)},onSelect:function(t,e){n(t.key,e)},selectedRowKeys:e}},search:function(t,e){"left"==t&&(this.key=e,this.uniSearch())},pagging:function(t){this.pageNo=t},uniSearch:function(t,e){var a=this;t&&(this.pageNo=t,this.pageSize=e),this.loading=!0;var n={type:["upstream"],name:this.key};this.$gql.query("uniSearch(filters: $filters, pagination:{start: 0, limit: ".concat(this.$DFT_LIMIT,"})"),{filters:n}).then((function(t){a.list=t.data,a.list.forEach((function(t){t.key="".concat(t.target_id,",").concat(t.type,",").concat(t.name)})),a.total=t.pagination.total,a.loading=!1}))}}};var g=(0,a(83744).Z)(p,[["render",function(t,e,a,u,s,o){var c=(0,n.up)("a-input"),d=(0,n.up)("DetailListItem"),h=(0,n.up)("a-select-option"),f=(0,n.up)("a-select"),m=(0,n.up)("DetailList"),p=(0,n.up)("a-button"),g=(0,n.up)("a-table"),v=(0,n.up)("a-transfer"),y=(0,n.up)("a-card"),w=(0,n.up)("a-col"),k=(0,n.up)("a-row"),$=(0,n.up)("PageLayout");return(0,n.wg)(),(0,n.j4)($,{title:s.detail.name?s.detail.name:t.$t("Dial Test"),"form-state":s.detail,ref:"layout"},{headerContent:(0,n.w5)((function(){return[(0,n.Wm)(m,{size:"small",col:1},{default:(0,n.w5)((function(){return[(0,n.Wm)(d,{term:t.$t("as"),rules:t.rules.uniqueName("dialTestings",{id:t.pid}),name:"name"},{default:(0,n.w5)((function(){return[(0,n.Wm)(c,{placeholder:t.$t("unset"),value:s.detail.name,"onUpdate:value":e[0]||(e[0]=function(t){return s.detail.name=t}),class:"width-200"},null,8,["placeholder","value"])]})),_:1},8,["term","rules"]),(0,n.Wm)(d,{term:t.$t("Healthcheck"),rules:t.rules.required,name:["healthcheck","id"]},{default:(0,n.w5)((function(){return[(0,n.Wm)(f,{placeholder:t.$t("unallocated"),class:"width-200",value:s.detail.healthcheck.id,"onUpdate:value":e[1]||(e[1]=function(t){return s.detail.healthcheck.id=t}),onChange:e[2]||(e[2]=function(t){return o.handleChange()})},{default:(0,n.w5)((function(){return[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.healthcheck,(function(t,e){return(0,n.wg)(),(0,n.j4)(h,{key:e,value:t.id},{default:(0,n.w5)((function(){return[t.name?((0,n.wg)(),(0,n.iD)("span",l,(0,i.zw)(t.name),1)):(0,n.kq)("",!0),t.name?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("i",r,(0,i.zw)(t.name),1))]})),_:2},1032,["value"])})),128))]})),_:1},8,["placeholder","value"])]})),_:1},8,["term","rules"]),(0,n.Wm)(d,{term:t.$t("Checkpoints"),rules:t.rules.required,name:["fleet","id"]},{default:(0,n.w5)((function(){return[(0,n.Wm)(f,{placeholder:t.$t("unallocated"),class:"width-200",value:s.detail.fleet.id,"onUpdate:value":e[3]||(e[3]=function(t){return s.detail.fleet.id=t}),onChange:e[4]||(e[4]=function(t){return o.handleChange()})},{default:(0,n.w5)((function(){return[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.checkpoints,(function(t,e){return(0,n.wg)(),(0,n.j4)(h,{key:e,value:t.id},{default:(0,n.w5)((function(){return[(0,n._)("span",null,(0,i.zw)(t.name),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["placeholder","value"])]})),_:1},8,["term","rules"])]})),_:1})]})),action:(0,n.w5)((function(){return[(0,n.Wm)(p,{type:"primary",onClick:o.validate},{default:(0,n.w5)((function(){return[(0,n.Uk)((0,i.zw)(""!=t.pid?t.$t("save"):t.$t("create")),1)]})),_:1},8,["onClick"])]})),default:(0,n.w5)((function(){return[(0,n.Wm)(k,{class:"row-mg"},{default:(0,n.w5)((function(){return[(0,n.Wm)(w,{class:"col-pd",xl:24,lg:24,md:24,sm:24,xs:24},{default:(0,n.w5)((function(){return[(0,n.Wm)(y,{title:t.$t("Checkpoint Target")},{default:(0,n.w5)((function(){return[(0,n.Wm)(v,{titles:[" "+t.$t("Checkpoint Target")," "+t.$t("Added")],"data-source":s.list,"target-keys":s.targetsVal,"onUpdate:target-keys":e[5]||(e[5]=function(t){return s.targetsVal=t}),"show-search":!0,"filter-option":function(t,e){return-1!==e.name.indexOf(t)},"show-select-all":!1,onSearch:o.search,onChange:o.onChange},{children:(0,n.w5)((function(e){var a=e.direction,l=e.filteredItems,r=e.selectedKeys,u=e.disabled,c=e.onItemSelectAll,d=e.onItemSelect;return[(0,n.Wm)(g,{"row-selection":o.getRowSelection(u,r,c,d),columns:"left"===a?o.dataLeftColumns:o.dataRightColumns,"data-source":l,size:"small",pagination:"left"===a&&{onChange:o.pagging,current:s.pageNo,pageSize:s.pageSize,showTotal:function(e,a){return"".concat(t.$t("Total")," ").concat(e)},total:s.total},style:(0,i.j5)({pointerEvents:u?"none":null}),"custom-row":function(t){var e=t.key,a=t.disabled;return{onClick:function(){a||u||d(e,!r.includes(e))}}}},null,8,["row-selection","columns","data-source","pagination","style","custom-row"])]})),_:1},8,["titles","data-source","target-keys","filter-option","onSearch","onChange"])]})),_:1},8,["title"])]})),_:1})]})),_:1})]})),_:1},8,["title","form-state"])}]])}}]);