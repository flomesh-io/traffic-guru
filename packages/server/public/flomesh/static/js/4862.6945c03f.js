(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[4862],{27780:function(t,e,a){"use strict";a.d(e,{Z:function(){return d}});var i=a(66252),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M709.6 210l.4-.2h.2L512 96 313.9 209.8h-.2l.7.3L151.5 304v416L512 928l360.5-208V304l-162.9-94zM482.7 843.6L339.6 761V621.4L210 547.8V372.9l272.7 157.3v313.4zM238.2 321.5l134.7-77.8 138.9 79.7 139.1-79.9 135.2 78-273.9 158-274-158zM814 548.3l-128.8 73.1v139.1l-143.9 83V530.4L814 373.1v175.2z"}}]},name:"code-sandbox",theme:"outlined"},s=a(33058);function n(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?Object(arguments[e]):{},i=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(a).filter((function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})))),i.forEach((function(e){o(t,e,a[e])}))}return t}function o(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var r=function(t,e){var a=n({},t,e.attrs);return(0,i.Wm)(s.Z,n({},a,{icon:l}),null)};r.displayName="CodeSandboxOutlined",r.inheritAttrs=!1;var d=r},74353:function(t,e,a){"use strict";a.d(e,{Z:function(){return d}});var i=a(66252),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},s=a(33058);function n(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?Object(arguments[e]):{},i=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(a).filter((function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})))),i.forEach((function(e){o(t,e,a[e])}))}return t}function o(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var r=function(t,e){var a=n({},t,e.attrs);return(0,i.Wm)(s.Z,n({},a,{icon:l}),null)};r.displayName="StopOutlined",r.inheritAttrs=!1;var d=r},85117:function(t,e,a){"use strict";var i=a(66330),l=TypeError;t.exports=function(t,e){if(!delete t[e])throw l("Cannot delete property "+i(e)+" of "+i(t))}},30541:function(t,e,a){"use strict";var i=a(82109),l=a(47908),s=a(26244),n=a(83658),o=a(85117),r=a(7207),d=1!==[].unshift(0),p=!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}();i({target:"Array",proto:!0,arity:1,forced:d||p},{unshift:function(t){var e=l(this),a=s(e),i=arguments.length;if(i){r(a+i);for(var d=a;d--;){var p=d+i;d in e?e[p]=e[d]:o(e,p)}for(var u=0;u<i;u++)e[u]=arguments[u]}return n(e,a+i)}})},79797:function(t,e,a){!function(){"use strict";var e=a(17536).typeOf;t.exports.stringify=function(t){var a,i="";return"---"+(a={undefined:function(){return"null"},null:function(){return"null"},number:function(t){return t},boolean:function(t){return t?"true":"false"},string:function(t){return JSON.stringify(t)},array:function(t){var l="";return 0===t.length?l+="[]":(i=i.replace(/$/,"  "),t.forEach((function(t){var s=a[e(t)];if(!s)throw new Error("what the crap: "+e(t));l+="\n"+i+"- "+s(t)})),i=i.replace(/  /,""),l)},object:function(t){var l="";return 0===Object.keys(t).length?l+="{}":(i=i.replace(/$/,"  "),Object.keys(t).forEach((function(s){var n=t[s],o=a[e(n)];if(void 0!==n){if(!o)throw new Error("what the crap: "+e(n));l+="\n"+i+s+": "+o(n)}})),i=i.replace(/  /,""),l)},function:function(){return"[object Function]"}})[e(t)](t)+"\n"}}()},17536:function(t){!function(){"use strict";var e,a,i=Function("return this")(),l="Boolean Number String Function Array Date RegExp Object".split(" "),s={};for(e in l)l.hasOwnProperty(e)&&(a=l[e],s["[object "+a+"]"]=a.toLowerCase());function n(t){return null==t?String(t):s[Object.prototype.toString.call(t)]||"object"}function o(t){var e,a;if("object"===n(t))for(e in t)if(void 0!==(a=t[e])&&"function"!==n(a))return!1;return!0}String.prototype.entityify||(String.prototype.entityify=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}),String.prototype.quote||(String.prototype.quote=function(){var t,e,a=this.length,i='"';for(e=0;e<a;e+=1)if((t=this.charAt(e))>=" ")"\\"!==t&&'"'!==t||(i+="\\"),i+=t;else switch(t){case"\b":i+="\\b";break;case"\f":i+="\\f";break;case"\n":i+="\\n";break;case"\r":i+="\\r";break;case"\t":i+="\\t";break;default:t=t.charCodeAt(),i+="\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16)}return i+'"'}),String.prototype.supplant||(String.prototype.supplant=function(t){return this.replace(/{([^{}]*)}/g,(function(e,a){var i=t[a];return"string"==typeof i||"number"==typeof i?i:e}))}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s*(\S*(?:\s+\S+)*)\s*$/,"$1")}),t.exports={typeOf:n,isEmpty:o},i.typeOf=i.typeOf||n,i.isEmpty=i.isEmpty||o}()},44107:function(t,e,a){"use strict";a.d(e,{Z:function(){return p}});var i=a(66252),l=a(3577);var s=a(21936),n=a(8333);let o=a(79797),r=a(93320);var d={name:"Json2YamlCard",components:{JsonEditor:s.Z,YamlEditor:n.Z},props:["jsonVal","isCreate","height","isReadonly","url","isPop"],i18n:a(89234),data(){return{configTab:[{key:"YAML",tab:"YAML"},{key:"JSON",tab:"JSON"}],configKey:"YAML",json:"{}",yaml:""}},watch:{json(t,e){t!=e&&this.jsonInput(t)},yaml(t,e){t!=e&&this.yamlInput(t)},jsonVal:{handler(t,e){if("{}"!=t&&""!=t||(t='{"key":"value"}'),t!=e){"object"==typeof JSON.parse(t)&&(this.json=t)}},immediate:!0}},created(){},mounted(){this.init()},methods:{onTabChange(t,e){this[e]=t},jsonInput(t){try{"object"==typeof JSON.parse(t)&&(this.yaml=this.convertToYaml(t),this.$emit("update:jsonVal",this.json),this.$emit("change",this.json))}catch(t){}},yamlInput(t){let e=r.load(t),a=JSON.stringify(e,null,"  ");"object"==typeof JSON.parse(a)&&(this.$emit("update:jsonVal",a),this.$emit("change",a))},getDefaultYamlConfig(){if(!this.url)return this.yaml=this.convertToYaml(this.jsonVal),void this.yamlInput(this.yaml);fetch(this.url).then((t=>t.text())).then((t=>{this.url.indexOf(".yaml");let e=r.load(t),a=JSON.stringify(e,null,"  "),i=JSON.parse(a);i.spec&&i.spec.namespace&&(i.spec.namespace="_all"==localStorage.getItem("NAMESPACE")?"default":localStorage.getItem("NAMESPACE"));let l=JSON.stringify(i);this.yaml=this.convertToYaml(l),setTimeout((()=>{this.yamlInput(this.yaml)}),2e3)})).catch((()=>{}))},convertToYaml(t){if(""==t)return"";let e=JSON.parse(t),a=null;return a=o.stringify(e),a},init(){this.isCreate?this.getDefaultYamlConfig():(this.yaml=this.convertToYaml(this.jsonVal),this.yamlInput(this.yaml))}}};var p=(0,a(83744).Z)(d,[["render",function(t,e,a,s,n,o){const r=(0,i.up)("YamlEditor"),d=(0,i.up)("JsonEditor"),p=(0,i.up)("a-button"),u=(0,i.up)("a-card");return(0,i.wg)(),(0,i.j4)(u,{class:(0,l.C_)(["card nopd",a.isPop?"isPop":""]),"tab-list":n.configTab,"active-tab-key":n.configKey,onTabChange:e[2]||(e[2]=t=>o.onTabChange(t,"configKey")),bordered:!1},{tabBarExtraContent:(0,i.w5)((()=>[a.url?((0,i.wg)(),(0,i.j4)(p,{key:0,type:"dashed",onClick:o.getDefaultYamlConfig},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("reset")),1)])),_:1},8,["onClick"])):(0,i.kq)("",!0)])),default:(0,i.w5)((()=>["YAML"==n.configKey?((0,i.wg)(),(0,i.j4)(r,{key:0,height:a.height,"is-readonly":a.isReadonly,value:n.yaml,"onUpdate:value":e[0]||(e[0]=t=>n.yaml=t)},null,8,["height","is-readonly","value"])):(0,i.kq)("",!0),"JSON"==n.configKey?((0,i.wg)(),(0,i.j4)(d,{key:1,height:a.height,"is-readonly":a.isReadonly,"is-json":!0,noreset:!a.isReadonly,value:n.json,"onUpdate:value":e[1]||(e[1]=t=>n.json=t)},null,8,["height","is-readonly","noreset","value"])):(0,i.kq)("",!0)])),_:1},8,["class","tab-list","active-tab-key"])}]])},38718:function(t,e,a){"use strict";a.d(e,{Z:function(){return v}});var i=a(66252),l=a(3577),s=a(87932);const n=(t=>((0,i.dD)("data-v-357cff26"),t=t(),(0,i.Cn)(),t))((()=>(0,i._)("img",{src:s,style:{width:"300px"}},null,-1))),o=["src"],r={key:1};var d=a(75255),p=a(54367),u=a(50976),c=a(1006),h=a(9294),m={name:"PluginConfig",i18n:a(89234),components:{AutoForm:u.Z,CheckOutlined:d.Z,CloseOutlined:p.Z,JsEditor:h.Z},props:["type","addText","plugins","disabled"],data(){return{DEFAULT_BASE_URL:c.DEFAULT_BASE_URL,tabList:[{key:"Config",tab:"Config"},{key:"Script",tab:"Script"}],loading:!0}},computed:{},watch:{plugins:{handler(){this.plugins&&this.plugins.forEach((t=>{t.content.tabVal||(t.content.tabVal="Config")}))},immediate:!0,deep:!0}},mounted(){},created(){this.loading=!1},methods:{onTabChange(t,e){this.plugins[e].content.tabVal=t},remove(t){this.plugins.splice(t,1)},add(){this.$emit("add",{})}}};var v=(0,a(83744).Z)(m,[["render",function(t,e,a,s,d,p){const u=(0,i.up)("a-button"),c=(0,i.up)("a-result"),h=(0,i.up)("CheckOutlined"),m=(0,i.up)("a-switch"),v=(0,i.up)("CloseOutlined"),g=(0,i.up)("AutoForm"),w=(0,i.up)("JsEditor"),y=(0,i.up)("a-card"),f=(0,i.Q2)("permission");return(0,i.wg)(),(0,i.iD)(i.HY,null,[0==a.plugins.length?((0,i.wg)(),(0,i.j4)(c,{key:0,title:t.$t("No data")},{icon:(0,i.w5)((()=>[n])),extra:(0,i.w5)((()=>[a.addText&&"service"==a.type?(0,i.wy)(((0,i.wg)(),(0,i.j4)(u,{key:0,disabled:a.disabled,type:"primary",onClick:p.add},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t(a.addText)),1)])),_:1},8,["disabled","onClick"])),[[f,["service:update"]]]):a.addText?((0,i.wg)(),(0,i.j4)(u,{key:1,disabled:a.disabled,type:"primary",onClick:p.add},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t(a.addText)),1)])),_:1},8,["disabled","onClick"])):(0,i.kq)("",!0)])),_:1},8,["title"])):(0,i.kq)("",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.plugins,((e,s)=>((0,i.wg)(),(0,i.j4)(y,{key:s,class:(0,l.C_)(["card mb-24","Script"==e.content.tabVal?"nopd":""]),"tab-list":d.tabList,"active-tab-key":e.content.tabVal,onTabChange:t=>p.onTabChange(t,s),bordered:!1,loading:d.loading},{customTab:(0,i.w5)((e=>[(0,i.Uk)((0,l.zw)(t.$t(e.key)),1)])),title:(0,i.w5)((()=>[e.icon?((0,i.wg)(),(0,i.iD)("img",{key:0,src:d.DEFAULT_BASE_URL+e.icon.url,alt:"avatar",class:"card-img"},null,8,o)):(0,i.kq)("",!0),(0,i.Uk)(" "+(0,l.zw)(e.name)+" ",1),e.content.displayName&&e.name!=e.content.displayName?((0,i.wg)(),(0,i.iD)("span",r," ( "+(0,l.zw)(e.content.displayName)+" ) ",1)):(0,i.kq)("",!0)])),extra:(0,i.w5)((()=>[(0,i.Wm)(m,{checked:e.enable,"onUpdate:checked":t=>e.enable=t,disabled:a.disabled},{checkedChildren:(0,i.w5)((()=>[(0,i.Wm)(h)])),unCheckedChildren:(0,i.w5)((()=>[])),_:2},1032,["checked","onUpdate:checked","disabled"]),(0,i.Wm)(v,{class:(0,l.C_)([a.disabled?"disabled":"","gray"]),onClick:t=>p.remove(s)},null,8,["class","onClick"])])),default:(0,i.w5)((()=>["Config"==e.content.tabVal?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,l.C_)(a.disabled?"disabled":"")},[(0,i.Wm)(g,{fields:[e.content.fields],col:3},null,8,["fields"])],2)):((0,i.wg)(),(0,i.j4)(w,{key:1,"is-readonly":a.disabled,id:"pluginScript"+s,value:e.content.script,"onUpdate:value":t=>e.content.script=t},null,8,["is-readonly","id","value","onUpdate:value"]))])),_:2},1032,["class","tab-list","active-tab-key","onTabChange","loading"])))),128))],64)}],["__scopeId","data-v-357cff26"]])},9294:function(t,e,a){"use strict";a.d(e,{Z:function(){return n}});var i=a(66252);var l=a(29764);(0,a(25552).H)({id:"javascript",extensions:[".js",".es6",".jsx",".mjs"],firstLine:"^#!.*\\bnode",filenames:["jakefile"],aliases:["JavaScript","javascript","js"],mimetypes:["text/javascript"],loader:function(){return a.e(6015).then(a.bind(a,6015))}});var s={name:"JsEditor",components:{monacoeditor:l.Z},props:["value","height","isReadonly","id","theme"],data(){return{code:"",cmOptions:{lineNumbers:!0,mode:"javascript",readOnly:!1,lint:!0}}},watch:{value(t,e){t!==e&&this.setValue()}},mounted(){this.setValue()},methods:{change(t){"string"==typeof t&&(this.$emit("update:value",t),this.$emit("change",t))},setValue(){null!=this.value.replace&&(this.code=this.value)}}};var n=(0,a(83744).Z)(s,[["render",function(t,e,a,l,s,n){const o=(0,i.up)("monacoeditor");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(o,{id:a.id||"JsEditor",content:s.code,"onUpdate:content":e[0]||(e[0]=t=>s.code=t),option:s.cmOptions,onChange:n.change,height:a.height,theme:a.theme,"is-readonly":a.isReadonly},null,8,["id","content","option","onChange","height","theme","is-readonly"])])}]])},990:function(t,e,a){"use strict";a.d(e,{Z:function(){return o}});var i=a(66252);const l={class:"DashboardCore"};var s=a(56912),n={name:"Dashboard",i18n:a(89234),components:{DashboardCore:s.Z},props:["pageId","prometheus","apply","params","hideAdd","init","defaultWidget"],data(){return{prometheusVal:null}},computed:{},watch:{prometheus(t){this.prometheusVal=t}},created(){},mounted(){this.prometheusVal=this.prometheus},methods:{prometheusChange(){this.$emit("update:prometheus",this.prometheusVal),this.$emit("prometheusChange",this.prometheusVal)}}};var o=(0,a(83744).Z)(n,[["render",function(t,e,a,s,n,o){const r=(0,i.up)("DashboardCore");return(0,i.wg)(),(0,i.iD)("div",l,[(0,i.Wm)(r,{"hide-add":a.hideAdd,init:a.init,"hide-head":!0,"page-id":a.pageId,params:a.params,kind:a.apply,prometheus:n.prometheusVal,"onUpdate:prometheus":e[0]||(e[0]=t=>n.prometheusVal=t),onPrometheusChange:o.prometheusChange,apply:a.apply+"."+a.pageId,embed:!0,"default-widget":a.defaultWidget},null,8,["hide-add","init","page-id","params","kind","prometheus","onPrometheusChange","apply","default-widget"])])}]])},1299:function(t,e,a){"use strict";a.d(e,{Z:function(){return o}});var i=a(66252),l=a(3577);const s={key:0,class:"title"};var n={name:"DetailList",props:{title:{type:String,required:!1,default:""},col:{type:Number,required:!1,default:3},size:{type:String,required:!1,default:"large"},layout:{type:String,required:!1,default:"horizontal"}}};var o=(0,a(83744).Z)(n,[["render",function(t,e,a,n,o,r){const d=(0,i.up)("a-row");return(0,i.wg)(),(0,i.iD)("div",{class:(0,l.C_)(["detail-list","small"===a.size?"small":"large","vertical"===a.layout?"vertical":"horizontal"]),style:(0,l.j5)("flex-"+a.col)},[a.title?((0,i.wg)(),(0,i.iD)("div",s,(0,l.zw)(a.title),1)):(0,i.kq)("",!0),(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[(0,i.WI)(t.$slots,"default")])),_:3})],6)}]])},13589:function(t,e,a){"use strict";a.d(e,{Z:function(){return r}});var i=a(66252),l=a(3577);const s={class:"detail-content"};const n={1:{xs:24},2:{xs:24,sm:12},3:{xs:24,sm:12,md:8},4:{xs:24,sm:12,md:6}};var o={name:"DetailListItem",i18n:a(39945),props:{name:{type:String,required:!1,default:""},rules:{type:Array,required:!1,default(){return[]}},term:{type:String,required:!1,default:""},termTop:{type:Boolean}},data(){return{col:2,responsive:n}},computed:{getRules(){return this.rules.map((t=>(t.message=this.$t(t.message),t))),this.rules}},created(){this.$parent&&this.$parent.$parent&&this.$parent.$parent.col>0&&(this.col=this.$parent.$parent.col)},methods:{}};var r=(0,a(83744).Z)(o,[["render",function(t,e,a,n,o,r){const d=(0,i.up)("a-form-item"),p=(0,i.up)("a-col");return(0,i.wg)(),(0,i.j4)(p,(0,i.dG)({class:"detail-list-content flex"},o.responsive[o.col]),{default:(0,i.w5)((()=>[(0,i._)("div",{class:(0,l.C_)(a.termTop?"term top":"term")},(0,l.zw)(a.term),3),(0,i._)("div",s,[a.rules?((0,i.wg)(),(0,i.j4)(d,{key:0,name:a.name,rules:r.getRules},{default:(0,i.w5)((()=>[(0,i.WI)(t.$slots,"default")])),_:3},8,["name","rules"])):(0,i.WI)(t.$slots,"default",{key:1})])])),_:3},16)}]])},92911:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return Ot}});var i=a(66252),l=a(3577),s=a(49963);const n=t=>((0,i.dD)("data-v-769f7a1a"),t=t(),(0,i.Cn)(),t),o={class:"template-div"},r={key:0},d={key:1,class:"gray"},p={key:0},u={key:1,class:"gray"},c=["onClick"],h=["onClick"],m={class:"list-content width-230"},v={class:"list-content-item"},g=n((()=>(0,i._)("span",null,"Methods",-1))),w=["onClick"],y={key:0},f={key:0},b={key:1},k={key:2},$=["onClick"],_={class:"list-content"},C={class:"flex list-content-item"},P={class:"flex-item"},S={class:"flex-item pl-10"},W=n((()=>(0,i._)("div",{class:"swagger",id:"swagger"},null,-1))),j={key:0},z=["onClick"],U={key:0},A={key:1},D={key:0},E={key:0,class:"absolute",style:{right:"0"}},x=["onClick"],O=["onClick"],q={key:0},T={key:1,class:"width-80"},I={class:"pt-10"},L={key:0},N={key:1,class:"gray"},V={class:"ml-15 pt-10"},R={key:0},H={key:1,class:"gray"},Z={class:"ml-15 pt-10"},K=n((()=>(0,i._)("text",{class:"ml-10 pt-10"}," => ",-1))),Y={class:"width-80"},F={key:0},B={key:0};a(57658),a(30541);var M=a(96486),J=a.n(M),G=a(11416),Q=a.n(G),X=a(44107),tt=a(38718),et=a(79954),at=a(77809),it=a(47556),lt=a(74353),st=a(99684),nt=a(2692),ot=a(75255),rt=a(54367),dt=a(44218),pt=a(52255),ut=a(16527),ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917 211.1l-199.2 24c-6.6.8-9.4 8.9-4.7 13.6l59.3 59.3-226 226-101.8-101.7c-6.3-6.3-16.4-6.2-22.6 0L100.3 754.1a8.03 8.03 0 000 11.3l45 45.2c3.1 3.1 8.2 3.1 11.3 0L433.3 534 535 635.7c6.3 6.2 16.4 6.2 22.6 0L829 364.5l59.3 59.3a8.01 8.01 0 0013.6-4.7l24-199.2c.7-5.1-3.7-9.5-8.9-8.8z"}}]},name:"rise",theme:"outlined"},ht=a(33058);function mt(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?Object(arguments[e]):{},i=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(a).filter((function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable})))),i.forEach((function(e){vt(t,e,a[e])}))}return t}function vt(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var gt=function(t,e){var a=mt({},t,e.attrs);return(0,i.Wm)(ht.Z,mt({},a,{icon:ct}),null)};gt.displayName="RiseOutlined",gt.inheritAttrs=!1;var wt=gt,yt=a(64137),ft=a(27780),bt=a(62611),kt=a(61103),_t=a(1299),Ct=a(13589),Pt=a(79332),St=a(33907),Wt=a(71900),jt=a(48551),zt=a(21936),Ut=a(49702),At=a(990),Dt=a(34531);let Et=a(93320);var xt={name:"ApiDetail",i18n:a(89234),components:{HeadInfo:Wt.Z,FormItem:Pt.Z,StopOutlined:lt.Z,DetailListItem:Ct.Z,DetailList:_t.Z,PageLayout:kt.Z,MiniArea:jt.Z,JsonEditor:zt.Z,PlusCircleTwoTone:st.Z,MoreOutlined:nt.Z,CheckOutlined:ot.Z,CloseOutlined:rt.Z,Json2YamlCard:X.Z,PlusOutlined:dt.Z,PauseOutlined:pt.Z,RocketOutlined:ut.Z,PluginConfig:tt.Z,PolicyList:at.default,PluginList:et.Z,LogViewer:Ut.Z,EmbedDashboard:At.Z,RiseOutlined:wt,CardSelector:Dt.Z,MinusCircleTwoTone:yt.Z,CodeSandboxOutlined:ft.Z,PartitionOutlined:bt.Z},props:["embed","name"],data(){return{RiseOutlined:wt,DEFAULT_API_DETAIL:it.zN,detail:{project:null,pipy:null,blacklistServices:[],whitelistServices:[],name:"",status:0,step:0,approvalLevel:0,scope:1,content:{log:{level:"All"},metadata:{labels:{}},isCanary:!1,plugins:[],versions:{},hosts:{},systemCode:[],endpoints:[],providers:[],msg:[[],[],[],[]]},spec:"{}"},labelVisible:!1,labelValue:"",projects:[],pipys:[],type:"API",screenWidth:document.body.clientWidth,systemCodeVisible:!1,systemCodeValue:"",visibleAP:!1,versionVisible:!1,versionValue:"",hostVisible:!1,hostValue:"",visibleReview:!1,visibleRevise:!1,visibleDeploy:!1,visibleStop:!1,visibleRestart:!1,description1:"",description2:"",description3:"",description4:"",step:0,stepStatus:"process",editorIsCreate:!0,activeKey:"1",upstreams:[],functions:["func1","func2","func3"],zones:["zone1","zone2","zone3"],payloadEndpoint:{host:"192.168.1.1\n192.168.1.2",path:"subpath1/\nsubpath2/",customPaths:[],protocols:["HTTP","HTTPS"],methods:["GET","POST","PATCH","PUT","DELETE","HEAD","OPTIONS"],stripPath:!0,preserveHost:!1},payloadProvider:{name:"pro1",content:"192.168.1.1",path:"subpath1/",id:"test01",protocols:["HTTP","HTTPS"],type:"Host",versions:[],hosts:[],isDefault:!1,upstream:{id:null},upstreamId:""},types:["Host","Upstream"],protocols:["HTTP","HTTPS","WS","MQTT","HTTP2","GRPC","REDIS","DUBBO","TCP"],methods:["GET","POST","PATCH","PUT","DELETE","HEAD","OPTIONS"],endpoints:[],approvalLevels:[],providers:[],bindPolicy:null,visiblelog:!1,visibleEndpoint:!1,visibleProvider:!1,loading:!0,logloading:!0,swaggerLoading:!0,logs:[],log:"{}",pid:"",pcontent:"",pspec:"",filter:"",params:{pageNo:1,pageSize:10,total:0},application:{loading:!0,key:"",pageSize:10,pageNo:1,total:0,list:[]},applies:{loading:!0,key:"",pageSize:10,pageNo:1,total:0,list:[]},black:{loading:!0,key:"",pageSize:10,pageNo:1,total:0,list:[]},white:{loading:!0,key:"",pageSize:10,pageNo:1,total:0,list:[]},profiles:[],clusters:[],tps:[],tpsCnt:0,activeTabKey:"2"}},computed:{...(0,St.rn)({rules:t=>t.rules.rules,isMobile:t=>t.setting.isMobile}),...(0,St.Se)("account",["user"]),appliesStart(){return(this.applies.pageNo-1)*this.applies.pageSize},applicationStart(){return(this.application.pageNo-1)*this.application.pageSize},dataleftColumns(){return[{dataIndex:"name",title:this.$t("Name")},{dataIndex:"clusterName",title:this.$t("cluster")}]},datarightColumns(){return[{dataIndex:"name",title:this.$t("Name")},{dataIndex:"clusterName",title:this.$t("cluster")}]},findApprovalLevel(){let t=null;return this.approvalLevels.forEach((e=>{e.value==this.detail.approvalLevel&&(t=e)})),t},appliesCnt(){let t=0;return(this.detail.subscribeApiApplies||[]).forEach((e=>{0==e.status&&t++})),t}},created(){this.getBlackUpstreams(),this.getWhiteUpstreams(),this.pid=this.$route.params.id||"",this.pcontent=this.$route.params.content||"",this.pspec=this.$route.params.spec||"",this.type=0==this.$route.path.indexOf("/openapi/policy")?"Policy":"API",this.activeKey="Policy"==this.type?"2":"1",this.editorIsCreate=""==this.pid,this.embed&&(this.pid="")},mounted(){this.$gql.query("projects{data{id,attributes{name}}}").then((t=>{this.projects=t.data})),this.$gql.query("upstreams{data{id,attributes{name,content}}}").then((t=>{this.upstreams=t.data})),this.$gql.query('systemSettings(filters:{type:{eq:"ApiApprovalLevelType"}}){data{id,attributes{mode,content}}}').then((t=>{this.approvalLevels=[{label:"unset",value:0,approvalRoles:null}],this.approvalLevels=this.approvalLevels.concat(t.data[0].content),this.approvalLevels.forEach((t=>{t.value=1*t.value}))})),this.$gql.query('fleets(filters:{type:{eq:"pipy"}}){data{id,attributes{name,content,upstreams{data{id,attributes{content}}}}}}').then((t=>{this.pipys=t.data})),""!=this.pid?this.loadapi():this.pcontent?(this.detail.content=JSON.parse(this.pcontent),this.detail.content.metadata=this.detail.content.metadata?this.detail.content.metadata:{},this.detail.content.metadata.labels=this.detail.content.metadata.labels?this.detail.content.metadata.labels:{},this.pspec?this.detail.spec=this.pspec:this.detail.spec="{}",this.loading=!1):(this.detail={project:null,pipy:null,name:"",status:0,step:0,approvalLevel:0,scope:1,content:{log:{level:"All"},metadata:{labels:{}},plugins:[],versions:{},systemCode:[],endpoints:[],providers:[],msg:[[],[],[],[]]},spec:"{}"},this.loading=!1),this.embed&&(this.detail.name=this.name);const t=this;window&&(window.onresize=()=>{window.screenWidth=document.body.clientWidth,t.screenWidth=window.screenWidth})},methods:{appDetail(t){this.$router.push({path:"/openapi/application/detail/"+t})},handleClose(t,e){delete t[e]},labelShowInput(){this.labelVisible=!0,this.$nextTick().then((()=>{this.$refs.labelRef.focus()}))},labelInputConfirm(){if(""==this.labelValue)return void(this.labelVisible=!1);let t=this.labelValue.split(":");t.length<2?this.$message.error({content:this.$t("Please enter the format of [key]:[value]")}):(this.detail.content.metadata.labels=this.detail.content.metadata.labels||{},this.detail.content.metadata.labels[t.shift()]=t.join(":"),this.labelValue="",this.labelVisible=!1)},finish(){},finishFailed(){},getHistory(t){let e=t.content;if(e||(e={}),e.history){if(e.history.length<this.detail.approvalLevel){e.history=[];for(let t=0;t<this.detail.approvalLevel-e.history.length;t++)e.history.push({time:"",user:{}})}}else{e.history=[];for(let t=0;t<this.detail.approvalLevel;t++)e.history.push({time:"",user:{}})}return e.history[t.approvalStep]={time:(new Date).toLocaleString(),user:this.user},e},removeSubApi(t){this.$gql.query(`application(id:${t.id}){data{id,attributes{apis{data{id,attributes{name}}}}}}`).then((e=>{let a=[];e.data.apis.forEach((t=>{a.push(t.id)})),a=a.filter((t=>t!=this.pid)),this.$gql.mutation(`updateApplication(id:${t.id}, data: $data){data{id}}`,{data:{apis:a}},{data:"ApplicationInput!"}).then((()=>{this.loadapi(),this.$message.success($t("Removed successfully"),3)}))}))},approvalApply(t){this.$gql.mutation(`updateSubscribeApiApply(id:${t.id}, data: $data){data{id,attributes{approvalStep,status}}}`,{data:{status:t.approvalStep+1==this.detail.approvalLevel?1:0,approvalStep:t.approvalStep+1==this.detail.approvalLevel?t.approvalStep:t.approvalStep+1,content:this.getHistory(t)}},{data:"SubscribeApiApplyInput!"}).then((e=>{e.data.approvalStep+1==this.detail.approvalLevel&&1==e.data.status?this.$gql.query(`application(id:${t.application.id}){data{id,attributes{apis{data{id,attributes{name}}}}}}`).then((e=>{let a=[];e.data.apis.forEach((t=>{a.push(t.id)})),a.push(this.pid),this.$gql.mutation(`updateApplication(id:${t.application.id}, data: $data){data{id}}`,{data:{apis:a}},{data:"ApplicationInput!"}).then((()=>{this.loadapi(),this.$message.success(this.$t("Save successfully"),3)}))})):(this.loadapi(),this.$message.success(this.$t("Save successfully"),3))}))},refuseApply(t){this.$gql.mutation(`updateSubscribeApiApply(id:${t.id}, data: $data){data{id}}`,{data:{status:2,content:this.getHistory(t)}},{data:"SubscribeApiApplyInput!"}).then((()=>{this.$message.success(this.$t("Save successfully"),3),this.loadapi()}))},selectPlugin(t){this.detail.content.plugins.push({...t,enable:!0}),this.visibleAP=!1,this.$message.success(this.$t("Added successfully"),3)},showPluginBox(){this.visibleAP=!0},changePrdDefault(t,e){this.detail.content.providers.forEach(((t,a)=>{e!=a&&(t.isDefault=!1)})),t.isDefault&&this.detail.content.providers.unshift(this.detail.content.providers.splice(e,1)[0])},handleArrayClose(t,e){t.splice(e,1)},systemCodeShowInput(){this.systemCodeVisible=!0,this.$nextTick().then((()=>{this.$refs.systemCodeRef.focus()}))},systemCodeInputConfirm(){""!=this.systemCodeValue?(this.detail.content.systemCode.push(this.systemCodeValue),this.systemCodeValue="",this.systemCodeVisible=!1):this.systemCodeVisible=!1},versionShowInput(){this.versionVisible=!0,this.$nextTick().then((()=>{this.$refs.versionRef.focus()}))},versionInputConfirm(){""!=this.versionValue?(this.payloadProvider.versions.push(this.versionValue),this.versionValue="",this.versionVisible=!1):this.versionVisible=!1},hostShowInput(){this.hostVisible=!0,this.$nextTick().then((()=>{this.$refs.hostRef.focus()}))},hostInputConfirm(){""!=this.hostValue?(this.payloadProvider.hosts||(this.payloadProvider.hosts=[]),this.payloadProvider.hosts.push(this.hostValue),this.hostValue="",this.hostVisible=!1):this.hostVisible=!1},toReview(t,e){this.detail.step=1,this.stepStatus="process",this.detail.content.msg[e].unshift(t),this.visibleReview=!1,this.validate()},toRevise(t,e){this.detail.step=0,this.stepStatus="error",this.detail.content.msg[e].unshift(t),this.visibleRevise=!1,this.validate()},toDeploy(t,e){this.detail.step=2,this.stepStatus="process",this.detail.content.msg[e].unshift(t),this.visibleDeploy=!1,this.validate()},toStop(t,e){this.detail.step=3,this.stepStatus="error",this.detail.content.msg[e].unshift(t),this.visibleStop=!1,this.validate()},toRestart(t,e){this.detail.step=2,this.stepStatus="process",this.detail.content.msg[e].unshift(t),this.visibleRestart=!1,this.validate()},validForm(){this.$refs.form.validateFields().then((()=>{this.handleOkEndpoint()})).catch((()=>{}))},handleOkEndpoint(){this.visibleEndpoint=!1,this.isEdit||this.detail.content.endpoints.push(J().cloneDeep(this.payloadEndpoint))},validProvider(){this.$refs.providerForm.validateFields().then((()=>{this.handleOkProvider()})).catch((()=>{}))},handleOkProvider(){this.visibleProvider=!1,this.upstreams.forEach((t=>{t.id==this.payloadProvider.upstreamId&&(this.payloadProvider.upstream=t)})),this.isEdit||this.detail.content.providers.push(J().cloneDeep(this.payloadProvider))},addEndpoint(){this.isEdit=!1,this.payloadEndpoint={host:"",path:"",customPaths:[],protocols:[],methods:[],stripPath:!0,preserveHost:!1,denyenable:!1,regExpPriority:1,dubboMethodName:"",dubboMethodSignature:""},this.visibleEndpoint=!0},editEndpoint(t){this.isEdit=!0,this.payloadEndpoint=t,this.visibleEndpoint=!0},addProvider(){this.isEdit=!1,this.payloadProvider={name:"",content:"",path:"/",versions:[],upstream:{id:null},protocols:[],type:"Host",payloadProvider:""},this.visibleProvider=!0},editProvider(t){this.isEdit=!0,this.payloadProvider=t,this.visibleProvider=!0,this.payloadProvider.upstream&&this.payloadProvider.upstream.id&&this.upstreams.forEach((t=>{this.payloadProvider.upstream.id==t.id&&(this.payloadProvider.upstream=t,this.payloadProvider.upstreamId=this.payloadProvider.upstream.id)}))},removeEndpoint(t){this.detail.content.endpoints.splice(t,1)},removeProvider(t){this.detail.content.providers.splice(t,1)},onTabChange(t){},valid(){if(""==this.detail.name)return this.$message.error(this.$t("The name cannot be empty"),3),!1;if(this.detail.content.providers)for(let t=0;t<this.detail.content.providers.length;t++)if(t>0&&this.detail.content.providers[t].type!=this.detail.content.providers[t-1].type)return this.$message.error(this.$t("All providers can only set the same type"),3),!1;if(this.detail.content.plugins)for(const t of this.detail.content.plugins)if("black-white-list"==t.name)for(const e of t.content.fields)if("header"==e.name)try{e.value&&JSON.parse(e.value)}catch(t){return this.$message.error(this.$t("The header format of the black-white-list plugin is incorrect"),3),!1}return!0},validate(){this.$refs.layout.$refs.form.validateFields().then((()=>{this.save()})).catch((()=>{}))},saveLogLevel(t){this.detail.content.log.level=t.logLevel,this.save()},save(){if(!this.valid())return;1==this.detail.content.providers.length&&(this.detail.content.providers[0].isDefault=!0);let t=J().cloneDeep(this.detail);t.spec=JSON.parse(t.spec),this.bindPolicy?t.policy=this.bindPolicy.id:t.policy=void 0,t.plugins=[],t.content.plugins&&t.content.plugins.forEach((e=>{e.content.fields.forEach((t=>{"number"==t.type&&(t.value=Number(t.value))})),t.plugins.push(e.id)})),delete t.createdAt,delete t.updatedAt,delete t.id,delete t.chart,delete t.subscribeApiApplies;let e=[];for(const a of t.content.providers)"Upstream"==a.type&&e.push(Number(a.upstream.id));t.upstreams=e,""!=this.pid?this.$gql.mutation(`updateApi(id:${this.pid}, data: $data){data{id}}`,{data:t},{data:"ApiInput!"}).then((()=>{this.$message.success(this.$t("Save successfully"),3)})):this.$gql.mutation("createApi(data: $data){data{id}}",{data:t},{data:"ApiInput!"}).then((t=>{this.pid=t.data.id,this.$router.replace({path:"/openapi/api/detail/"+this.pid}),this.$message.success(this.$t("Created successfully"),3)}))},handleChange(){},hide(){this.visible=!1},clearSelector(){this.payloadProvider.upstream=null,this.payloadProvider.upstreamId=null},saveSelector(t){this.payloadProvider.upstream=t,this.payloadProvider.upstreamId=t.id},swaggerchange(){setTimeout((()=>{let t=this.detail.spec?JSON.parse(this.detail.spec):"";Q()({spec:t,dom_id:"#swagger",deepLinking:!1,presets:[Q().presets.apis,Q().SwaggerUIStandalonePreset],plugins:[Q().plugins.DownloadUrl]})}),300)},getDefaultSwaggerConfig(){fetch("swagger.yaml").then((t=>t.text())).then((t=>{let e=Et.load(t),a=JSON.stringify(e,null,"  ");this.detail.spec=a,Q()({spec:e,dom_id:"#swagger",deepLinking:!1,presets:[Q().presets.apis,Q().SwaggerUIStandalonePreset],plugins:[Q().plugins.DownloadUrl]})})).catch((t=>{}))},selectPolicy(t){this.bindPolicy=t,this.detail.content.plugins=t.content.plugins,this.$message.success(this.$t("Bound policy")+"："+t.name,3)},resetPolicy(){this.bindPolicy=null,this.$message.success(this.$t("Custom policy restored"),3)},selectUpStream(t){const e=this.upstreams.find((e=>e.id==t));e&&e.content&&e.content.path&&(this.payloadProvider.path=e.content.path)},onBlackChange(t){this.detail.blacklistServices=t},onWhiteChange(t){this.detail.whitelistServices=t},getRowSelection(t,e,a,i){return{getCheckboxProps:e=>({disabled:t||e.disabled}),onSelectAll(t,e){const i=e.filter((t=>!t.disabled)).map((({key:t})=>t));a(i,t)},onSelect(t,e){i(t.key,e)},selectedRowKeys:e}},blackSearch(t,e){"left"==t&&(this.black.key=e,this.getBlackUpstreams())},whiteSearch(t,e){"left"==t&&(this.white.key=e,this.getWhiteUpstreams())},blackPagging(t){this.black.pageNo=t},whitePagging(t){this.white.pageNo=t},getBlackUpstreams(t,e,a){this.getUpstreams(this.black,t,e,a)},getWhiteUpstreams(t,e,a){this.getUpstreams(this.white,t,e,a)},getUpstreams(t,e,a){e&&(t.pageNo=e,t.pageSize=a),t.loading=!0;let i={name:{contains:t.key}};this.$gql.query(`upstreams(pagination:{start: 0, limit: ${this.$DFT_LIMIT}}, filters: $filters){\n\t\t\t\t\t\tdata{id,attributes{\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\tpipy{data{id,attributes{name}}},\n\t\t\t\t\t\t\tcluster{data{id,attributes{name}}},\n\t\t\t\t\t\t\tdescription\n\t\t\t\t\t\t}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}`,{filters:i},{filters:"UpstreamFiltersInput"}).then((e=>{t.list=e.data,t.list.forEach((t=>{t.cluster?t.clusterName=t.cluster.name:t.clusterName="-",t.key=`${t.id}`})),t.total=e.pagination.total,t.loading=!1}))},addCustompath(){0!=this.detail.content.providers.length?(this.payloadEndpoint.customPaths||(this.payloadEndpoint.customPaths=[]),this.payloadEndpoint.customPaths.push({path:[],providers:[],oldPath:"",newPath:""})):this.$message.error(this.$t("Please add a provider for the current API first"),3)},removeCustompath(t){let e=this.payloadEndpoint.customPaths.indexOf(t);-1!==e&&this.payloadEndpoint.customPaths.splice(e,1)},searchApplications(t){this.application.pageNo=t||1,this.loading=!0;let e={apis:{id:{eq:this.pid}}};this.$gql.query(`applications(filters: $filters, pagination:{start: ${this.applicationStart}, limit: ${this.application.pageSize}}){\n\t\t\t\t\t\tdata{id,attributes{\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tproject{data{id,attributes{\n\t\t\t\t\t\t\t\torganization{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\t}}},\n\t\t\t\t\t\t\tapis{data{id,attributes{name}}},\n\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\t}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}`,{filters:e},{filters:"ApplicationFiltersInput"}).then((t=>{this.application.list=t.data,this.application.total=t.pagination.total,this.application.loading=!1}))},searchApplies(t){this.applies.pageNo=t||1,this.loading=!0;let e={api:{id:{eq:this.pid}}};this.$gql.query(`subscribeApiApplies(filters: $filters, pagination:{start: ${this.appliesStart}, limit: ${this.applies.pageSize}}){\n\t\t\t\t\t\tdata{id,attributes{\n\t\t\t\t\t\t\tmsg,\n\t\t\t\t\t\t\tstatus,\n\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\tapprovalStep,\n\t\t\t\t\t\t\tapplication{data{id,attributes{name}}},\n\t\t\t\t\t\t\tapplyUser{data{id,attributes{username}}},\n\t\t\t\t\t\t\tcreatedAt,\n\t\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\t}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}`,{filters:e},{filters:"SubscribeApiApplyFiltersInput"}).then((t=>{this.applies.list=t.data,this.applies.total=t.pagination.total,this.applies.loading=!1}))},loadapi(){this.loading=!0,this.$gql.query(`api(id: ${this.pid}){data{id,attributes{\n\t\t\t\t\t\tuid,\n\t\t\t\t\t\tname,\n\t\t\t\t\t\tstatus,\n\t\t\t\t\t\tapprovalLevel,\n\t\t\t\t\t\tsubscribeApiApplies{data{id,attributes{\n\t\t\t\t\t\t\tmsg,\n\t\t\t\t\t\t\tstatus,\n\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\tapprovalStep,\n\t\t\t\t\t\t\tapplication{data{id,attributes{name}}},\n\t\t\t\t\t\t\tapplyUser{data{id,attributes{username}}},\n\t\t\t\t\t\t\tcreatedAt,\n\t\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\t}}},\n\t\t\t\t\t\tstep,\n\t\t\t\t\t\tscope,\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t\tspec,\n\t\t\t\t\t\tchart,\n\t\t\t\t\t\tblacklistServices{data{id}},\n\t\t\t\t\t\twhitelistServices{data{id}},\n\t\t\t\t\t\tpolicy{data{id,attributes{name,content}}},\n\t\t\t\t\t\tplugins{data{id,attributes{\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\ticon{data{id,attributes{url,previewUrl}}},\n\t\t\t\t\t\t\ttype{data{id,attributes{name}}},\n\t\t\t\t\t\t\tdesc,\n\t\t\t\t\t\t\tcontent\n\t\t\t\t\t\t}}},\n\t\t\t\t\t\tproject{data{id}},\n\t\t\t\t\t\tpipy{data{id}},\n\t\t\t\t\t\tcreatedAt,\n\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t}}}`).then((t=>{this.loading=!1;let e=t.data;if(this.detail=e,this.detail.spec=JSON.stringify(e.spec),this.detail.project=e.project?e.project.id:null,this.detail.content.metadata=e.content.metadata?e.content.metadata:{},this.detail.content.metadata.labels=e.content.metadata.labels?e.content.metadata.labels:{},this.detail.content.log||(this.detail.content.log={}),this.detail.content.log.level||(this.detail.content.log.level="All"),this.detail.pipy?this.detail.pipy=e.pipy.id:this.detail.pipy=null,this.detail.content.systemCode&&this.detail.content.systemCode.length||(this.detail.content.systemCode=[]),this.detail.content.versions||(this.detail.content.versions={}),this.detail.content.plugins||(this.detail.content.plugins=[]),this.detail.content.isCanary||(this.detail.content.isCanary=!1),this.detail.policy&&(this.detail.content.plugins=this.detail.policy?.content?.plugins),this.detail.blacklistServices){let t=this.detail.blacklistServices;this.detail.blacklistServices=[],t.forEach((t=>{this.detail.blacklistServices.push(t.id)}))}else this.detail.blacklistServices=[];if(this.detail.whitelistServices){let t=this.detail.whitelistServices;this.detail.whitelistServices=[],t.forEach((t=>{this.detail.whitelistServices.push(t.id)}))}else this.detail.whitelistServices=[];let a={};this.detail.content.plugins&&this.detail.content.plugins.forEach((t=>{a[t.id]=t,a[t.id].content.script||(a[t.id].content.script="")})),this.detail.content.plugins=[],this.detail.plugins&&this.detail.plugins.forEach((t=>{t.content.script=a[t.id].content.script,t.content.script||(t.content.script=""),a[t.id]?(a[t.id].content.fields&&t.content.fields&&t.content.fields.forEach((e=>{a[t.id].content.fields.forEach((t=>{e.name==t.name&&(e.value=t.value)}))})),t.enable=a[t.id].enable):t.enable=!1,this.detail.content.plugins.push(t)})),this.detail.content.providers&&this.detail.content.providers.forEach((t=>{t.isDefault=!!t.isDefault&&t.isDefault})),this.bindPolicy=this.detail.policy?.data})),this.searchApplications(),this.searchApplies()}}};var Ot=(0,a(83744).Z)(xt,[["render",function(t,e,a,n,M,J){const G=(0,i.up)("a-tooltip"),Q=(0,i.up)("a-step"),X=(0,i.up)("RocketOutlined"),tt=(0,i.up)("PauseOutlined"),et=(0,i.up)("a-steps"),at=(0,i.up)("DetailListItem"),it=(0,i.up)("a-input"),lt=(0,i.up)("a-select-option"),st=(0,i.up)("a-select"),nt=(0,i.up)("a-tag"),ot=(0,i.up)("PlusOutlined"),rt=(0,i.up)("a-radio"),dt=(0,i.up)("a-radio-group"),pt=(0,i.up)("DetailList"),ut=((0,i.up)("HeadInfo"),(0,i.up)("a-button")),ct=(0,i.up)("a-textarea"),ht=(0,i.up)("a-popover"),mt=(0,i.up)("PlusCircleTwoTone"),vt=(0,i.up)("a-list-item-meta"),gt=(0,i.up)("a-menu-item"),wt=(0,i.up)("a-popconfirm"),yt=(0,i.up)("a-menu"),ft=(0,i.up)("MoreOutlined"),bt=(0,i.up)("a-dropdown"),kt=(0,i.up)("a-list-item"),$t=(0,i.up)("a-list"),_t=(0,i.up)("a-card"),Ct=(0,i.up)("a-switch"),Pt=(0,i.up)("a-col"),St=(0,i.up)("MiniArea"),Wt=(0,i.up)("JsonEditor"),jt=(0,i.up)("a-drawer"),zt=(0,i.up)("a-row"),Ut=(0,i.up)("a-tab-pane"),At=(0,i.up)("a-divider"),Dt=(0,i.up)("PluginConfig"),Et=(0,i.up)("PolicyList"),xt=(0,i.up)("Json2YamlCard"),Ot=(0,i.up)("LogViewer"),qt=(0,i.up)("a-table"),Tt=(0,i.up)("a-transfer"),It=(0,i.up)("a-badge"),Lt=(0,i.up)("CodeSandboxOutlined"),Nt=(0,i.up)("StopOutlined"),Vt=(0,i.up)("PartitionOutlined"),Rt=(0,i.up)("CloseOutlined"),Ht=(0,i.up)("CheckOutlined"),Zt=(0,i.up)("EmbedDashboard"),Kt=(0,i.up)("a-tabs"),Yt=(0,i.up)("PageLayout"),Ft=(0,i.up)("a-descriptions-item"),Bt=(0,i.up)("FormItem"),Mt=(0,i.up)("MinusCircleTwoTone"),Jt=(0,i.up)("a-descriptions"),Gt=(0,i.up)("a-form"),Qt=(0,i.up)("a-modal"),Xt=(0,i.up)("CardSelector"),te=(0,i.up)("PluginList"),ee=((0,i.up)("RiseOutlined"),(0,i.Q2)("permission"));return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(Yt,{"hide-breadcrumb":a.embed,title:a.embed?" ":M.detail.name?M.detail.name:t.$t("new")+t.$t(M.type),"form-state":M.detail,ref:"layout"},(0,i.Nv)({headerContent:(0,i.w5)((()=>[(0,i._)("div",o,[(0,i.Wm)(et,{status:M.stepStatus,type:"navigation",current:M.detail.step,"onUpdate:current":e[0]||(e[0]=t=>M.detail.step=t),size:"small",class:"steps"},{default:(0,i.w5)((()=>[(0,i.Wm)(Q,{disabled:!0,title:t.$t("Design")},{description:(0,i.w5)((()=>[(0,i.Wm)(G,null,{title:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(M.detail.content.msg[0][0]||t.$t("No description")),1)])),default:(0,i.w5)((()=>[(0,i.Uk)(" "+(0,l.zw)(M.detail.content.msg[0][0]?t.$t("View notes"):t.$t("No description")),1)])),_:1})])),_:1},8,["title"]),(0,i.Wm)(Q,{disabled:!0,title:t.$t("Review")},{description:(0,i.w5)((()=>[(0,i.Wm)(G,null,{title:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(M.detail.content.msg[1][0]||t.$t("No description")),1)])),default:(0,i.w5)((()=>[(0,i.Uk)(" "+(0,l.zw)(M.detail.content.msg[1][0]?t.$t("Approval opinions"):t.$t("No description")),1)])),_:1})])),_:1},8,["title"]),(0,i.Wm)(Q,{disabled:!0,title:t.$t("Run")},{icon:(0,i.w5)((()=>[(0,i.Wm)(X)])),description:(0,i.w5)((()=>[(0,i.Wm)(G,null,{title:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(M.detail.content.msg[2][0]||t.$t("No description")),1)])),default:(0,i.w5)((()=>[(0,i.Uk)(" "+(0,l.zw)(M.detail.content.msg[2][0]?t.$t("View notes"):t.$t("No description")),1)])),_:1})])),_:1},8,["title"]),(0,i.Wm)(Q,{disabled:!0,title:t.$t("Stop")},{icon:(0,i.w5)((()=>[(0,i.Wm)(tt)])),description:(0,i.w5)((()=>[(0,i.Wm)(G,null,{title:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(M.detail.content.msg[3][0]||t.$t("No description")),1)])),default:(0,i.w5)((()=>[(0,i.Uk)(" "+(0,l.zw)(M.detail.content.msg[3][0]?t.$t("View notes"):t.$t("No description")),1)])),_:1})])),_:1},8,["title"])])),_:1},8,["status","current"])]),(0,i.Wm)(pt,{size:"small",col:1},{default:(0,i.w5)((()=>[""!=M.pid?((0,i.wg)(),(0,i.j4)(at,{key:0,term:t.$t("UID")},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(M.detail.uid),1)])),_:1},8,["term"])):(0,i.kq)("",!0),a.embed?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(at,{key:1,term:t.$t("as"),name:"name",rules:t.rules.uniqueName("apis",{id:M.pid,project:M.detail.project})},{default:(0,i.w5)((()=>[(0,i.Wm)(it,{placeholder:t.$t("unset"),value:M.detail.name,"onUpdate:value":e[1]||(e[1]=t=>M.detail.name=t),class:"width-200"},null,8,["placeholder","value"])])),_:1},8,["term","rules"])),(0,i.Wm)(at,{term:t.$t("Project"),name:"project",rules:t.rules.required},{default:(0,i.w5)((()=>[(0,i.Wm)(st,{placeholder:t.$t("unallocated"),class:"width-200",value:M.detail.project,"onUpdate:value":e[2]||(e[2]=t=>M.detail.project=t),onChange:e[3]||(e[3]=t=>J.handleChange())},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.projects,((t,e)=>((0,i.wg)(),(0,i.j4)(lt,{key:e,value:t.id},{default:(0,i.w5)((()=>[t.id?((0,i.wg)(),(0,i.iD)("span",r,(0,l.zw)(t.name),1)):(0,i.kq)("",!0),t.id?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("i",d,(0,l.zw)(t.name),1))])),_:2},1032,["value"])))),128))])),_:1},8,["placeholder","value"])])),_:1},8,["term","rules"]),(0,i.Wm)(at,{term:t.$t("Pipy"),name:"pipy",rules:t.rules.required},{default:(0,i.w5)((()=>[(0,i.Wm)(st,{placeholder:t.$t("unallocated"),class:"width-160",value:M.detail.pipy,"onUpdate:value":e[4]||(e[4]=t=>M.detail.pipy=t),onChange:e[5]||(e[5]=t=>J.handleChange())},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.pipys,((t,e)=>((0,i.wg)(),(0,i.j4)(lt,{key:e,value:t.id},{default:(0,i.w5)((()=>[t.id?((0,i.wg)(),(0,i.iD)("span",p,(0,l.zw)(t.name),1)):(0,i.kq)("",!0),t.id?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("i",u,(0,l.zw)(t.name),1))])),_:2},1032,["value"])))),128))])),_:1},8,["placeholder","value"])])),_:1},8,["term","rules"]),(0,i.Wm)(at,{term:t.$t("Labels")},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(Object.keys(M.detail.content.metadata.labels||{}),((t,e)=>((0,i.wg)(),(0,i.j4)(nt,{key:e,onClose:e=>J.handleClose(M.detail.content.metadata.labels,t),closable:!0},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t)+":"+(0,l.zw)(M.detail.content.metadata.labels[t]),1)])),_:2},1032,["onClose"])))),128)),(0,i.wy)((0,i.Wm)(it,{ref:"labelRef",type:"text",size:"small",class:"width-100",placeholder:"[KEY:VALUE]",value:M.labelValue,"onUpdate:value":e[6]||(e[6]=t=>M.labelValue=t),onBlur:J.labelInputConfirm,onKeyup:(0,s.D2)(J.labelInputConfirm,["enter"])},null,8,["value","onBlur","onKeyup"]),[[s.F8,M.labelVisible]]),M.labelVisible?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(nt,{key:0,onClick:J.labelShowInput,class:"dashed-tag"},{default:(0,i.w5)((()=>[(0,i.Wm)(ot),(0,i.Uk)(" "+(0,l.zw)(t.$t("add")),1)])),_:1},8,["onClick"]))])),_:1},8,["term"]),(0,i.Wm)(at,{term:t.$t("Permission")},{default:(0,i.w5)((()=>[(0,i.Wm)(dt,{value:M.detail.scope,"onUpdate:value":e[7]||(e[7]=t=>M.detail.scope=t)},{default:(0,i.w5)((()=>[(0,i.Wm)(rt,{value:1},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Public")),1)])),_:1}),(0,i.Wm)(rt,{value:2},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Private")),1)])),_:1})])),_:1},8,["value"])])),_:1},8,["term"]),(0,i.Wm)(at,{term:t.$t("Audit Level")},{default:(0,i.w5)((()=>[(0,i.Wm)(st,{placeholder:t.$t("unset"),class:"width-120",value:M.detail.approvalLevel,"onUpdate:value":e[8]||(e[8]=t=>M.detail.approvalLevel=t)},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.approvalLevels,((e,a)=>((0,i.wg)(),(0,i.j4)(lt,{key:a,value:e.value},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t(e.label)),1)])),_:2},1032,["value"])))),128))])),_:1},8,["placeholder","value"]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.approvalLevels,((t,e)=>((0,i.wg)(),(0,i.iD)("div",{class:"inline-block",key:e},[M.detail.approvalLevel>0&&t.value==M.detail.approvalLevel?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"relative",style:(0,l.j5)([{top:"-15px",left:"10px"},"width:"+100*M.detail.approvalLevel+"px"])},[(0,i.Wm)(et,{current:-1,size:"small"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.approvalRoles,((t,e)=>((0,i.wg)(),(0,i.j4)(Q,{key:e,title:t.label},null,8,["title"])))),128))])),_:2},1024)],4)):(0,i.kq)("",!0)])))),128))])),_:1},8,["term"])])),_:1})])),default:(0,i.w5)((()=>[(0,i.Wm)(zt,{class:"row-mg"},{default:(0,i.w5)((()=>[(0,i.Wm)(Pt,{class:"col-pd",xl:24,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((()=>[(0,i.Wm)(Kt,{type:"card",activeKey:M.activeKey,"onUpdate:activeKey":e[28]||(e[28]=t=>M.activeKey=t)},{rightExtra:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(ut,{type:"primary",onClick:J.showPluginBox},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Add Plugin")),1)])),_:1},8,["onClick"]),[[s.F8,"2"==M.activeKey&&!M.bindPolicy&&M.detail.content.plugins.length>0]])])),default:(0,i.w5)((()=>["API"==M.type?((0,i.wg)(),(0,i.j4)(Ut,{key:"1",tab:t.$t("Overview")},{default:(0,i.w5)((()=>[(0,i.Wm)(zt,{class:"row-mg"},{default:(0,i.w5)((()=>[(0,i.Wm)(Pt,{class:"col-pd",xl:""!=M.pid?14:24,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((()=>[(0,i.Wm)(_t,{class:"nopd",bordered:!1,title:t.$t("Endpoints"),loading:M.loading},{extra:(0,i.w5)((()=>[(0,i._)("div",null,[(0,i.Wm)(ut,{type:"link",shape:"circle",onClick:J.addEndpoint},{icon:(0,i.w5)((()=>[(0,i.Wm)(mt,{class:"font-20 icon-menu-sm rotate-icon"})])),_:1},8,["onClick"])])])),default:(0,i.w5)((()=>[(0,i.Wm)($t,{size:"large",pagination:!1},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.detail.content.endpoints,((e,a)=>((0,i.wg)(),(0,i.j4)(kt,{key:a},{actions:(0,i.w5)((()=>[(0,i._)("div",null,[(0,i.Wm)(bt,null,{overlay:(0,i.w5)((()=>[(0,i.Wm)(yt,null,{default:(0,i.w5)((()=>[(0,i.Wm)(gt,null,{default:(0,i.w5)((()=>[(0,i._)("a",{onClick:t=>J.editEndpoint(e)},(0,l.zw)(t.$t("edit")),9,h)])),_:2},1024),(0,i.Wm)(gt,null,{default:(0,i.w5)((()=>[(0,i.Wm)(wt,{placement:"topLeft","ok-text":t.$t("Yes"),"cancel-text":t.$t("No"),onConfirm:t=>J.removeEndpoint(a)},{title:(0,i.w5)((()=>[(0,i._)("p",null,(0,l.zw)(t.$t("Tip")),1),(0,i._)("p",null,(0,l.zw)(t.$t("Are you sure to remove this?")),1)])),default:(0,i.w5)((()=>[(0,i._)("a",null,(0,l.zw)(t.$t("Remove")),1)])),_:2},1032,["ok-text","cancel-text","onConfirm"])])),_:2},1024)])),_:2},1024)])),default:(0,i.w5)((()=>[(0,i._)("a",null,[(0,i.Wm)(ft,{class:"mr-20"})])])),_:2},1024)])])),default:(0,i.w5)((()=>[(0,i.Wm)(vt,null,{title:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.protocols,((t,e)=>((0,i.wg)(),(0,i.j4)(nt,{color:"HTTPS"==t?"#23B899":"#00adef",key:e},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t),1)])),_:2},1032,["color"])))),128)),(0,i._)("a",{onClick:t=>J.editEndpoint(e)},(0,l.zw)(e.host?e.host.replace(/\n/g,","):"-"),9,c)])),description:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.path?e.path.replace(/\n/g,","):"-"),1)])),_:2},1024),(0,i._)("div",m,[(0,i._)("div",v,[g,(0,i._)("p",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.methods,((t,e)=>((0,i.wg)(),(0,i.j4)(nt,{key:e,class:"mb-5"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t),1)])),_:2},1024)))),128))])])])])),_:2},1024)))),128))])),_:1})])),_:1},8,["title","loading"]),(0,i.Wm)(_t,{class:"mt-15 nopd",bordered:!1,title:t.$t("Providers"),loading:M.loading},{extra:(0,i.w5)((()=>[(0,i._)("div",null,[(0,i.Wm)(ut,{type:"link",shape:"circle",onClick:J.addProvider},{icon:(0,i.w5)((()=>[(0,i.Wm)(mt,{class:"font-20 icon-menu-sm rotate-icon"})])),_:1},8,["onClick"])])])),default:(0,i.w5)((()=>[(0,i.Wm)($t,{size:"large",pagination:!1},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.detail.content.providers,((e,a)=>((0,i.wg)(),(0,i.j4)(kt,{key:a},{actions:(0,i.w5)((()=>[(0,i._)("div",null,[(0,i.Wm)(bt,null,{overlay:(0,i.w5)((()=>[(0,i.Wm)(yt,null,{default:(0,i.w5)((()=>[(0,i.Wm)(gt,null,{default:(0,i.w5)((()=>[(0,i._)("a",{onClick:t=>J.editProvider(e)},(0,l.zw)(t.$t("edit")),9,$)])),_:2},1024),(0,i.Wm)(gt,null,{default:(0,i.w5)((()=>[(0,i.Wm)(wt,{placement:"topLeft","ok-text":t.$t("Yes"),"cancel-text":t.$t("No"),onConfirm:t=>J.removeProvider(a)},{title:(0,i.w5)((()=>[(0,i._)("p",null,(0,l.zw)(t.$t("Tip")),1),(0,i._)("p",null,(0,l.zw)(t.$t("Are you sure to remove this?")),1)])),default:(0,i.w5)((()=>[(0,i._)("a",null,(0,l.zw)(t.$t("Remove")),1)])),_:2},1032,["ok-text","cancel-text","onConfirm"])])),_:2},1024)])),_:2},1024)])),default:(0,i.w5)((()=>[(0,i._)("a",null,[(0,i.Wm)(ft,{class:"mr-20"})])])),_:2},1024)])])),default:(0,i.w5)((()=>[(0,i.Wm)(vt,null,{title:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.protocols,((t,e)=>((0,i.wg)(),(0,i.j4)(nt,{color:"HTTPS"==t?"#23B899":"#00adef",key:e},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t),1)])),_:2},1032,["color"])))),128)),(0,i._)("a",{onClick:t=>J.editProvider(e)},["Upstream"==e.type&&e.upstream&&e.upstream.name?((0,i.wg)(),(0,i.iD)("span",y,[e.upstream.content.displayName?((0,i.wg)(),(0,i.iD)("span",f,(0,l.zw)(e.upstream.content.displayName||e.upstream.name),1)):(0,i.kq)("",!0)])):"Host"==e.type&&e.hosts&&e.hosts.length>0?((0,i.wg)(),(0,i.iD)("span",b,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.hosts,((t,e)=>((0,i.wg)(),(0,i.iD)("span",{key:e},(0,l.zw)(t)+"; ",1)))),128))])):((0,i.wg)(),(0,i.iD)("span",k,(0,l.zw)(e.content),1)),(0,i.Uk)(" ( "+(0,l.zw)(e.type)+" ) ",1)],8,w)])),description:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.path?e.path:"-"),1)])),_:2},1024),(0,i._)("div",_,[(0,i._)("div",C,[(0,i._)("div",P,[(0,i._)("span",null,(0,l.zw)(t.$t("as")),1),(0,i._)("p",null,[(0,i.Wm)(nt,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.name),1)])),_:2},1024)])]),(0,i._)("div",S,[(0,i._)("span",null,(0,l.zw)(t.$t("Default")),1),(0,i._)("p",null,[(0,i.Wm)(Ct,{onChange:t=>J.changePrdDefault(e,a),checked:e.isDefault,"onUpdate:checked":t=>e.isDefault=t,size:"small"},null,8,["onChange","checked","onUpdate:checked"])])])])])])),_:2},1024)))),128))])),_:1})])),_:1},8,["title","loading"])])),_:1},8,["xl"]),""!=M.pid&&M.detail.chart?((0,i.wg)(),(0,i.j4)(Pt,{key:0,class:"pd-x-20",xl:10,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((()=>["API"==M.type?((0,i.wg)(),(0,i.j4)(_t,{key:0,class:"card mb-15 nopd overflowHidden",loading:M.loading,title:t.$t("Metrics")},{default:(0,i.w5)((()=>[(0,i.Wm)(St,{colors:["#8be4c1"],height:200,id:M.pid,padding:[0,0,0,0],axis:!1,ver:M.screenWidth,showy:!1,dv:M.detail.chart},null,8,["id","ver","dv"])])),_:1},8,["loading","title"])):(0,i.kq)("",!0),M.visiblelog?((0,i.wg)(),(0,i.j4)(jt,{key:1,"get-container":!1,title:t.$t("log"),placement:"bottom",height:"600",closable:!1,visible:M.visiblelog,onClose:J.hide},{default:(0,i.w5)((()=>[(0,i.Wm)(Wt,{"is-readonly":!0,value:M.log},null,8,["value"])])),_:1},8,["title","visible","onClose"])):(0,i.kq)("",!0)])),_:1})):(0,i.kq)("",!0)])),_:1})])),_:1},8,["tab"])):(0,i.kq)("",!0),(0,i.Wm)(Ut,{key:"2",tab:t.$t("Policy")},{default:(0,i.w5)((()=>[(0,i.Wm)(zt,{class:"pt-20 row-mg"},{default:(0,i.w5)((()=>[(0,i.Wm)(Pt,{class:"col-pd",xl:"API"==M.type?18:24,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((()=>["API"==M.type?((0,i.wg)(),(0,i.j4)(At,{key:0,dashed:""},{default:(0,i.w5)((()=>[M.bindPolicy?((0,i.wg)(),(0,i.j4)(nt,{key:0,closable:"",onClose:J.resetPolicy},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Binding policy"))+"："+(0,l.zw)(M.bindPolicy.name),1)])),_:1},8,["onClose"])):(0,i.kq)("",!0),M.bindPolicy?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(nt,{key:1},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Custom")),1)])),_:1}))])),_:1})):(0,i.kq)("",!0),(0,i._)("div",null,[(0,i.Wm)(Dt,{disabled:!("API"!=M.type||!M.bindPolicy),plugins:M.detail.content.plugins,"onUpdate:plugins":e[24]||(e[24]=t=>M.detail.content.plugins=t),onAdd:J.showPluginBox,"add-text":t.$t("Add Plugin")},null,8,["disabled","plugins","onAdd","add-text"])])])),_:1},8,["xl"]),"API"==M.type?((0,i.wg)(),(0,i.j4)(Pt,{key:0,class:"col-pd",xl:6,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((()=>[(0,i.Wm)(At,{dashed:""},{default:(0,i.w5)((()=>[(0,i.Wm)(nt,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Select an existing policy")),1)])),_:1})])),_:1}),(0,i.Wm)(Et,{"hide-head":!0,onSelectPolicy:J.selectPolicy},null,8,["onSelectPolicy"])])),_:1})):(0,i.kq)("",!0)])),_:1})])),_:1},8,["tab"]),(0,i.wy)((0,i.Wm)(Ut,{key:"3",tab:t.$t("Specs")},{default:(0,i.w5)((()=>[(0,i.Wm)(_t,{class:"card nopd"},{default:(0,i.w5)((()=>[(0,i.Wm)(zt,{class:"row-mg"},{default:(0,i.w5)((()=>[(0,i.Wm)(Pt,{class:"col-pd",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((()=>[W])),_:1}),(0,i.Wm)(Pt,{class:"col-pd",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((()=>[(0,i.Wm)(xt,{"is-create":M.editorIsCreate,jsonVal:M.detail.spec,"onUpdate:jsonVal":e[25]||(e[25]=t=>M.detail.spec=t),onChange:J.swaggerchange,height:"800px",class:"mb-24"},null,8,["is-create","jsonVal","onChange"])])),_:1})])),_:1})])),_:1})])),_:1},8,["tab"]),[[s.F8,"API"==M.type]]),""!=M.pid&&"API"==M.type?((0,i.wg)(),(0,i.j4)(Ut,{key:"4",tab:t.$t("log")},{default:(0,i.w5)((()=>[(0,i.Wm)(Ot,{uid:M.pid,type:"api","log-level":M.detail.content.log.level,onSave:J.saveLogLevel},null,8,["uid","log-level","onSave"])])),_:1},8,["tab"])):(0,i.kq)("",!0),"API"==M.type?((0,i.wg)(),(0,i.j4)(Ut,{key:"6",tab:t.$t("ACL")},{default:(0,i.w5)((()=>[(0,i.Wm)(zt,{class:"row-mg"},{default:(0,i.w5)((()=>[(0,i.Wm)(Pt,{class:"row-padding",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((()=>[(0,i.Wm)(_t,{title:t.$t("Service Black")},{default:(0,i.w5)((()=>[(0,i.Wm)(Tt,{titles:[t.$t("Service")," "+t.$t("Added")],"data-source":M.black.list,"target-keys":M.detail.blacklistServices,"onUpdate:target-keys":e[26]||(e[26]=t=>M.detail.blacklistServices=t),"show-search":!0,"filter-option":(t,e)=>-1!==e.name.indexOf(t),"show-select-all":!1,onSearch:J.blackSearch,onChange:J.onBlackChange},{children:(0,i.w5)((({direction:e,filteredItems:a,selectedKeys:s,disabled:n,onItemSelectAll:o,onItemSelect:r})=>[(0,i.Wm)(qt,{"row-selection":J.getRowSelection(n,s,o,r),columns:"left"===e?J.dataleftColumns:J.datarightColumns,"data-source":a,size:"small",pagination:"left"===e&&{onChange:J.blackPagging,current:M.black.pageNo,pageSize:M.black.pageSize,showTotal:(e,a)=>`${t.$t("Total")} ${e}`,total:M.black.total},style:(0,l.j5)({pointerEvents:n?"none":null}),"custom-row":({key:t,disabled:e})=>({onClick:()=>{e||n||r(t,!s.includes(t))}})},null,8,["row-selection","columns","data-source","pagination","style","custom-row"])])),_:1},8,["titles","data-source","target-keys","filter-option","onSearch","onChange"])])),_:1},8,["title"])])),_:1}),(0,i.Wm)(Pt,{class:"col-pd",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((()=>[(0,i.Wm)(_t,{title:t.$t("Service White")},{default:(0,i.w5)((()=>[(0,i.Wm)(Tt,{titles:[t.$t("Service")," "+t.$t("Added")],"data-source":M.white.list,"target-keys":M.detail.whitelistServices,"onUpdate:target-keys":e[27]||(e[27]=t=>M.detail.whitelistServices=t),"show-search":!0,"filter-option":(t,e)=>-1!==e.name.indexOf(t),"show-select-all":!1,onSearch:J.whiteSearch,onChange:J.onWhiteChange},{children:(0,i.w5)((({direction:e,filteredItems:a,selectedKeys:s,disabled:n,onItemSelectAll:o,onItemSelect:r})=>[(0,i.Wm)(qt,{"row-selection":J.getRowSelection(n,s,o,r),columns:"left"===e?J.dataleftColumns:J.datarightColumns,"data-source":a,size:"small",pagination:"left"===e&&{onChange:J.whitePagging,current:M.white.pageNo,pageSize:M.white.pageSize,showTotal:(e,a)=>`${t.$t("Total")} ${e}`,total:M.white.total},style:(0,l.j5)({pointerEvents:n?"none":null}),"custom-row":({key:t,disabled:e})=>({onClick:()=>{e||n||r(t,!s.includes(t))}})},null,8,["row-selection","columns","data-source","pagination","style","custom-row"])])),_:1},8,["titles","data-source","target-keys","filter-option","onSearch","onChange"])])),_:1},8,["title"])])),_:1})])),_:1})])),_:1},8,["tab"])):(0,i.kq)("",!0),""!=M.pid&&"API"==M.type?((0,i.wg)(),(0,i.j4)(Ut,{key:"7"},{tab:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Applications"))+" ",1),J.appliesCnt>0?((0,i.wg)(),(0,i.iD)("span",j,[(0,i.Wm)(It,{count:J.appliesCnt},null,8,["count"])])):(0,i.kq)("",!0)])),default:(0,i.w5)((()=>[(0,i.Wm)(zt,{class:"row-mg",gutter:16},{default:(0,i.w5)((()=>[(0,i.Wm)(Pt,{class:"row-padding",xl:M.detail.approvalLevel>0?16:24,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((()=>[(0,i.Wm)(_t,{class:"card",title:t.$t("Applications")},{default:(0,i.w5)((()=>[(0,i.Wm)($t,{"item-layout":"horizontal","data-source":M.application.list,pagination:{onChange:J.searchApplications,current:M.application.pageNo,pageSize:M.application.pageSize,showTotal:(e,a)=>`${t.$t("Total")} ${e}`,total:M.application.total}},{renderItem:(0,i.w5)((({item:t})=>[(0,i.Wm)(kt,null,{actions:(0,i.w5)((()=>[(0,i.Wm)(Nt,{class:"icon-menu rotate-icon",onClick:e=>J.removeSubApi(t)},null,8,["onClick"])])),default:(0,i.w5)((()=>[(0,i.Wm)(vt,null,{title:(0,i.w5)((()=>[(0,i._)("a",{onClick:e=>J.appDetail(t.id)},(0,l.zw)(t.name),9,z)])),avatar:(0,i.w5)((()=>[(0,i.Wm)(Lt,{class:"CodeSandboxOutlined primary"})])),description:(0,i.w5)((()=>[t.project?((0,i.wg)(),(0,i.iD)("span",U,(0,l.zw)(t.project.organization?t.project.organization.name+" / ":"")+" "+(0,l.zw)(t.project.name),1)):((0,i.wg)(),(0,i.iD)("span",A,"-"))])),_:2},1024)])),_:2},1024)])),_:1},8,["data-source","pagination"])])),_:1},8,["title"])])),_:1},8,["xl"]),M.detail.approvalLevel>0?((0,i.wg)(),(0,i.j4)(Pt,{key:0,class:"row-padding",xl:8,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((()=>[(0,i.Wm)(_t,null,{title:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Applies"))+" ",1),J.appliesCnt>0?((0,i.wg)(),(0,i.iD)("span",D,[(0,i.Wm)(It,{count:J.appliesCnt},null,8,["count"])])):(0,i.kq)("",!0)])),default:(0,i.w5)((()=>[(0,i.Wm)($t,{"item-layout":"vertical","data-source":M.applies.list,pagination:{onChange:J.searchApplies,current:M.applies.pageNo,pageSize:M.applies.pageSize,showTotal:(e,a)=>`${t.$t("Total")} ${e}`,total:M.applies.total}},{renderItem:(0,i.w5)((({item:e})=>[(0,i.Wm)(kt,null,{extra:(0,i.w5)((()=>[0==e.status?((0,i.wg)(),(0,i.iD)("div",E,[(0,i._)("a",{href:"javascript:void(0)",onClick:t=>J.refuseApply(e)},[(0,i.Wm)(Rt,{class:"icon-menu"})],8,x),(0,i._)("a",{href:"javascript:void(0)",onClick:t=>J.approvalApply(e),class:"ml-15"},[(0,i.Wm)(Ht,{class:"icon-menu"})],8,O)])):(0,i.kq)("",!0)])),default:(0,i.w5)((()=>[(0,i.Wm)(vt,null,{description:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(new Date(e.updatedAt).toLocaleString())+" ("+(0,l.zw)(e.applyUser.username)+") "+(0,l.zw)(t.$t("applies for subscription")),1)])),title:(0,i.w5)((()=>[(0,i._)("b",null,(0,l.zw)(e.application?e.application.name:""),1)])),avatar:(0,i.w5)((()=>[(0,i.Wm)(Vt,{class:"primary"})])),_:2},1024),(0,i._)("div",null,[(0,i._)("div",{class:"relative vm",style:(0,l.j5)([{left:"15px"},"width:"+120*M.detail.approvalLevel+"px"])},[(0,i.Wm)(et,{current:e.approvalStep,size:"small",status:["process","finish","error"][e.status]},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(J.findApprovalLevel.approvalRoles,((t,a)=>((0,i.wg)(),(0,i.j4)(Q,{class:"pb-10",key:a,title:t.label},(0,i.Nv)({_:2},[a<=e.approvalStep&&e.content&&e.content.history&&e.content.history[a]?{name:"description",fn:(0,i.w5)((()=>[e.content.history[a].user?((0,i.wg)(),(0,i.iD)("div",q,[(0,i._)("b",null,(0,l.zw)(e.content.history[a].user.username),1)])):(0,i.kq)("",!0),e.content.history[a].time?((0,i.wg)(),(0,i.iD)("div",T,(0,l.zw)(e.content.history[a].time),1)):(0,i.kq)("",!0)])),key:"0"}:void 0]),1032,["title"])))),128))])),_:2},1032,["current","status"])],4)])])),_:2},1024)])),_:1},8,["data-source","pagination"])])),_:1})])),_:1})):(0,i.kq)("",!0)])),_:1})])),_:1})):(0,i.kq)("",!0),""!=M.pid&&"API"==M.type?((0,i.wg)(),(0,i.j4)(Ut,{key:"5",tab:t.$t("Dashboard")},{default:(0,i.w5)((()=>[(0,i.Wm)(Zt,{"page-id":M.pid,apply:"openapi","default-widget":M.DEFAULT_API_DETAIL,"hide-add":"5"!=M.activeKey},null,8,["page-id","default-widget","hide-add"])])),_:1},8,["tab"])):(0,i.kq)("",!0)])),_:1},8,["activeKey"])])),_:1})])),_:1})])),_:2},[void 0,a.embed?void 0:{name:"action",fn:(0,i.w5)((()=>[""!=M.pid?(0,i.wy)(((0,i.wg)(),(0,i.j4)(ut,{key:0,type:"default",onClick:J.validate},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("save")),1)])),_:1},8,["onClick"])),[[ee,[M.detail.project?"api:update:project:"+M.detail.project:"api:update"]]]):(0,i.wy)(((0,i.wg)(),(0,i.j4)(ut,{key:1,type:"primary",onClick:J.validate},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("create")),1)])),_:1},8,["onClick"])),[[ee,[M.detail.project?"api:create:project:"+M.detail.project:"api:create"]]]),(0,i.Wm)(ht,{title:t.$t("Review"),trigger:"click",visible:M.visibleReview,"onUpdate:visible":e[11]||(e[11]=t=>M.visibleReview=t)},{content:(0,i.w5)((()=>[(0,i.Wm)(ct,{value:M.description2,"onUpdate:value":e[9]||(e[9]=t=>M.description2=t),placeholder:t.$t("Description"),"auto-size":{minRows:2,maxRows:5}},null,8,["value","placeholder"]),(0,i.Wm)(ut,{type:"primary",onClick:e[10]||(e[10]=t=>J.toReview(M.description2,0)),class:"mt-8"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Submit")),1)])),_:1})])),default:(0,i.w5)((()=>[""==M.pid||0!=M.detail.step&&2!=M.detail.step?(0,i.kq)("",!0):(0,i.wy)(((0,i.wg)(),(0,i.j4)(ut,{key:0,type:"primary",class:"ml-8"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Review")),1)])),_:1})),[[ee,["api:update"]]])])),_:1},8,["title","visible"]),(0,i.Wm)(ht,{title:t.$t("Revise"),trigger:"click",visible:M.visibleRevise,"onUpdate:visible":e[14]||(e[14]=t=>M.visibleRevise=t)},{content:(0,i.w5)((()=>[(0,i.Wm)(ct,{value:M.description1,"onUpdate:value":e[12]||(e[12]=t=>M.description1=t),placeholder:t.$t("Description"),"auto-size":{minRows:2,maxRows:5}},null,8,["value","placeholder"]),(0,i.Wm)(ut,{type:"primary",onClick:e[13]||(e[13]=t=>J.toRevise(M.description1,1)),class:"mt-8"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Submit")),1)])),_:1})])),default:(0,i.w5)((()=>[""!=M.pid&&1==M.detail.step?(0,i.wy)(((0,i.wg)(),(0,i.j4)(ut,{key:0,type:"danger",class:"ml-8"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Revise")),1)])),_:1})),[[ee,["api:update"]]]):(0,i.kq)("",!0)])),_:1},8,["title","visible"]),(0,i.Wm)(ht,{title:t.$t("Deploy"),trigger:"click",visible:M.visibleDeploy,"onUpdate:visible":e[17]||(e[17]=t=>M.visibleDeploy=t)},{content:(0,i.w5)((()=>[(0,i.Wm)(ct,{value:M.description3,"onUpdate:value":e[15]||(e[15]=t=>M.description3=t),placeholder:t.$t("Description"),"auto-size":{minRows:2,maxRows:5}},null,8,["value","placeholder"]),(0,i.Wm)(ut,{type:"primary",onClick:e[16]||(e[16]=t=>J.toDeploy(M.description3,2)),class:"mt-8"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Submit")),1)])),_:1})])),default:(0,i.w5)((()=>[""!=M.pid&&1==M.detail.step?(0,i.wy)(((0,i.wg)(),(0,i.j4)(ut,{key:0,type:"primary",class:"ml-8"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Deploy")),1)])),_:1})),[[ee,["api:update"]]]):(0,i.kq)("",!0)])),_:1},8,["title","visible"]),(0,i.Wm)(ht,{title:t.$t("Stop"),trigger:"click",visible:M.visibleStop,"onUpdate:visible":e[20]||(e[20]=t=>M.visibleStop=t)},{content:(0,i.w5)((()=>[(0,i.Wm)(ct,{value:M.description4,"onUpdate:value":e[18]||(e[18]=t=>M.description4=t),placeholder:t.$t("Description"),"auto-size":{minRows:2,maxRows:5}},null,8,["value","placeholder"]),(0,i.Wm)(ut,{type:"primary",onClick:e[19]||(e[19]=t=>J.toStop(M.description4,3)),class:"mt-8"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Submit")),1)])),_:1})])),default:(0,i.w5)((()=>[""!=M.pid&&2==M.detail.step?(0,i.wy)(((0,i.wg)(),(0,i.j4)(ut,{key:0,type:"danger",class:"ml-8"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Stop")),1)])),_:1})),[[ee,["api:update"]]]):(0,i.kq)("",!0)])),_:1},8,["title","visible"]),(0,i.Wm)(ht,{title:t.$t("Restart"),trigger:"click",visible:M.visibleRestart,"onUpdate:visible":e[23]||(e[23]=t=>M.visibleRestart=t)},{content:(0,i.w5)((()=>[(0,i.Wm)(ct,{value:M.description3,"onUpdate:value":e[21]||(e[21]=t=>M.description3=t),placeholder:t.$t("Description"),"auto-size":{minRows:2,maxRows:5}},null,8,["value","placeholder"]),(0,i.Wm)(ut,{type:"primary",onClick:e[22]||(e[22]=t=>J.toRestart(M.description3,2)),class:"mt-8"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Submit")),1)])),_:1})])),default:(0,i.w5)((()=>[""!=M.pid&&3==M.detail.step?(0,i.wy)(((0,i.wg)(),(0,i.j4)(ut,{key:0,type:"primary",class:"ml-8"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t("Restart")),1)])),_:1})),[[ee,["api:update"]]]):(0,i.kq)("",!0)])),_:1},8,["title","visible"])])),key:"1"}]),1032,["hide-breadcrumb","title","form-state"]),(0,i.Wm)(Qt,{"destroy-on-close":!0,visible:M.visibleEndpoint,"onUpdate:visible":e[35]||(e[35]=t=>M.visibleEndpoint=t),title:t.$t("Endpoint"),onOk:J.validForm,width:"70%","cancel-text":t.$t("cancel"),"ok-text":t.isEdit?t.$t("Save"):t.$t("create")},{default:(0,i.w5)((()=>[(0,i.Wm)(Gt,{model:M.payloadEndpoint,"wrapper-col":{span:24},ref:"form"},{default:(0,i.w5)((()=>[(0,i.Wm)(Jt,{bordered:""},{default:(0,i.w5)((()=>[(0,i.Wm)(Ft,{label:t.$t("Protocol")},{default:(0,i.w5)((()=>[(0,i.Wm)(st,{mode:"multiple",placeholder:t.$t("unset"),class:"width-200",value:M.payloadEndpoint.protocols,"onUpdate:value":e[29]||(e[29]=t=>M.payloadEndpoint.protocols=t)},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.protocols,((t,e)=>((0,i.wg)(),(0,i.j4)(lt,{key:e,value:t},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t),1)])),_:2},1032,["value"])))),128))])),_:1},8,["placeholder","value"])])),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("method"),span:2},{default:(0,i.w5)((()=>[(0,i.Wm)(st,{mode:"multiple",placeholder:t.$t("unset"),class:"width-300",value:M.payloadEndpoint.methods,"onUpdate:value":e[30]||(e[30]=t=>M.payloadEndpoint.methods=t),onChange:t.changeMethods},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.methods,((t,e)=>((0,i.wg)(),(0,i.j4)(lt,{key:e,value:t},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t),1)])),_:2},1032,["value"])))),128))])),_:1},8,["placeholder","value","onChange"])])),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("Host"),span:1},{default:(0,i.w5)((()=>[(0,i.Wm)(ct,{value:M.payloadEndpoint.host,"onUpdate:value":e[31]||(e[31]=t=>M.payloadEndpoint.host=t),placeholder:t.$t("unset"),"allow-clear":"",rows:4},null,8,["value","placeholder"])])),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("paths"),span:2},{default:(0,i.w5)((()=>[(0,i.Wm)(ct,{value:M.payloadEndpoint.path,"onUpdate:value":e[32]||(e[32]=t=>M.payloadEndpoint.path=t),placeholder:t.$t("unset"),"allow-clear":"",rows:4},null,8,["value","placeholder"])])),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("Custom path"),span:3},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.payloadEndpoint.customPaths,((e,a)=>((0,i.wg)(),(0,i.iD)("div",{key:a,class:"flex mb-10 pd-10"},[(0,i._)("text",I,(0,l.zw)(t.$t("path")),1),(0,i.Wm)(Bt,{name:["customPaths",a,"path"],rules:t.rules.arrayRequired},{default:(0,i.w5)((()=>[(0,i.Wm)(st,{placeholder:t.$t("path"),class:"ml-10 width-200",value:e.path,"onUpdate:value":t=>e.path=t,mode:"multiple"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.payloadEndpoint.path.split("\n"),((t,e)=>((0,i.wg)(),(0,i.j4)(lt,{key:e,value:t},{default:(0,i.w5)((()=>[t?((0,i.wg)(),(0,i.iD)("span",L,(0,l.zw)(t),1)):(0,i.kq)("",!0),t?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("i",N,(0,l.zw)(t),1))])),_:2},1032,["value"])))),128))])),_:2},1032,["placeholder","value","onUpdate:value"])])),_:2},1032,["name","rules"]),(0,i._)("text",V,(0,l.zw)(t.$t("Provider")),1),(0,i.Wm)(Bt,{name:["customPaths",a,"providers"],rules:t.rules.arrayRequired},{default:(0,i.w5)((()=>[(0,i.Wm)(st,{placeholder:t.$t("Provider"),class:"ml-10 width-200",value:e.providers,"onUpdate:value":t=>e.providers=t,mode:"multiple"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.detail.content.providers,((t,e)=>((0,i.wg)(),(0,i.j4)(lt,{key:e,value:t.name},{default:(0,i.w5)((()=>[t.name?((0,i.wg)(),(0,i.iD)("span",R,(0,l.zw)(t.name),1)):(0,i.kq)("",!0),t.name?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("i",H,(0,l.zw)(t.name),1))])),_:2},1032,["value"])))),128))])),_:2},1032,["placeholder","value","onUpdate:value"])])),_:2},1032,["name","rules"]),(0,i._)("text",Z,(0,l.zw)(t.$t("Rewrite path")),1),(0,i.Wm)(it,{value:e.oldPath,"onUpdate:value":t=>e.oldPath=t,placeholder:t.$t("Old path"),class:"width-150"},null,8,["value","onUpdate:value","placeholder"]),K,(0,i.Wm)(it,{value:e.newPath,"onUpdate:value":t=>e.newPath=t,placeholder:t.$t("New path"),class:"width-150"},null,8,["value","onUpdate:value","placeholder"]),(0,i._)("div",Y,[(0,i.Wm)(Mt,{class:"font-20 ml-10 two-tone",onClick:t=>J.removeCustompath(e),"two-tone-color":"#00adef"},null,8,["onClick"])])])))),128)),(0,i.Wm)(mt,{class:"font-20 ml-10 two-tone",onClick:J.addCustompath,"two-tone-color":"#00adef"},null,8,["onClick"])])),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("Strip Path")},{default:(0,i.w5)((()=>[(0,i.Wm)(G,{title:t.$t("Strip Path Tip")},{default:(0,i.w5)((()=>[(0,i.Wm)(Ct,{checked:M.payloadEndpoint.stripPath,"onUpdate:checked":e[33]||(e[33]=t=>M.payloadEndpoint.stripPath=t)},null,8,["checked"])])),_:1},8,["title"])])),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("Preserve Host")},{default:(0,i.w5)((()=>[(0,i.Wm)(G,{title:t.$t("Preserve Host Tip")},{default:(0,i.w5)((()=>[(0,i.Wm)(Ct,{checked:M.payloadEndpoint.preserveHost,"onUpdate:checked":e[34]||(e[34]=t=>M.payloadEndpoint.preserveHost=t)},null,8,["checked"])])),_:1},8,["title"])])),_:1},8,["label"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title","onOk","cancel-text","ok-text"]),(0,i.Wm)(Qt,{"destroy-on-close":!0,visible:M.visibleProvider,"onUpdate:visible":e[44]||(e[44]=t=>M.visibleProvider=t),title:t.$t("Provider"),onOk:J.validProvider,width:"70%","cancel-text":t.$t("cancel"),"ok-text":t.isEdit?t.$t("Save"):t.$t("create")},{default:(0,i.w5)((()=>[(0,i.Wm)(Gt,{model:M.payloadProvider,"wrapper-col":{span:24},ref:"providerForm"},{default:(0,i.w5)((()=>[(0,i.Wm)(Jt,{bordered:""},{default:(0,i.w5)((()=>[(0,i.Wm)(Ft,{label:t.$t("as"),span:3},{default:(0,i.w5)((()=>[(0,i.Wm)(Bt,{name:"name",rules:t.rules.name},{default:(0,i.w5)((()=>[(0,i.Wm)(it,{placeholder:t.$t("unset"),value:M.payloadProvider.name,"onUpdate:value":e[36]||(e[36]=t=>M.payloadProvider.name=t),class:"width-300"},null,8,["placeholder","value"])])),_:1},8,["rules"])])),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("Type"),span:1},{default:(0,i.w5)((()=>[(0,i.Wm)(st,{placeholder:t.$t("unset"),class:"width-300",value:M.payloadProvider.type,"onUpdate:value":e[37]||(e[37]=t=>M.payloadProvider.type=t)},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.types,((t,e)=>((0,i.wg)(),(0,i.j4)(lt,{key:e,value:t},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t),1)])),_:2},1032,["value"])))),128))])),_:1},8,["placeholder","value"])])),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("Protocol"),span:2},{default:(0,i.w5)((()=>[(0,i.Wm)(st,{mode:"multiple",placeholder:t.$t("unset"),class:"width-200",value:M.payloadProvider.protocols,"onUpdate:value":e[38]||(e[38]=t=>M.payloadProvider.protocols=t)},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.protocols,((t,e)=>((0,i.wg)(),(0,i.j4)(lt,{key:e,value:t},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t),1)])),_:2},1032,["value"])))),128))])),_:1},8,["placeholder","value"])])),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t(M.payloadProvider.type),span:1},{default:(0,i.w5)((()=>["Host"==M.payloadProvider.type?((0,i.wg)(),(0,i.iD)("div",F,[(0,i.Wm)(Bt,{name:"hosts",rules:t.rules.arrayRequired},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.payloadProvider.hosts||[],((t,e)=>((0,i.wg)(),(0,i.j4)(nt,{key:e,onClose:(0,s.iM)((t=>J.handleArrayClose(M.payloadProvider.hosts,e)),["prevent"]),closable:""},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t),1)])),_:2},1032,["onClose"])))),128)),(0,i.wy)((0,i.Wm)(it,{ref:"hostRef",type:"text",size:"small",class:"width-300",placeholder:t.$t("unset"),value:M.hostValue,"onUpdate:value":e[39]||(e[39]=t=>M.hostValue=t),onBlur:J.hostInputConfirm,onKeyup:(0,s.D2)(J.hostInputConfirm,["enter"])},null,8,["placeholder","value","onBlur","onKeyup"]),[[s.F8,M.hostVisible]]),M.hostVisible?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(nt,{key:0,onClick:J.hostShowInput,class:"dashed-tag"},{default:(0,i.w5)((()=>[(0,i.Wm)(ot),(0,i.Uk)(" "+(0,l.zw)(t.$t("add")),1)])),_:1},8,["onClick"]))])),_:1},8,["rules"])])):(0,i.kq)("",!0),"Upstream"==M.payloadProvider.type?((0,i.wg)(),(0,i.j4)(Bt,{key:1,name:"upstreamId",rules:t.rules.required},{default:(0,i.w5)((()=>["Upstream"==M.payloadProvider.type?((0,i.wg)(),(0,i.iD)("div",B,[M.payloadProvider.upstream&&M.payloadProvider.upstream.name?((0,i.wg)(),(0,i.j4)(nt,{key:0,closable:"",onClose:J.clearSelector},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(M.payloadProvider.upstream.content.displayName||M.payloadProvider.upstream.name),1)])),_:1},8,["onClose"])):(0,i.kq)("",!0),(0,i.Wm)(Xt,{width:500,search:!0,placement:"right",icon:M.RiseOutlined,col:2,onSelect:J.saveSelector,"get-tag":t=>t.content&&t.name!=t.content.displayName?t.content.displayName:null,options:M.upstreams},{default:(0,i.w5)((()=>[(0,i._)("a",null,[(0,i.Wm)(nt,{color:"#00adef",key:"submit",type:"primary"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(M.payloadProvider.upstream?t.$t("select"):t.$t("unset")),1)])),_:1})])])),_:1},8,["icon","onSelect","get-tag","options"])])):(0,i.kq)("",!0)])),_:1},8,["rules"])):(0,i.kq)("",!0),"Function"==M.payloadProvider.type?((0,i.wg)(),(0,i.j4)(Bt,{key:2,name:"content",rules:t.rules.required},{default:(0,i.w5)((()=>["Function"==M.payloadProvider.type?((0,i.wg)(),(0,i.j4)(st,{key:0,placeholder:t.$t("unset"),class:"width-300",value:M.payloadProvider.content,"onUpdate:value":e[40]||(e[40]=t=>M.payloadProvider.content=t)},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.functions,((t,e)=>((0,i.wg)(),(0,i.j4)(lt,{key:e,value:t},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t),1)])),_:2},1032,["value"])))),128))])),_:1},8,["placeholder","value"])):(0,i.kq)("",!0)])),_:1},8,["rules"])):(0,i.kq)("",!0),"Zone"==M.payloadProvider.type?((0,i.wg)(),(0,i.j4)(Bt,{key:3,name:"content",rules:t.rules.required},{default:(0,i.w5)((()=>["Zone"==M.payloadProvider.type?((0,i.wg)(),(0,i.j4)(st,{key:0,placeholder:t.$t("unset"),class:"width-300",value:M.payloadProvider.content,"onUpdate:value":e[41]||(e[41]=t=>M.payloadProvider.content=t)},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.zones,((t,e)=>((0,i.wg)(),(0,i.j4)(lt,{key:e,value:t},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t),1)])),_:2},1032,["value"])))),128))])),_:1},8,["placeholder","value"])):(0,i.kq)("",!0)])),_:1},8,["rules"])):(0,i.kq)("",!0)])),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("path"),span:2},{default:(0,i.w5)((()=>[(0,i.Wm)(it,{placeholder:t.$t("unset"),value:M.payloadProvider.path,"onUpdate:value":e[42]||(e[42]=t=>M.payloadProvider.path=t),class:"width-300"},null,8,["placeholder","value"])])),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("Versions"),span:3},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(M.payloadProvider.versions||[],((t,e)=>((0,i.wg)(),(0,i.j4)(nt,{key:e,onClose:(0,s.iM)((t=>J.handleArrayClose(M.payloadProvider.versions,e)),["prevent"]),closable:""},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t),1)])),_:2},1032,["onClose"])))),128)),(0,i.wy)((0,i.Wm)(it,{ref:"versionRef",type:"text",size:"small",class:"width-300",placeholder:"SNAPSHOT:"+M.payloadProvider.name+"-SNAPSHOT (eg)",value:M.versionValue,"onUpdate:value":e[43]||(e[43]=t=>M.versionValue=t),onBlur:J.versionInputConfirm,onKeyup:(0,s.D2)(J.versionInputConfirm,["enter"])},null,8,["placeholder","value","onBlur","onKeyup"]),[[s.F8,M.versionVisible]]),M.versionVisible?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(nt,{key:0,onClick:J.versionShowInput,class:"dashed-tag"},{default:(0,i.w5)((()=>[(0,i.Wm)(ot),(0,i.Uk)(" "+(0,l.zw)(t.$t("add")),1)])),_:1},8,["onClick"]))])),_:1},8,["label"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title","onOk","cancel-text","ok-text"]),(0,i.Wm)(Qt,{footer:null,width:800,visible:M.visibleAP,"onUpdate:visible":e[45]||(e[45]=t=>M.visibleAP=t),title:t.$t("Add Plugin"),onOk:t.handleOk},{default:(0,i.w5)((()=>[(0,i.Wm)(te,{onSelectPlugin:J.selectPlugin,"hide-head":!0},null,8,["onSelectPlugin"])])),_:1},8,["visible","title","onOk"]),(0,i.kq)("",!0)],64)}],["__scopeId","data-v-769f7a1a"]])},77809:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return j}});var i=a(66252),l=a(3577),s=a(49963);const n={class:"search-input"},o={class:"content flex"},r={class:"flex-item"},d={class:"form-row"},p={class:"label"},u={class:"content"},c={class:"width-200"},h={class:"search-content"},m={class:"project-selection"},v={class:"font-22"},g={class:"font-16"},w={class:"font-20 primary"},y={class:"mb-3"},f={key:0,class:"blockquote"};a(57658);var b=a(71900),k=a(92246),$=a(99684),_=a(33907),C=a(69596),P=a(61103),S=a(85263),W={name:"ApiList",i18n:a(89234),components:{BulbOutlined:k.Z,PageLayout:P.Z,CardList:C.Z,PlusCircleTwoTone:$.Z,HeadInfo:b.Z},props:["hideHead"],data(){return{pageSize:12,pageNo:1,total:0,key:"",filterApp:"",simpleImage:S.Z.PRESENTED_IMAGE_SIMPLE,visible:!1,visible2:!1,showApp:!1,projects:[],json:"{}",policyType:["Sign Encrypt","Encrypt Attestation","Decrypt","Encrypt","Forward Proxy"],policies:[],viewtypevalue:0,viewtypeproject:null,viewtype:[{value:0,label:"All"},{value:1,label:"Goup By Project"}],loading:!0}},computed:{...(0,_.rn)("setting",["layout","pageWidth"]),start(){return(this.pageNo-1)*this.pageSize}},mounted(){this.search()},methods:{addpolicy(){this.$router.push({path:"/openapi/policy/create"})},detail(t,e,a){this.$router.push({path:"/openapi/policy/detail/"+a.id})},remove(t,e,a){this.$gql.mutation(`deletePolicy(id:${a.id}){data{id}}`).then((()=>{this.$message.success(this.$t("Deleted successfully"),3),this.search()}))},search(t){this.pageNo=t||1,this.loading=!0;let e={name:{contains:this.key}};this.$gql.query(`policies(filters: $filters, pagination: {start: ${this.start}, limit: ${this.pageSize}}){\n\t\t\t\t\t\tdata{id,attributes{name,project{data{id,attributes{name}}},content,updatedAt}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}`,{filters:e},{filters:"PolicyFiltersInput"}).then((t=>{this.policies=t.data,this.total=t.pagination.total,this.loading=!1}))},searchProject(t){this.pageNo=t||1,this.loading=!0,this.$gql.query(`projects(filters: $filters, pagination: {start: ${this.start}, limit: ${this.pageSize}}){data{id,attributes{\n\t\t\t\t\t\tname,\n\t\t\t\t\t\tapis{data{id,attributes{name}}},\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t}}}`).then((t=>{this.projects=t.data,this.loading=!1}))},select(t,e,a){this.$emit("selectPolicy",a)},getData(){}}};var j=(0,a(83744).Z)(W,[["render",function(t,e,a,b,k,$){const _=(0,i.up)("a-input-search"),C=(0,i.up)("a-radio-button"),P=(0,i.up)("a-radio-group"),S=(0,i.up)("a-tag"),W=(0,i.up)("a-form-item"),j=(0,i.up)("a-form"),z=(0,i.up)("PlusCircleTwoTone"),U=(0,i.up)("HeadInfo"),A=(0,i.up)("a-card"),D=(0,i.up)("a-col"),E=(0,i.up)("a-row"),x=(0,i.up)("BulbOutlined"),O=(0,i.up)("a-card-meta"),q=(0,i.up)("a-badge"),T=(0,i.up)("CardList"),I=(0,i.up)("a-pagination"),L=(0,i.up)("PageLayout"),N=(0,i.Q2)("permission");return(0,i.wg)(),(0,i.j4)(L,{title:t.$t("Policy"),"hide-head":a.hideHead,style:(0,l.j5)(a.hideHead?"padding-top:0 ;":"")},{headerContent:(0,i.w5)((()=>[(0,i._)("div",{class:(0,l.C_)(["search-head",t.layout,t.pageWidth])},[(0,i._)("div",n,[(0,i.Wm)(_,{value:k.key,"onUpdate:value":e[0]||(e[0]=t=>k.key=t),class:"search-ipt",onSearch:e[1]||(e[1]=t=>$.search()),placeholder:t.$t("Please input")+"...",size:"large"},null,8,["value","placeholder"])]),(0,i.Wm)(A,{bordered:!1,class:"search-form"},{default:(0,i.w5)((()=>[(0,i._)("div",o,[(0,i._)("div",r,[(0,i.Wm)(j,null,{default:(0,i.w5)((()=>[(0,i._)("div",d,[(0,i._)("div",p,[(0,i._)("span",null,(0,l.zw)(t.$t("Card View")),1)]),(0,i._)("div",u,[(0,i.Wm)(W,null,{default:(0,i.w5)((()=>[(0,i.Wm)(P,{size:"small",onChange:t.changeView,value:k.viewtypevalue,"onUpdate:value":e[2]||(e[2]=t=>k.viewtypevalue=t),"button-style":"solid"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(k.viewtype,((e,a)=>((0,i.wg)(),(0,i.j4)(C,{value:e.value,key:a},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.$t(e.label)),1)])),_:2},1032,["value"])))),128))])),_:1},8,["onChange","value"]),k.viewtypeproject?((0,i.wg)(),(0,i.j4)(S,{key:0,class:"ml-10",closable:"",onClose:t.removeViewtypeproject},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(k.viewtypeproject.name),1)])),_:1},8,["onClose"])):(0,i.kq)("",!0)])),_:1})])])])),_:1})]),(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",c,[(0,i.Wm)(U,{class:"pd-0 split-right",title:t.$t("Create policy")},{body:(0,i.w5)((()=>[(0,i._)("div",null,[(0,i.Wm)(z,{onClick:$.addpolicy,class:"font-primary icon-menu rotate-icon"},null,8,["onClick"])])])),_:1},8,["title"])])),[[N,["policy:create"]]])])])),_:1})],2)])),default:(0,i.w5)((()=>[(0,i._)("div",h,[(0,i.wy)((0,i.Wm)(E,{gutter:[16,8],class:"mb-10"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(k.projects,((e,a)=>((0,i.wg)(),(0,i.j4)(D,{key:a,span:4,onClick:a=>t.filterData(e)},{default:(0,i.w5)((()=>[(0,i._)("div",m,[(0,i._)("p",v,(0,l.zw)(e.name),1),(0,i._)("p",g,[(0,i.Uk)(" API "),(0,i._)("span",w,(0,l.zw)(e.policies.length),1),(0,i.Uk)(" "+(0,l.zw)(t.$t("unitge")),1)])])])),_:2},1032,["onClick"])))),128))])),_:1},512),[[s.F8,1==k.viewtypevalue&&!k.viewtypeproject]]),(0,i.wy)((0,i.Wm)(T,{"result-empty":{status:404,title:t.$t("No data")},col:a.hideHead?1:null,loading:k.loading,"data-source":k.policies,"hide-action-title":!a.hideHead,type:"component",actions:a.hideHead?[{icon:"SelectOutlined",text:t.$t("Selector"),call:$.select}]:[{icon:"EditOutlined",text:t.$t("edit"),call:$.detail},{icon:"DeleteOutlined",text:t.$t("delete"),call:$.remove,hide:!0}]},{default:(0,i.w5)((({item:t})=>[(0,i.Wm)(O,null,{title:(0,i.w5)((()=>[(0,i._)("div",y,[(0,i.Uk)((0,l.zw)(t.name)+" ",1),t.project?((0,i.wg)(),(0,i.j4)(S,{key:0,color:"pink",class:"result-tag"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.project.name),1)])),_:2},1024)):(0,i.kq)("",!0)])])),avatar:(0,i.w5)((()=>[(0,i.Wm)(x,{class:"primary"})])),description:(0,i.w5)((()=>[])),_:2},1024),t.content&&t.content.plugins?((0,i.wg)(),(0,i.iD)("blockquote",f,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.content.plugins,((t,e)=>((0,i.wg)(),(0,i.iD)("span",{key:e,class:"mr-20 nowrap"},[(0,i.Wm)(q,{status:t.switch?"processing":"orange"},null,8,["status"]),(0,i.Uk)(" "+(0,l.zw)(t.content.displayName),1)])))),128))])):(0,i.kq)("",!0)])),_:1},8,["result-empty","col","loading","data-source","hide-action-title","actions"]),[[s.F8,0==k.viewtypevalue||k.viewtypeproject]]),(0,i.wy)((0,i.Wm)(I,{onChange:$.searchProject,current:k.pageNo,"onUpdate:current":e[3]||(e[3]=t=>k.pageNo=t),total:k.total,"page-size":k.pageSize,"show-less-items":""},null,8,["onChange","current","total","page-size"]),[[s.F8,1==k.viewtypevalue&&!k.viewtypeproject]]),(0,i.wy)((0,i.Wm)(I,{onChange:$.search,current:k.pageNo,"onUpdate:current":e[4]||(e[4]=t=>k.pageNo=t),total:k.total,"page-size":k.pageSize,"show-less-items":""},null,8,["onChange","current","total","page-size"]),[[s.F8,0==k.viewtypevalue||k.viewtypeproject]])])])),_:1},8,["title","hide-head","style"])}],["__scopeId","data-v-ac71bda6"]])}}]);