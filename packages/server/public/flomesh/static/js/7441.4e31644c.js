"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[7441],{21002:function(e,t,a){a.d(t,{Z:function(){return i}});var n=a(66252);var s={name:"SyncBar",components:{SyncOutlined:a(21826).Z},props:["percent"],methods:{sync(){this.$emit("sync")}}};var i=(0,a(83744).Z)(s,[["render",function(e,t,a,s,i,o){const l=(0,n.up)("a-progress"),r=(0,n.up)("SyncOutlined"),c=(0,n.up)("a-button");return(0,n.wg)(),(0,n.iD)(n.HY,null,[a.percent>-1?((0,n.wg)(),(0,n.j4)(l,{key:0,size:"small",class:"title-progress","stroke-color":{"0%":"#00adef","100%":"#87d068"},percent:a.percent},null,8,["percent"])):(0,n.kq)("",!0),-1==a.percent?((0,n.wg)(),(0,n.j4)(c,{key:1,type:"link",shape:"circle",onClick:o.sync},{icon:(0,n.w5)((()=>[(0,n.Wm)(r,{class:"font-20 icon-menu-sm rotate-icon"})])),_:1},8,["onClick"])):(0,n.kq)("",!0),a.percent>-1&&a.percent<100?((0,n.wg)(),(0,n.j4)(c,{key:2,type:"link",shape:"circle"},{icon:(0,n.w5)((()=>[a.percent>-1&&a.percent<100?((0,n.wg)(),(0,n.j4)(r,{key:0,spin:"",class:"font-12"})):(0,n.kq)("",!0)])),_:1})):(0,n.kq)("",!0)],64)}],["__scopeId","data-v-6a8f29bb"]])},67441:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var n=a(66252);var s=a(3577);const i={key:0},o=["onClick"],l={key:1},r={key:2},c=["onClick"];a(57658);var d=a(2692),u=a(99684),p=a(21002);const h=[{key:"as",dataIndex:"name"},{key:"Namespace",width:130,dataIndex:"namespace"},{key:"protocol",dataIndex:"protocol"},{key:"Creation Timestamp",dataIndex:"creationTimestamp",sorter:!0},{key:"Action",width:130,dataIndex:"action"}];var m={name:"EgressList",components:{MoreOutlined:d.Z,PlusCircleTwoTone:u.Z,SyncBar:p.Z},props:["hasSearch"],i18n:a(89234),data(){return{pageNo:1,syncLoading:-1,pageSize:10,total:0,key:"",columns:h,loading:!0,list:[]}},computed:{dataColumns(){return this.columns.map((e=>(e.title=this.$t(e.key),e)))},start(){return(this.pageNo-1)*this.pageSize}},created(){this.sync(!0)},methods:{sync(e){e&&(this.syncLoading=0,this.$gql.mutation("fetchEgresses").then((()=>{this.syncLoading=100,this.search(),setTimeout((()=>{this.syncLoading=-1}),1e3)}))),this.syncLoading<90&&(this.syncLoading+=10,setTimeout((()=>{this.sync()}),100))},remove(e){this.$gql.mutation(`deleteEgressSync(id:${e}){data{id}}`).then((()=>{this.$message.success(this.$t("Deleted successfully"),3),this.search()}))},detail(e,t){this.$router.push({path:`/fsm/egress/detail/${t}/${e}`})},search(e,t){e&&(this.pageNo=e,this.pageSize=t);let a={start:this.start,limit:this.pageSize};this.loading=!0;let n={name:{contains:this.key}};this.$gql.query("getEgresses(filters: $filters, pagination: $pagination){\n\t\t\t\t\t\tdata{id,attributes{name,content,createdAt}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}",{filters:n,pagination:a},{filters:"EgressFiltersInput",pagination:"PaginationArg"}).then((e=>{this.list=this.reset(e.data),this.total=e.pagination.total,this.loading=!1}))},reset(e){for(let t=0;t<e.length;t++){let a=e[t].content;e[t].name=a.metadata.name,e[t].namespace=a.metadata.namespace,e[t].protocol=a.metadata.protocol,e[t].labels=a.metadata.labels?a.metadata.labels:{},e[t].hosts=a.hosts,e[t].creationTimestamp=new Date(e[t].createdAt).toLocaleString()}return e},newEgress(){this.$router.push({path:"/fsm/egress/create"})}}},g=a(83744);var w={name:"Egresss",components:{EgressList:(0,g.Z)(m,[["render",function(e,t,a,d,u,p){const h=(0,n.up)("a-input-search"),m=(0,n.up)("a-divider"),g=(0,n.up)("PlusCircleTwoTone"),w=(0,n.up)("a-button"),y=(0,n.up)("SyncBar"),k=(0,n.up)("a-tag"),f=(0,n.up)("a-menu-item"),v=(0,n.up)("a-popconfirm"),_=(0,n.up)("a-menu"),$=(0,n.up)("MoreOutlined"),b=(0,n.up)("a-dropdown"),C=(0,n.up)("a-table"),S=(0,n.up)("a-card"),z=(0,n.Q2)("permission");return(0,n.wg)(),(0,n.j4)(S,{class:"card nopd",title:e.$t("Egress"),loading:u.loading},(0,n.Nv)({default:(0,n.w5)((()=>[(0,n._)("div",null,[(0,n.Wm)(C,{pagination:{showSizeChanger:!1,showQuickJumper:!1,onShowSizeChange:p.search,onChange:p.search,current:u.pageNo,pageSize:u.pageSize,showTotal:(t,a)=>`${e.$t("Total")} ${t}`,total:u.total},columns:p.dataColumns,"data-source":u.list,class:"bg-white"},{bodyCell:(0,n.w5)((({column:t,record:a})=>["name"===t.dataIndex?((0,n.wg)(),(0,n.iD)("div",i,[(0,n._)("a",{href:"javascript:void(0)",onClick:e=>p.detail(a.id,a.namespace)},(0,s.zw)(a.name),9,o)])):"labels"===t.dataIndex?((0,n.wg)(),(0,n.iD)("div",l,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Object.keys(a.labels),((e,t)=>((0,n.wg)(),(0,n.j4)(k,{key:t,closable:!1},{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(e)+":"+(0,s.zw)(a.labels[e]),1)])),_:2},1024)))),128))])):"action"===t.dataIndex?((0,n.wg)(),(0,n.iD)("div",r,[(0,n.Wm)(b,null,{overlay:(0,n.w5)((()=>[(0,n.Wm)(_,null,{default:(0,n.w5)((()=>[(0,n.wy)(((0,n.wg)(),(0,n.j4)(f,null,{default:(0,n.w5)((()=>[(0,n._)("a",{onClick:e=>p.detail(a.id,a.namespace)},(0,s.zw)(e.$t("edit")),9,c)])),_:2},1024)),[[z,["egress:find"]]]),(0,n.Wm)(f,null,{default:(0,n.w5)((()=>[(0,n.Wm)(v,{placement:"topLeft","ok-text":e.$t("Yes"),"cancel-text":e.$t("No"),onConfirm:e=>p.remove(a.id)},{title:(0,n.w5)((()=>[(0,n._)("p",null,(0,s.zw)(e.$t("Tip")),1),(0,n._)("p",null,(0,s.zw)(e.$t("Are you sure to delete this?")),1)])),default:(0,n.w5)((()=>[(0,n.wy)(((0,n.wg)(),(0,n.iD)("a",null,[(0,n.Uk)((0,s.zw)(e.$t("delete")),1)])),[[z,["egress:delete"]]])])),_:2},1032,["ok-text","cancel-text","onConfirm"])])),_:2},1024)])),_:2},1024)])),default:(0,n.w5)((()=>[(0,n._)("a",null,[(0,n.Wm)($)])])),_:2},1024)])):(0,n.kq)("",!0)])),_:1},8,["pagination","columns","data-source"])])])),_:2},[a.hasSearch?{name:"extra",fn:(0,n.w5)((()=>[(0,n._)("div",null,[(0,n.Wm)(h,{value:u.key,"onUpdate:value":t[0]||(t[0]=e=>u.key=e),onSearch:t[1]||(t[1]=e=>p.search()),class:"right-search-input",placeholder:e.$t("search")},null,8,["value","placeholder"]),(0,n.wy)((0,n.Wm)(m,{type:"vertical"},null,512),[[z,["egress:create"]]]),(0,n.wy)(((0,n.wg)(),(0,n.j4)(w,{type:"link",shape:"circle",onClick:p.newEgress},{icon:(0,n.w5)((()=>[(0,n.Wm)(g,{class:"font-20 icon-menu-sm rotate-icon"})])),_:1},8,["onClick"])),[[z,["egress:create"]]]),(0,n.wy)((0,n.Wm)(m,{type:"vertical"},null,512),[[z,["egress:create"]]]),(0,n.wy)((0,n.Wm)(y,{percent:u.syncLoading,onSync:t[2]||(t[2]=e=>p.sync(!0))},null,8,["percent"]),[[z,["egress:create"]]])])])),key:"0"}:void 0]),1032,["title","loading"])}],["__scopeId","data-v-1c2b65e1"]])},i18n:a(89234),data(){return{}},created(){}};var y=(0,g.Z)(w,[["render",function(e,t,a,s,i,o){const l=(0,n.up)("EgressList");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(l,{"has-search":!0})])}]])}}]);