"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[6991],{36102:function(e,a,t){t.d(a,{Z:function(){return h}});var i=t(66252);const s={class:"cpu-body"},n={class:"cpu-body"},o={key:1},r={class:"relative"},l={class:"relative"};t(57658);var d=t(35316),m=t(80927),u=t(48551),c=t(72167),p={name:"CPUMemory",components:{ChartCard:m.Z,MiniArea:u.Z,InfoCircleOutlined:d.Z},i18n:t(89234),props:["metrics","loading","layout"],data(){return{cpu:[],memory:[],memortUnit:"Ki",loadingCPU:!1,loadingMemory:!1}},watch:{loading(){this.loadingCPU=this.loading,this.loadingMemory=this.loading},metrics(e){this.renderData(e)}},mounted(){this.renderData(this.metrics),this.loadingCPU=this.loading,this.loadingMemory=this.loading},methods:{renderData(e){this.cpu=[],this.memory=[];let a=0;for(let t=0;t<e.length;t++)e[t].memory>a&&(a=e[t].memory);this.memortUnit=a>1e6?"Gi":a>1e3?"Mi":"Ki";let t={Ki:1,Mi:1e3,Gi:1e6};for(let a=0;a<e.length;a++)this.cpu.push({type:"CPU",value:e[a].cpu/1e9,date:(0,c.Z)(new Date(1e3*e[a].time),"HH:mm")}),this.memory.push({type:"Memory",value:e[a].memory/t[this.memortUnit],date:(0,c.Z)(new Date(1e3*e[a].time),"HH:mm")})}}};var h=(0,t(83744).Z)(p,[["render",function(e,a,t,d,m,u){const c=(0,i.up)("MiniArea"),p=(0,i.up)("a-col"),h=(0,i.up)("a-row"),g=(0,i.up)("InfoCircleOutlined"),y=(0,i.up)("a-tooltip"),w=(0,i.up)("ChartCard");return(0,i.wg)(),(0,i.iD)("div",null,["v"!=t.layout?((0,i.wg)(),(0,i.j4)(h,{key:0,class:"cpu-layout",gutter:[24,0]},{default:(0,i.w5)((()=>[m.cpu?((0,i.wg)(),(0,i.j4)(p,{key:0,sm:24,md:12,xl:12},{default:(0,i.w5)((()=>[(0,i._)("div",s,[(0,i.Wm)(c,{colors:["rgba(107,204,255,1)","rgba(127,214,247,0.4)"],height:240,padding:[0,0,0,0],axis:!1,unit:"cores",showy:!1,id:"cpu-area"+Math.ceil(1e3*Math.random()),dv:m.cpu},null,8,["colors","id","dv"])])])),_:1})):(0,i.kq)("",!0),m.memory?((0,i.wg)(),(0,i.j4)(p,{key:1,sm:24,md:12,xl:12},{default:(0,i.w5)((()=>[(0,i._)("div",n,[(0,i.Wm)(c,{colors:["rgba(195,158,253,1)","rgba(195,158,253,0.4)"],height:240,padding:[0,0,0,0],unit:m.memortUnit,axis:!1,showy:!1,id:"memory-area"+Math.ceil(1e3*Math.random()),dv:m.memory},null,8,["colors","unit","id","dv"])])])),_:1})):(0,i.kq)("",!0)])),_:1})):(0,i.kq)("",!0),"v"==t.layout?((0,i.wg)(),(0,i.iD)("div",o,[m.cpu?((0,i.wg)(),(0,i.j4)(w,{key:0,padding:"20px 24px 28px",height:"120px","not-ft":!0,loading:m.loadingCPU,title:e.$t("CPU Usage"),class:"mb-20"},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{title:e.$t("introduce")},{action:(0,i.w5)((()=>[(0,i.Wm)(g)])),_:1},8,["title"]),(0,i._)("div",r,[(0,i.Wm)(c,{colors:["rgba(107,204,255,1)","rgba(127,214,247,0.4)"],height:230,padding:[55,5,5,15],axis:!0,unit:"cores",id:"cpu-area"+Math.ceil(1e3*Math.random()),dv:m.cpu},null,8,["colors","id","dv"])])])),_:1},8,["loading","title"])):(0,i.kq)("",!0),m.memory?((0,i.wg)(),(0,i.j4)(w,{key:1,padding:"20px 24px 28px",height:"120px","not-ft":!0,loading:m.loadingMemory,title:e.$t("Memory Usage")},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{title:e.$t("introduce")},{action:(0,i.w5)((()=>[(0,i.Wm)(g)])),_:1},8,["title"]),(0,i._)("div",l,[(0,i.Wm)(c,{colors:["rgba(195,158,253,1)","rgba(195,158,253,0.4)"],height:230,padding:[55,5,5,15],axis:!0,unit:m.memortUnit,id:"memory-area"+Math.ceil(1e3*Math.random()),dv:m.memory},null,8,["colors","unit","id","dv"])])])),_:1},8,["loading","title"])):(0,i.kq)("",!0)])):(0,i.kq)("",!0)])}],["__scopeId","data-v-ef2e4ec2"]])},96991:function(e,a,t){t.d(a,{Z:function(){return w}});var i=t(66252),s=t(3577);const n={key:0},o=["onClick"],r={key:2},l={key:1},d={key:1},m={key:6},u=["onClick"];t(57658);var c=t(2692),p=t(36102),h=t(16822);const g=[{key:" ",dataIndex:"t"},{key:"as",dataIndex:"name"},{key:"Namespace",width:130,dataIndex:"namespace"},{key:"Labels",dataIndex:"labels"},{key:"node",dataIndex:"node"},{key:"Status",dataIndex:"phase"},{key:"Restart",dataIndex:"restartCount"},{key:"Cpu Usage(cores)",dataIndex:"cpuUsage"},{key:"Memory Usage(cores)",dataIndex:"memoryUsage"},{key:"Creation Timestamp",dataIndex:"creationTimestamp"},{key:"Action",width:130,dataIndex:"action"}];var y={name:"PodList",components:{CPUMemory:p.Z,MoreOutlined:c.Z,Status:h.Z},props:["embed","d","url","metric","hasSearch","namespace"],i18n:t(89234),data(){return{params:{pageNo:1,pageSize:10,total:0,key:""},columns:g,metrics:[],loading:!1,list:[]}},computed:{dataColumns(){return this.columns.map((e=>(e.title=this.$t(e.key),e)))}},created(){this.embed?(this.list=this.reset(this.d),this.params.total=this.d.length,this.metrics=null,this.loading=!1):this.search()},methods:{detail(e,a){this.$router.push({path:`/workload/pod/detail/${a}/${e}`})},MakeUrl(){let e=this.$REST.K8S.append(this.params.pageSize,this.params.pageNo,"d,creationTimestamp",this.params.key);return this.$REST.K8S.encode(this.url,e,this.namespace)},search(e,a){e&&(this.params.pageNo=e,this.params.pageSize=a),this.loading=!0,this.$request(this.MakeUrl(),this.$METHOD.GET).then((e=>{let a=e.data;this.list=this.reset(a.items),this.params.total=a.count,this.metrics=a.metrics,this.loading=!1}))},reset(e){let a={Ki:1,Mi:1e3,Gi:1e6};for(let t=0;t<e.length;t++){e[t].uid=e[t].metadata.uid,e[t].name=e[t].metadata.name,e[t].namespace=e[t].metadata.namespace,e[t].labels=e[t].metadata.labels,e[t].node=e[t].spec.nodeName,e[t].restartCount=e[t].status.containerStatuses?e[t].status.containerStatuses[0].restartCount:0,e[t].cpuUsage=e[t].metrics&&e[t].metrics.length>0?(e[t].metrics[e[t].metrics.length-1].cpu/1e9).toFixed(2)+"cores":null;let i=e[t].metrics&&e[t].metrics.length>0?e[t].metrics[e[t].metrics.length-1].memory:null,s="Ki";s=i>1e6?"Gi":i>1e3?"Mi":"Ki",e[t].memoryUsage=i?""+(i/a[s]).toFixed(2)+s:null,e[t].creationTimestamp=new Date(e[t].metadata.creationTimestamp).toLocaleString(),e[t].phase=e[t].status.phase}return e}}};var w=(0,t(83744).Z)(y,[["render",function(e,a,t,c,p,h){const g=(0,i.up)("CPUMemory"),y=(0,i.up)("a-input-search"),w=(0,i.up)("Status"),k=(0,i.up)("a-tag"),v=(0,i.up)("a-badge"),f=(0,i.up)("a-menu-item"),x=((0,i.up)("a-popconfirm"),(0,i.up)("a-menu")),C=(0,i.up)("MoreOutlined"),U=(0,i.up)("a-dropdown"),_=(0,i.up)("a-table"),b=(0,i.up)("a-card");return(0,i.wg)(),(0,i.iD)("div",null,[t.metric?((0,i.wg)(),(0,i.j4)(g,{key:0,loading:p.loading,metrics:p.metrics},null,8,["loading","metrics"])):(0,i.kq)("",!0),(0,i.Wm)(b,{class:"card nopd",title:e.$t("Pods"),loading:p.loading},(0,i.Nv)({default:(0,i.w5)((()=>[(0,i._)("div",null,[(0,i.Wm)(_,{pagination:{showSizeChanger:!1,showQuickJumper:!1,onShowSizeChange:h.search,onChange:h.search,current:p.params.pageNo,pageSize:p.params.pageSize,showTotal:(a,t)=>`${e.$t("Total")} ${a}`,total:p.params.total},columns:h.dataColumns,"data-source":p.list,class:"bg-white"},{bodyCell:(0,i.w5)((({column:a,record:t})=>["name"===a.dataIndex?((0,i.wg)(),(0,i.iD)("div",n,[(0,i._)("a",{href:"javascript:void(0)",onClick:e=>h.detail(t.name,t.namespace)},(0,s.zw)(t.name),9,o)])):"t"===a.dataIndex?((0,i.wg)(),(0,i.j4)(w,{key:1,d:{status:t.phase}},null,8,["d"])):"labels"===a.dataIndex?((0,i.wg)(),(0,i.iD)("div",r,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(Object.keys(t.labels),((e,a)=>((0,i.wg)(),(0,i.j4)(k,{key:a,closable:!1},{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(e)+":"+(0,s.zw)(t.labels[e]),1)])),_:2},1024)))),128))])):"restartCount"===a.dataIndex?((0,i.wg)(),(0,i.j4)(v,{key:3,count:t.restartCount,"show-zero":!1},null,8,["count"])):"cpuUsage"===a.dataIndex?((0,i.wg)(),(0,i.iD)(i.HY,{key:4},[t.cpuUsage?((0,i.wg)(),(0,i.j4)(k,{key:0},{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(t.cpuUsage),1)])),_:2},1024)):((0,i.wg)(),(0,i.iD)("span",l,"-"))],64)):"memoryUsage"===a.dataIndex?((0,i.wg)(),(0,i.iD)(i.HY,{key:5},[t.memoryUsage?((0,i.wg)(),(0,i.j4)(k,{key:0},{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(t.memoryUsage),1)])),_:2},1024)):((0,i.wg)(),(0,i.iD)("span",d,"-"))],64)):"action"===a.dataIndex?((0,i.wg)(),(0,i.iD)("div",m,[(0,i.Wm)(U,null,{overlay:(0,i.w5)((()=>[(0,i.Wm)(x,null,{default:(0,i.w5)((()=>[(0,i.Wm)(f,null,{default:(0,i.w5)((()=>[(0,i._)("a",{onClick:e=>h.detail(t.name,t.namespace)},(0,s.zw)(e.$t("view")),9,u)])),_:2},1024),(0,i.kq)("",!0)])),_:2},1024)])),default:(0,i.w5)((()=>[(0,i._)("a",null,[(0,i.Wm)(C)])])),_:2},1024)])):(0,i.kq)("",!0)])),_:1},8,["pagination","columns","data-source"])])])),_:2},[t.hasSearch?{name:"extra",fn:(0,i.w5)((()=>[(0,i._)("div",null,[(0,i.Wm)(y,{value:p.params.key,"onUpdate:value":a[0]||(a[0]=e=>p.params.key=e),onSearch:a[1]||(a[1]=e=>h.search()),class:"right-search-input",placeholder:e.$t("search")},null,8,["value","placeholder"])])])),key:"0"}:void 0]),1032,["title","loading"])])}],["__scopeId","data-v-5709f68f"]])}}]);