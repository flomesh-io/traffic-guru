"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[2954],{38718:function(e,t,i){i.d(t,{Z:function(){return g}});var a=i(66252),s=i(3577),l=i(87932);const n=(e=>((0,a.dD)("data-v-357cff26"),e=e(),(0,a.Cn)(),e))((()=>(0,a._)("img",{src:l,style:{width:"300px"}},null,-1))),d=["src"],o={key:1};var c=i(75255),r=i(54367),u=i(50976),p=i(1006),h=i(9294),m={name:"PluginConfig",i18n:i(89234),components:{AutoForm:u.Z,CheckOutlined:c.Z,CloseOutlined:r.Z,JsEditor:h.Z},props:["type","addText","plugins","disabled"],data(){return{DEFAULT_BASE_URL:p.DEFAULT_BASE_URL,tabList:[{key:"Config",tab:"Config"},{key:"Script",tab:"Script"}],loading:!0}},computed:{},watch:{plugins:{handler(){this.plugins&&this.plugins.forEach((e=>{e.content.tabVal||(e.content.tabVal="Config")}))},immediate:!0,deep:!0}},mounted(){},created(){this.loading=!1},methods:{onTabChange(e,t){this.plugins[t].content.tabVal=e},remove(e){this.plugins.splice(e,1)},add(){this.$emit("add",{})}}};var g=(0,i(83744).Z)(m,[["render",function(e,t,i,l,c,r){const u=(0,a.up)("a-button"),p=(0,a.up)("a-result"),h=(0,a.up)("CheckOutlined"),m=(0,a.up)("a-switch"),g=(0,a.up)("CloseOutlined"),v=(0,a.up)("AutoForm"),w=(0,a.up)("JsEditor"),b=(0,a.up)("a-card"),k=(0,a.Q2)("permission");return(0,a.wg)(),(0,a.iD)(a.HY,null,[0==i.plugins.length?((0,a.wg)(),(0,a.j4)(p,{key:0,title:e.$t("No data")},{icon:(0,a.w5)((()=>[n])),extra:(0,a.w5)((()=>[i.addText&&"service"==i.type?(0,a.wy)(((0,a.wg)(),(0,a.j4)(u,{key:0,disabled:i.disabled,type:"primary",onClick:r.add},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t(i.addText)),1)])),_:1},8,["disabled","onClick"])),[[k,["service:update"]]]):i.addText?((0,a.wg)(),(0,a.j4)(u,{key:1,disabled:i.disabled,type:"primary",onClick:r.add},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t(i.addText)),1)])),_:1},8,["disabled","onClick"])):(0,a.kq)("",!0)])),_:1},8,["title"])):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.plugins,((t,l)=>((0,a.wg)(),(0,a.j4)(b,{key:l,class:(0,s.C_)(["card mb-24","Script"==t.content.tabVal?"nopd":""]),"tab-list":c.tabList,"active-tab-key":t.content.tabVal,onTabChange:e=>r.onTabChange(e,l),bordered:!1,loading:c.loading},{customTab:(0,a.w5)((t=>[(0,a.Uk)((0,s.zw)(e.$t(t.key)),1)])),title:(0,a.w5)((()=>[t.icon?((0,a.wg)(),(0,a.iD)("img",{key:0,src:c.DEFAULT_BASE_URL+t.icon.url,alt:"avatar",class:"card-img"},null,8,d)):(0,a.kq)("",!0),(0,a.Uk)(" "+(0,s.zw)(t.name)+" ",1),t.content.displayName&&t.name!=t.content.displayName?((0,a.wg)(),(0,a.iD)("span",o," ( "+(0,s.zw)(t.content.displayName)+" ) ",1)):(0,a.kq)("",!0)])),extra:(0,a.w5)((()=>[(0,a.Wm)(m,{checked:t.enable,"onUpdate:checked":e=>t.enable=e,disabled:i.disabled},{checkedChildren:(0,a.w5)((()=>[(0,a.Wm)(h)])),unCheckedChildren:(0,a.w5)((()=>[])),_:2},1032,["checked","onUpdate:checked","disabled"]),(0,a.Wm)(g,{class:(0,s.C_)([i.disabled?"disabled":"","gray"]),onClick:e=>r.remove(l)},null,8,["class","onClick"])])),default:(0,a.w5)((()=>["Config"==t.content.tabVal?((0,a.wg)(),(0,a.iD)("div",{key:0,class:(0,s.C_)(i.disabled?"disabled":"")},[(0,a.Wm)(v,{fields:[t.content.fields],col:3},null,8,["fields"])],2)):((0,a.wg)(),(0,a.j4)(w,{key:1,"is-readonly":i.disabled,id:"pluginScript"+l,value:t.content.script,"onUpdate:value":e=>t.content.script=e},null,8,["is-readonly","id","value","onUpdate:value"]))])),_:2},1032,["class","tab-list","active-tab-key","onTabChange","loading"])))),128))],64)}],["__scopeId","data-v-357cff26"]])},9294:function(e,t,i){i.d(t,{Z:function(){return n}});var a=i(66252);var s=i(29764);(0,i(25552).H)({id:"javascript",extensions:[".js",".es6",".jsx",".mjs"],firstLine:"^#!.*\\bnode",filenames:["jakefile"],aliases:["JavaScript","javascript","js"],mimetypes:["text/javascript"],loader:function(){return i.e(6015).then(i.bind(i,6015))}});var l={name:"JsEditor",components:{monacoeditor:s.Z},props:["value","height","isReadonly","id","theme"],data(){return{code:"",cmOptions:{lineNumbers:!0,mode:"javascript",readOnly:!1,lint:!0}}},watch:{value(e,t){e!==t&&this.setValue()}},mounted(){this.setValue()},methods:{change(e){"string"==typeof e&&(this.$emit("update:value",e),this.$emit("change",e))},setValue(){null!=this.value.replace&&(this.code=this.value)}}};var n=(0,i(83744).Z)(l,[["render",function(e,t,i,s,l,n){const d=(0,a.up)("monacoeditor");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(d,{id:i.id||"JsEditor",content:l.code,"onUpdate:content":t[0]||(t[0]=e=>l.code=e),option:l.cmOptions,onChange:n.change,height:i.height,theme:i.theme,"is-readonly":i.isReadonly},null,8,["id","content","option","onChange","height","theme","is-readonly"])])}]])},60389:function(e,t,i){i.d(t,{Z:function(){return k}});var a=i(66252),s=i(3577);const l={key:0,href:"#"},n=["onClick"],d=["onClick"],o=["onClick"],c=["onClick"],r=["onClick"],u={key:0},p={class:"list-content"},h={class:"list-content-item"};i(57658);var m=i(21936),g=i(2692),v=i(99684),w=i(26129),b={name:"CheckpointList",i18n:i(89234),components:{MoreOutlined:g.Z,PlusCircleTwoTone:v.Z,WifiOutlined:w.Z,JsonEditor:m.Z},props:["modeId","modeName","modeType"],data(){return{visible:!1,key:"",log:"{}",pageSize:10,pageNo:1,total:0,loading:!0,list:[],dialTestings:[]}},computed:{start(){return(this.pageNo-1)*this.pageSize}},created(){this.search()},methods:{viewLog(){this.visible=!0},remove(e){this.$gql.mutation(`deleteDialTesting(id:${e}){data{id}}`).then((()=>{this.$message.success(this.$t("Deleted successfully"),3),this.search()}))},newLb(){this.$router.push({path:"/inspector/checkpoint/create"})},hcdetail(e){this.$router.push({path:"/inspector/healthcheck/detail/"+e})},detail(e){this.$router.push({path:"/inspector/checkpoint/detail/"+e})},search(e,t){this.modeId&&this.$gql.query("dialTestings{data{id,attributes{name,content, services{data{id}}}}}").then((e=>{this.dialTestings=e.data.filter((e=>!e.services.find((e=>this.modeId==e.id))))})),e&&(this.pageNo=e,this.pageSize=t),this.loading=!0;let i={start:this.start,limit:this.pageSize},a={};a.name={contains:this.key},this.modeId&&(a.services={id:{eq:this.modeId}}),this.$gql.query("dialTestings(filters: $filters, pagination: $pagination){\n\t\t\t\t\t\tdata{\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tattributes{\n\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\thealthcheck{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\tfleet{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\t\tcreatedAt\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}",{filters:a,pagination:i},{filters:"DialTestingFiltersInput",pagination:"PaginationArg"}).then((e=>{this.list=e.data,this.$emit("getDialTestings",e.data),this.total=e.pagination.total,this.loading=!1}))},addBind(){if(!this.addBindVal?.length)return;this.addBindVal[0].content||(this.addBindVal[0].content={}),this.addBindVal[0].content.targets||(this.addBindVal[0].content.targets=[]),this.addBindVal[0].content.targets.push({id:this.modeId,type:this.modeType,name:this.modeName});let e=this.addBindVal[0].content.targets.filter((e=>e.type==this.modeType));e=e.map((e=>Number(e.id)));for(let t of this.addBindVal)this.$gql.mutation(`updateDialTesting(id:${t.id}, data: $data){data{id}}`,{data:{content:t.content,services:e}},{data:"DialTestingInput!"}).then((()=>{this.addBindVal=[],this.$message.success(this.$t("Bind successfully"),3),this.search()}))},unbind(e){e.content.targets.some(((t,i)=>{t.id===this.modeId&&e.content.targets.splice(i,1)}));let t=e.content.targets.filter((e=>"service"==e.type));t=t.map((e=>Number(e.id))),this.$gql.mutation(`updateDialTesting(id:${e.id}, data: $data){data{id}}`,{data:{content:e.content,services:t}},{data:"DialTestingInput"}).then((()=>{this.$message.success(this.$t("Unbind successfully"),3),this.search()}))},onClose(){this.visible=!1}}};var k=(0,i(83744).Z)(b,[["render",function(e,t,i,m,g,v){const w=(0,a.up)("a-input-search"),b=(0,a.up)("a-divider"),k=(0,a.up)("PlusCircleTwoTone"),y=(0,a.up)("a-button"),f=(0,a.up)("a-select-option"),S=(0,a.up)("a-select"),_=(0,a.up)("a-popconfirm"),C=(0,a.up)("WifiOutlined"),$=(0,a.up)("a-list-item-meta"),x=(0,a.up)("a-menu-item"),D=(0,a.up)("a-menu"),T=(0,a.up)("MoreOutlined"),W=(0,a.up)("a-dropdown"),U=(0,a.up)("a-tag"),j=(0,a.up)("a-list-item"),A=(0,a.up)("a-list"),E=(0,a.up)("a-card"),L=(0,a.up)("JsonEditor"),z=(0,a.up)("a-drawer");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(E,{bordered:!1,title:i.modeName?e.$t("Bind Dial Test"):e.$t("Dial Test"),loading:g.loading},{extra:(0,a.w5)((()=>[(0,a._)("div",null,[i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(w,{key:0,value:g.key,"onUpdate:value":t[0]||(t[0]=e=>g.key=e),onSearch:t[1]||(t[1]=e=>v.search()),class:"right-search-input",placeholder:e.$t("search")},null,8,["value","placeholder"])),i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(b,{key:1,type:"vertical"})),i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(y,{key:2,type:"link",shape:"circle",onClick:v.newLb},{icon:(0,a.w5)((()=>[(0,a.Wm)(k,{class:"PlusCircle icon-menu-sm rotate-icon"})])),_:1},8,["onClick"])),(0,a.Wm)(_,{"ok-text":e.$t("Add Bind"),onConfirm:v.addBind},{title:(0,a.w5)((()=>[(0,a._)("p",null,(0,s.zw)(e.$t("Please select dial test")),1),(0,a.Wm)(S,{class:"width-220",mode:"multiple",value:e.addBindVal,"onUpdate:value":t[2]||(t[2]=t=>e.addBindVal=t)},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(g.dialTestings,((e,t)=>((0,a.wg)(),(0,a.j4)(f,{value:e,key:t},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),default:(0,a.w5)((()=>[i.modeName?((0,a.wg)(),(0,a.iD)("a",l,[(0,a.Wm)(k,{class:"PlusCircle"})])):(0,a.kq)("",!0)])),_:1},8,["ok-text","onConfirm"])])])),default:(0,a.w5)((()=>[(0,a.Wm)(A,{size:"large",pagination:!i.modeName&&{showSizeChanger:!0,showQuickJumper:!1,onShowSizeChange:v.search,onChange:v.search,current:g.pageNo,pageSize:g.pageSize,showTotal:(t,i)=>`${e.$t("Total")} ${t}`,total:g.total}},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(g.list,((t,l)=>((0,a.wg)(),(0,a.j4)(j,{key:l},{actions:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(W,null,{overlay:(0,a.w5)((()=>[(0,a.Wm)(D,null,{default:(0,a.w5)((()=>[(0,a.Wm)(x,null,{default:(0,a.w5)((()=>[(0,a._)("a",{onClick:e=>v.viewLog(t.id)},(0,s.zw)(e.$t("log")),9,o)])),_:2},1024),(0,a.Wm)(x,null,{default:(0,a.w5)((()=>[i.modeName?((0,a.wg)(),(0,a.iD)("a",{key:0,onClick:e=>v.unbind(t)},(0,s.zw)(e.$t("Unbind")),9,c)):(0,a.kq)("",!0)])),_:2},1024),i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(x,{key:0},{default:(0,a.w5)((()=>[(0,a._)("a",{onClick:e=>v.detail(t.id)},(0,s.zw)(e.$t("edit")),9,r)])),_:2},1024)),(0,a.Wm)(x,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{placement:"topLeft","ok-text":e.$t("Yes"),"cancel-text":e.$t("No"),onConfirm:e=>v.remove(t.id)},{title:(0,a.w5)((()=>[(0,a._)("p",null,(0,s.zw)(e.$t("Tip")),1),(0,a._)("p",null,(0,s.zw)(e.$t("Are you sure to delete this?")),1)])),default:(0,a.w5)((()=>[i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("a",u,(0,s.zw)(e.$t("delete")),1))])),_:2},1032,["ok-text","cancel-text","onConfirm"])])),_:2},1024)])),_:2},1024)])),default:(0,a.w5)((()=>[(0,a._)("a",null,[(0,a.Wm)(T)])])),_:2},1024)])])),default:(0,a.w5)((()=>[(0,a.Wm)($,null,{avatar:(0,a.w5)((()=>[(0,a.Wm)(C,{class:"list-item-avatar"})])),title:(0,a.w5)((()=>[(0,a._)("a",{onClick:e=>v.detail(t.id)},(0,s.zw)(t.name?t.name:"Unnamed"),9,n)])),description:(0,a.w5)((()=>[(0,a._)("span",null,[(0,a._)("a",{onClick:e=>v.hcdetail(t.healthcheck.id)},(0,s.zw)(e.$t("Check configuration"))+"-"+(0,s.zw)(t.healthcheck.name),9,d)])])),_:2},1024),(0,a._)("div",p,[(0,a._)("div",h,[(0,a._)("span",null,(0,s.zw)(e.$t("Checkpoint Target")),1),(0,a._)("p",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.content.targets,((e,t)=>((0,a.wg)(),(0,a.j4)(U,{key:t},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.type)+":"+(0,s.zw)(e.name),1)])),_:2},1024)))),128))])])])])),_:2},1024)))),128))])),_:1},8,["pagination"])])),_:1},8,["title","loading"]),g.visible?((0,a.wg)(),(0,a.j4)(z,{key:0,"get-container":!1,title:e.$t("log"),placement:"bottom",height:"600",closable:!1,visible:g.visible,onClose:v.onClose},{default:(0,a.w5)((()=>[(0,a.Wm)(L,{"is-readonly":!0,value:g.log},null,8,["value"])])),_:1},8,["title","visible","onClose"])):(0,a.kq)("",!0)])}],["__scopeId","data-v-43a393ce"]])},72535:function(e,t,i){i.d(t,{Z:function(){return g}});var a=i(66252),s=i(3577);const l=["onClick"],n={key:0},d={key:0},o={key:0},c={class:"list-content"},r={class:"list-content-item"};i(57658);var u=i(2692),p=i(99684),h=i(15541),m={name:"List",i18n:i(89234),components:{MoreOutlined:u.Z,PlusCircleTwoTone:p.Z,MedicineBoxOutlined:h.Z},props:["modeName","modeId","modeType","dialTestings"],data(){return{addBindVal:[],key:"",pageSize:10,pageNo:1,total:0,loading:!0,list:[]}},computed:{searchFilter(){return""!=this.key?this.list.filter((e=>e.name.indexOf(this.key)>-1||e.ip.indexOf(this.key)>-1)):this.list},start(){return(this.pageNo-1)*this.pageSize}},created(){this.search()},methods:{newLb(){this.$router.push({path:"/inspector/healthcheck/create"})},detail(e){this.$router.push({path:"/inspector/healthcheck/detail/"+e})},remove(e){this.$gql.mutation(`deleteHealthcheck(id:${e}){data{id}}`).then((()=>{this.$message.success(this.$t("Deleted successfully"),3),this.search()}))},search(e,t){e&&(this.pageNo=e,this.pageSize=t);let i={start:this.start,limit:this.pageSize};this.loading=!0,this.list=[];let a={};a.name={contains:this.key},this.modeId&&(a.dialTestings={or:[]},this.dialTestings.forEach((e=>{a.dialTestings.or.push({id:{eq:e.id}})}))),this.$gql.query("healthchecks(filters: $filters, pagination: $pagination){\n\t\t\t\t\t\tdata{\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tattributes{\n\t\t\t\t\t\t\t\tname,content,createdAt, \n\t\t\t\t\t\t\t\tdialTestings{data{id,attributes{name,content}}}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}",{filters:a,pagination:i},{filters:"HealthcheckFiltersInput",pagination:"PaginationArg"}).then((e=>{for(let t of e.data)t.dialTestingName="",t.dialTestings.some((e=>{for(let i=0;i<e.content.targets.length;i++){let a=e.content.targets[i];if(a.type==this.modeType&&a.id==this.modeId){t.dialTestingName+=e.name+" ";break}}}));this.list=e.data,this.list.forEach((e=>{e.content&&e.content.length>1&&(e.status=e.content[0].data[0][0].value.concat(e.content[1].data[0][0].value))})),this.total=e.pagination.total,this.loading=!1}))}}};var g=(0,i(83744).Z)(m,[["render",function(e,t,i,u,p,h){const m=(0,a.up)("a-input-search"),g=(0,a.up)("a-divider"),v=(0,a.up)("PlusCircleTwoTone"),w=(0,a.up)("a-button"),b=(0,a.up)("MedicineBoxOutlined"),k=(0,a.up)("a-list-item-meta"),y=(0,a.up)("a-popconfirm"),f=(0,a.up)("a-menu-item"),S=(0,a.up)("a-menu"),_=(0,a.up)("MoreOutlined"),C=(0,a.up)("a-dropdown"),$=(0,a.up)("a-tag"),x=(0,a.up)("a-list-item"),D=(0,a.up)("a-list"),T=(0,a.up)("a-card");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(T,{loading:p.loading,bordered:!1,title:i.modeName?e.$t("Bind Healthcheck"):e.$t("Healthcheck List")},{extra:(0,a.w5)((()=>[(0,a._)("div",null,[i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(m,{key:0,value:p.key,"onUpdate:value":t[0]||(t[0]=e=>p.key=e),onInput:t[1]||(t[1]=e=>h.search()),class:"right-search-input",placeholder:e.$t("search")},null,8,["value","placeholder"])),i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(g,{key:1,type:"vertical"})),i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(w,{key:2,type:"link",shape:"circle",onClick:h.newLb},{icon:(0,a.w5)((()=>[(0,a.Wm)(v,{class:"PlusCircle icon-menu-sm rotate-icon"})])),_:1},8,["onClick"]))])])),default:(0,a.w5)((()=>[(0,a.Wm)(D,{size:"large",pagination:!i.modeName&&{showSizeChanger:!0,showQuickJumper:!1,onShowSizeChange:h.search,onChange:h.search,current:p.pageNo,pageSize:p.pageSize,showTotal:(t,i)=>`${e.$t("Total")} ${t}`,total:p.total}},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(p.list,((t,u)=>((0,a.wg)(),(0,a.j4)(x,{key:u},{actions:(0,a.w5)((()=>[i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",d,[(0,a.Wm)(C,null,{overlay:(0,a.w5)((()=>[(0,a.Wm)(S,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(y,{placement:"topLeft","ok-text":e.$t("Yes"),"cancel-text":e.$t("No"),onConfirm:e=>h.remove(t.id)},{title:(0,a.w5)((()=>[(0,a._)("p",null,(0,s.zw)(e.$t("Tip")),1),(0,a._)("p",null,(0,s.zw)(e.$t("Are you sure to delete this?")),1)])),default:(0,a.w5)((()=>[i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("a",o,(0,s.zw)(e.$t("delete")),1))])),_:2},1032,["ok-text","cancel-text","onConfirm"])])),_:2},1024)])),_:2},1024)])),default:(0,a.w5)((()=>[(0,a._)("a",null,[(0,a.Wm)(_)])])),_:2},1024)]))])),default:(0,a.w5)((()=>[(0,a.Wm)(k,null,{avatar:(0,a.w5)((()=>[(0,a.Wm)(b,{class:"list-item-avatar"})])),title:(0,a.w5)((()=>[(0,a._)("a",{onClick:e=>h.detail(t.id)},(0,s.zw)(t.name?t.name:e.$t("unnamed")),9,l)])),description:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)("0"==t.type?e.$t("Passive Healthcheck"):e.$t("Active Healthcheck"))+" ",1),i.modeName?((0,a.wg)(),(0,a.iD)("span",n," - "+(0,s.zw)(t.dialTestingName),1)):(0,a.kq)("",!0)])),_:2},1024),(0,a._)("div",c,[(0,a._)("div",r,[(0,a._)("span",null,(0,s.zw)(e.$t("Status"))+"ï¼š",1),(0,a._)("p",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.content.success,((e,t)=>((0,a.wg)(),(0,a.j4)($,{class:"mb-5",key:t,color:"#88d4a1"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e),1)])),_:2},1024)))),128)),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.content.failure,((e,t)=>((0,a.wg)(),(0,a.j4)($,{class:"mb-5",key:t,color:"#fb9690"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e),1)])),_:2},1024)))),128))])])])])),_:2},1024)))),128))])),_:1},8,["pagination"])])),_:1},8,["loading","title"])])}],["__scopeId","data-v-7c7a5f10"]])},76360:function(e,t,i){i.r(t),i.d(t,{default:function(){return P}});var a=i(66252),s=i(3577),l=i(49963);i(57658);var n=i(69384),d=i(88711);const o={key:0},c=["onClick"],r={key:3},u={key:0},p=["onClick"],h={key:3};var m=i(13554),g=i(87202);const v=[{key:"as",dataIndex:"name"},{key:"Namespace",width:160,dataIndex:"namespace"},{key:"Excluded path",width:330,dataIndex:"excludedPath"},{key:"Action",width:70,dataIndex:"action"}];var w={name:"ServicesACL",i18n:i(89234),components:{DeleteOutlined:g.Z,ServiceList:m.Z},props:["blacklistServices","whitelistServices","subscribeServices","subscribeServicesAll","detail"],data(){return{svc_columns:v,whiteAddress:[],blackAddress:[]}},computed:{svcColumns(){return this.svc_columns.map((e=>(e.title=this.$t(e.key),e)))}},methods:{svcdetail(e,t){this.$router.push({path:`/fsm/service/detail/${t}/${e}`})},delWhitelistServices(e){let t=this.whitelistServices;this.whitelistServices.some(((t,i)=>{e.id===t.id&&this.whitelistServices.splice(i,1)}));let i=this.subscribeServicesAll.filter((e=>!t.concat(this.blacklistServices).find((t=>t.id==e.id))));this.$emit("update:whitelistServices",t),this.$emit("update:subscribeServices",i)},delblacklistServices(e){let t=this.blacklistServices;t.some(((i,a)=>{e.id===i.id&&t.splice(a,1)}));let i=this.subscribeServicesAll.filter((e=>!this.whitelistServices.concat(t).find((t=>t.id==e.id))));this.$emit("update:blacklistServices",t),this.$emit("update:subscribeServices",i)}}},b=i(83744);var k=(0,b.Z)(w,[["render",function(e,t,i,l,n,d){const m=(0,a.up)("ServiceList"),g=(0,a.up)("a-col"),v=(0,a.up)("a-input"),w=(0,a.up)("DeleteOutlined"),b=(0,a.up)("a-table"),k=(0,a.up)("a-card"),y=(0,a.up)("a-row"),f=(0,a.up)("a-tab-pane"),S=(0,a.up)("a-tabs");return(0,a.wg)(),(0,a.j4)(k,{class:"card",bordered:!1},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{activeKey:e.aclKey,"onUpdate:activeKey":t[0]||(t[0]=t=>e.aclKey=t),"tab-position":"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{key:"2",tab:e.$t("Service Black/White")},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{class:"row-mg"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"col-pd",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{mode:"ACL","destroy-inactive-tab-pane":!0,metric:!1,"has-search":!0,"embed-services":i.subscribeServices,embed:!0,"whitelist-services":i.whitelistServices,"blacklist-services":i.blacklistServices},null,8,["embed-services","whitelist-services","blacklist-services"])])),_:1}),(0,a.Wm)(g,{class:"col-pd",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{class:"card nopd",title:e.$t("Service White")},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{columns:d.svcColumns,"data-source":i.whitelistServices,pagination:!1},{bodyCell:(0,a.w5)((({column:t,record:l})=>["name"===t.dataIndex?((0,a.wg)(),(0,a.iD)("div",o,[(0,a._)("a",{href:"javascript:void(0)",onClick:e=>d.svcdetail(l.name,l.namespace)},(0,s.zw)(l.name),9,c)])):"namespace"===t.dataIndex?((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a.Uk)((0,s.zw)(l.registry.name+" / "+l.namespace),1)],64)):"excludedPath"===t.dataIndex?((0,a.wg)(),(0,a.j4)(v,{key:2,placeholder:e.$t("unset"),value:i.detail.whiteExcludedPath[l.id],"onUpdate:value":e=>i.detail.whiteExcludedPath[l.id]=e},null,8,["placeholder","value","onUpdate:value"])):"action"===t.dataIndex?((0,a.wg)(),(0,a.iD)("a",r,[(0,a.Wm)(w,{onClick:e=>d.delWhitelistServices(l)},null,8,["onClick"])])):(0,a.kq)("",!0)])),_:1},8,["columns","data-source"])])),_:1},8,["title"]),(0,a.Wm)(k,{class:"card mb-20 nopd",title:e.$t("Service Black")},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{columns:d.svcColumns,"data-source":i.blacklistServices,pagination:!1},{bodyCell:(0,a.w5)((({column:t,record:l})=>["name"===t.dataIndex?((0,a.wg)(),(0,a.iD)("div",u,[(0,a._)("a",{href:"javascript:void(0)",onClick:e=>d.svcdetail(l.name,l.namespace)},(0,s.zw)(l.name),9,p)])):"namespace"===t.dataIndex?((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a.Uk)((0,s.zw)(l.registry.name+" / "+l.namespace),1)],64)):"excludedPath"===t.dataIndex?((0,a.wg)(),(0,a.j4)(v,{key:2,placeholder:e.$t("unset"),value:i.detail.blackExcludedPath[l.id],"onUpdate:value":e=>i.detail.blackExcludedPath[l.id]=e},null,8,["placeholder","value","onUpdate:value"])):"action"===t.dataIndex?((0,a.wg)(),(0,a.iD)("a",h,[(0,a.Wm)(w,{onClick:e=>d.delblacklistServices(l)},null,8,["onClick"])])):(0,a.kq)("",!0)])),_:1},8,["columns","data-source"])])),_:1},8,["title"])])),_:1})])),_:1})])),_:1},8,["tab"])])),_:1},8,["activeKey"])])),_:1})}]]),y=i(38718),f=i(43462),S=i(79954),_=i(96991),C=i(33907),$=i(44107),x=i(49702),D=i(47556),T=i(990),W=i(88843),U=i(9294),j=i(60389),A=i(72535),E=i(48551),L=i(9112),z={name:"ServicesDetail",i18n:i(89234),components:{RingStatus:f.Z,ServiceBaseDetail:n.Z,ServiceOverview:d.Z,PodList:_.Z,HealthcheckList:A.Z,CheckpointList:j.Z,Json2YamlCard:$.Z,ServiceList:m.Z,PluginConfig:y.Z,PluginList:S.Z,EmbedDashboard:T.Z,JsEditor:U.Z,LogViewer:x.Z,ServiceACL:k,MiniArea:E.Z,ServiceExportCard:L.Z},data(){return{DEFAULT_SERVICE_DETAIL:D.ZC,activeKey:"1",external:{url:"",type:"Http://",token:""},visibleAP:!1,dialTestings:[],visible:!1,aclKey:"2",extend:{plugins:[],certificates:[],identitys:{},log:{level:"All"}},registry:{type:"",name:"",content:{}},ns:{id:"",name:""},pods:[],detail:{endpoints:[],spec:{type:"",clusterIP:"",sessionAffinity:"",ports:[]},metadata:{name:"",namespace:"",labels:{},annotations:{}},typeMeta:{},podInfo:{},containerImages:[],selector:{},statusInfo:{},conditions:[],rollingUpdateStrategy:{maxUnavailable:"",maxSurge:""},whiteExcludedPath:{},blackExcludedPath:{}},pjsConfig:"",contentString:"",loading:!0,pid:"",namespace:"",isMounted:!1,cumulativeMetrics:[],healthcheckData:{healthchecks_timer:[],healthchecks:{health:0,unhealthy:0}},subscribeServices:[],subscribeServicesTo:[],subscribeServicesAll:[],whitelistServices:[],blacklistServices:[],exportLoading:!1,modalVisible:!1,isExportEdit:!0}},computed:{...(0,C.rn)("setting",["isMobile"]),svcColumns(){return this.svc_columns.map((e=>(e.title=this.$t(e.key),e)))}},created(){this.pid=this.$route.params.id||"",this.namespace=this.$route.params.namespace||localStorage.getItem("NAMESPACE")},mounted(){(0,W.oj)("service",this.pid).then((e=>{this.healthcheckData=e}))},methods:{exportOpen(){this.activeKey="15",this.modalVisible=!0},exportStart(){this.exportLoading=!0},exportSave(){this.exportLoading=!1},getDialTestings(e){this.dialTestings=e},selectPlugin(e){this.extend.plugins.push({...e,enable:!0}),this.visibleAP=!1,this.$message.success(this.$t("Added successfully"),3)},showPluginBox(){this.visibleAP=!0},svcdetail(e,t){this.$router.push({path:`/fsm/service/detail/${t}/${e}`})},onTabChange(e){},saveLogLevel(e){this.$refs.ServiceBaseDetail.saveLogLevel(e)},getSaveData(){this.$refs.ServiceBaseDetail.getSaveData()},setSaveData(){this.$refs.ServiceBaseDetail.setSaveData()},handleOk(){},pjsChange(e){this.pjsConfig=e},getDefaultPjsConfig(){fetch("pipy-4lb.js").then((e=>e.text())).then((e=>{this.pjsConfig=e})).catch((e=>{}))}}};var P=(0,b.Z)(z,[["render",function(e,t,i,n,d,o){const c=(0,a.up)("a-button"),r=((0,a.up)("a-divider"),(0,a.up)("RingStatus"),(0,a.up)("MiniArea")),u=(0,a.up)("a-card"),p=(0,a.up)("a-col"),h=(0,a.up)("ServiceOverview"),m=(0,a.up)("a-tab-pane"),g=(0,a.up)("PodList"),v=(0,a.up)("CheckpointList"),w=(0,a.up)("HealthcheckList"),b=(0,a.up)("a-row"),k=(0,a.up)("PluginConfig"),y=(0,a.up)("ServiceACL"),f=(0,a.up)("JsEditor"),S=(0,a.up)("Json2YamlCard"),_=(0,a.up)("ServiceExportCard"),C=(0,a.up)("ServiceList"),$=(0,a.up)("LogViewer"),x=(0,a.up)("EmbedDashboard"),D=(0,a.up)("a-tabs"),T=(0,a.up)("ServiceBaseDetail"),W=(0,a.up)("PluginList"),U=(0,a.up)("a-modal"),j=(0,a.Q2)("permission");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(T,{loading:d.loading,"onUpdate:loading":t[10]||(t[10]=e=>d.loading=e),namespace:d.namespace,"onUpdate:namespace":t[11]||(t[11]=e=>d.namespace=e),pid:d.pid,"onUpdate:pid":t[12]||(t[12]=e=>d.pid=e),contentString:d.contentString,"onUpdate:contentString":t[13]||(t[13]=e=>d.contentString=e),detail:d.detail,"onUpdate:detail":t[14]||(t[14]=e=>d.detail=e),registry:d.registry,"onUpdate:registry":t[15]||(t[15]=e=>d.registry=e),ns:d.ns,"onUpdate:ns":t[16]||(t[16]=e=>d.ns=e),pods:d.pods,"onUpdate:pods":t[17]||(t[17]=e=>d.pods=e),extend:d.extend,"onUpdate:extend":t[18]||(t[18]=e=>d.extend=e),hasExport:d.isExportEdit,"onUpdate:hasExport":t[19]||(t[19]=e=>d.isExportEdit=e),blacklistServices:d.blacklistServices,"onUpdate:blacklistServices":t[20]||(t[20]=e=>d.blacklistServices=e),whitelistServices:d.whitelistServices,"onUpdate:whitelistServices":t[21]||(t[21]=e=>d.whitelistServices=e),subscribeServices:d.subscribeServices,"onUpdate:subscribeServices":t[22]||(t[22]=e=>d.subscribeServices=e),subscribeServicesTo:d.subscribeServicesTo,"onUpdate:subscribeServicesTo":t[23]||(t[23]=e=>d.subscribeServicesTo=e),subscribeServicesAll:d.subscribeServicesAll,"onUpdate:subscribeServicesAll":t[24]||(t[24]=e=>d.subscribeServicesAll=e),ref:"ServiceBaseDetail"},(0,a.Nv)({action:(0,a.w5)((()=>[d.isExportEdit?(0,a.kq)("",!0):(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{key:0,loading:d.exportLoading,type:"primary",onClick:o.exportOpen},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("Export")),1)])),_:1},8,["loading","onClick"])),[[j,["service:update"]]])])),tabs:(0,a.w5)((()=>[(0,a.Wm)(D,{type:"card",activeKey:d.activeKey,"onUpdate:activeKey":t[9]||(t[9]=e=>d.activeKey=e)},{rightExtra:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(c,{type:"primary",onClick:o.showPluginBox},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("Add Plugin")),1)])),_:1},8,["onClick"])),[[j,["service:update"]],[l.F8,"7"==d.activeKey&&d.extend.plugins.length>0]])])),default:(0,a.w5)((()=>[(0,a.Wm)(m,{key:"1",tab:e.$t("Overview")},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{pid:d.pid,detail:d.detail,"onUpdate:detail":t[0]||(t[0]=e=>d.detail=e),registry:d.registry},{right:(0,a.w5)((()=>[""!=d.pid?((0,a.wg)(),(0,a.j4)(p,{key:0,class:"col-pd",xl:8,lg:24,md:24,sm:24,xs:24},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{title:e.$t("Healthy Status"),class:"card nopd",bordered:!1,loading:d.loading},{default:(0,a.w5)((()=>[d.healthcheckData.healthchecks_timer&&d.healthcheckData.healthchecks_timer.length>0?((0,a.wg)(),(0,a.j4)(r,{key:0,colors:["#8bd4a1","#fb9690"],height:240,padding:[0,0,0,0],axis:!1,unit:e.$t("unitge"),showy:!1,dv:d.healthcheckData.healthchecks_timer},null,8,["unit","dv"])):((0,a.wg)(),(0,a.j4)(r,{key:1,colors:["#8bd4a1","#fb9690"],height:240,padding:[0,0,0,0],axis:!1,unit:e.$t("unitge"),showy:!1,dv:[{type:"-",date:(new Date).toLocaleDateString(),value:0}]},null,8,["unit","dv"]))])),_:1},8,["title","loading"])])),_:1})):(0,a.kq)("",!0)])),_:1},8,["pid","detail","registry"])])),_:1},8,["tab"]),""!=d.pid&&"k8s"==d.registry.type?((0,a.wg)(),(0,a.j4)(m,{key:"3",tab:e.$t("Pods")},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"card nopd",bordered:!1,loading:d.loading},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{namespace:d.namespace,"has-search":!1,d:d.pods},null,8,["namespace","d"])])),_:1},8,["loading"])])),_:1},8,["tab"])):(0,a.kq)("",!0),""!=d.pid&&e.$isPro&&"k8s"==d.registry.type?((0,a.wg)(),(0,a.j4)(m,{key:"5",tab:e.$t("Healthcheck")},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{class:"row-mg"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"col-pd",xl:14,lg:24,md:24,sm:24,xs:24},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{"mode-type":"service","mode-id":d.pid,"mode-name":d.detail.metadata.name,onGetDialTestings:o.getDialTestings},null,8,["mode-id","mode-name","onGetDialTestings"])])),_:1}),(0,a.Wm)(p,{class:"col-pd",xl:10,lg:24,md:24,sm:24,xs:24},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{"mode-name":d.detail.metadata.name,"mode-type":"service","mode-id":d.pid,"dial-testings":d.dialTestings},null,8,["mode-name","mode-id","dial-testings"])])),_:1})])),_:1})])),_:1},8,["tab"])):(0,a.kq)("",!0),e.$isPro?((0,a.wg)(),(0,a.j4)(m,{key:"7",tab:e.$t("Identity")},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{class:"row-mg"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"col-pd",xl:24,lg:24,md:24,sm:24,xs:24},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{plugins:d.extend.plugins,"onUpdate:plugins":t[1]||(t[1]=e=>d.extend.plugins=e),onAdd:o.showPluginBox,type:"service","add-text":e.$t("Add Plugin")},null,8,["plugins","onAdd","add-text"])])),_:1})])),_:1})])),_:1},8,["tab"])):(0,a.kq)("",!0),e.$isPro?((0,a.wg)(),(0,a.j4)(m,{key:"8",tab:e.$t("ACL")},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{detail:d.detail,blacklistServices:d.blacklistServices,"onUpdate:blacklistServices":t[2]||(t[2]=e=>d.blacklistServices=e),whitelistServices:d.whitelistServices,"onUpdate:whitelistServices":t[3]||(t[3]=e=>d.whitelistServices=e),subscribeServices:d.subscribeServices,"onUpdate:subscribeServices":t[4]||(t[4]=e=>d.subscribeServices=e),subscribeServicesAll:d.subscribeServicesAll,"onUpdate:subscribeServicesAll":t[5]||(t[5]=e=>d.subscribeServicesAll=e)},null,8,["detail","blacklistServices","whitelistServices","subscribeServices","subscribeServicesAll"])])),_:1},8,["tab"])):(0,a.kq)("",!0),e.$isPro&&"k8s"==d.registry.type?((0,a.wg)(),(0,a.j4)(m,{key:"10",tab:e.$t("PJS")},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{class:"card mb-24",bordered:!1},(0,a.Nv)({extra:(0,a.w5)((()=>[(0,a.Wm)(c,{type:"primary",onClick:e.excute},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("save")),1)])),_:1},8,["onClick"])])),default:(0,a.w5)((()=>[(0,a.Wm)(f,{value:d.pjsConfig,onInput:o.pjsChange},null,8,["value","onInput"])])),_:2},[void 0]),1024)])),_:1},8,["tab"])):(0,a.kq)("",!0),"k8s"==d.registry.type?((0,a.wg)(),(0,a.j4)(m,{key:"11",tab:e.$t("config"),onClick:o.getSaveData},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{class:"card full nopd","is-readonly":!1,"is-create":!1,jsonVal:d.contentString,"onUpdate:jsonVal":t[6]||(t[6]=e=>d.contentString=e),onChange:o.setSaveData},null,8,["jsonVal","onChange"])])),_:1},8,["tab","onClick"])):(0,a.kq)("",!0),d.pid&&"k8s"==d.registry.type?((0,a.wg)(),(0,a.j4)(m,{key:"15",tab:e.$t("MCS")},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{sid:d.pid,ports:d.detail?.spec?.ports,loading:d.loading,isEdit:d.isExportEdit,"onUpdate:isEdit":t[7]||(t[7]=e=>d.isExportEdit=e),modal:d.modalVisible,"onUpdate:modal":t[8]||(t[8]=e=>d.modalVisible=e),onStart:o.exportStart,onSave:o.exportSave},null,8,["sid","ports","loading","isEdit","modal","onStart","onSave"])])),_:1},8,["tab"])):(0,a.kq)("",!0),e.$isPro?((0,a.wg)(),(0,a.j4)(m,{key:"12",tab:e.$t("Subscribe Service")},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{mode:"Subscribe Service",title:e.$t("Subscribe Service"),"destroy-inactive-tab-pane":!0,metric:!1,"has-search":!1,"embed-services":d.subscribeServicesTo,embed:!0},null,8,["title","embed-services"])])),_:1},8,["tab"])):(0,a.kq)("",!0),""!=d.pid?((0,a.wg)(),(0,a.j4)(m,{key:"13",tab:e.$t("log")},{default:(0,a.w5)((()=>[(0,a.Wm)($,{uid:d.pid,params:{name:d.detail.metadata?.name,namespace:d.detail.metadata?.namespace,domain:d.registry.content?.domain},type:"service","log-level":d.extend.log.level,onSave:o.saveLogLevel},null,8,["uid","params","log-level","onSave"])])),_:1},8,["tab"])):(0,a.kq)("",!0),""!=d.pid&&"k8s"==d.registry.type?((0,a.wg)(),(0,a.j4)(m,{key:"14",tab:e.$t("Dashboard")},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{"page-id":d.pid,params:{name:d.detail.metadata?.name,namespace:d.ns?.name,namespaceId:d.ns?.id,domain:d.registry.content?.domain},apply:"service","default-widget":d.DEFAULT_SERVICE_DETAIL,"hide-add":"14"!=d.activeKey},null,8,["page-id","params","default-widget","hide-add"])])),_:1},8,["tab"])):(0,a.kq)("",!0)])),_:1},8,["activeKey"])])),_:2},[void 0]),1032,["loading","namespace","pid","contentString","detail","registry","ns","pods","extend","hasExport","blacklistServices","whitelistServices","subscribeServices","subscribeServicesTo","subscribeServicesAll"]),(0,a.Wm)(U,{footer:null,width:"80%",visible:d.visibleAP,"onUpdate:visible":t[25]||(t[25]=e=>d.visibleAP=e),title:e.$t("Add Plugin"),onOk:o.handleOk},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{apply:"service",onSelectPlugin:o.selectPlugin,"hide-head":!0},null,8,["onSelectPlugin"])])),_:1},8,["visible","title","onOk"])],64)}],["__scopeId","data-v-4ed08602"]])}}]);