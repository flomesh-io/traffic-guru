"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[389],{60389:function(t,e,n){n.d(e,{Z:function(){return _}});n(74916),n(64765),n(68309),n(92222);var i=n(66252),a=n(3577),o={key:0,href:"#"},l=["onClick"],u=["onClick"],r=["onClick"],c=["onClick"],s=["onClick"],d={key:0},f={class:"list-content"},h={class:"list-content-item"};var m=n(66347),p=(n(57658),n(57327),n(41539),n(69826),n(21249),n(9653),n(40561),n(21936)),g=n(2692),w=n(99684),k=n(26129),v={name:"CheckpointList",i18n:n(89234),components:{MoreOutlined:g.Z,PlusCircleTwoTone:w.Z,WifiOutlined:k.Z,JsonEditor:p.Z},props:["modeId","modeName","modeType"],data:function(){return{visible:!1,key:"",log:"{}",pageSize:10,pageNo:1,total:0,loading:!0,list:[],dialTestings:[]}},computed:{start:function(){return(this.pageNo-1)*this.pageSize}},created:function(){this.search()},methods:{viewLog:function(){this.visible=!0},remove:function(t){var e=this;this.$gql.mutation("deleteDialTesting(id:".concat(t,"){data{id}}")).then((function(){e.$message.success(e.$t("Deleted successfully"),3),e.search()}))},newLb:function(){this.$router.push({path:"/inspector/checkpoint/create"})},hcdetail:function(t){this.$router.push({path:"/inspector/healthcheck/detail/"+t})},detail:function(t){this.$router.push({path:"/inspector/checkpoint/detail/"+t})},search:function(t,e){var n=this;this.modeId&&this.$gql.query("dialTestings{data{id,attributes{name,content, services{data{id}}}}}").then((function(t){n.dialTestings=t.data.filter((function(t){return!t.services.find((function(t){return n.modeId==t.id}))}))})),t&&(this.pageNo=t,this.pageSize=e),this.loading=!0;var i={start:this.start,limit:this.pageSize},a={};a.name={contains:this.key},this.modeId&&(a.services={id:{eq:this.modeId}}),this.$gql.query("dialTestings(filters: $filters, pagination: $pagination){\n\t\t\t\t\t\tdata{\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tattributes{\n\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\thealthcheck{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\tfleet{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\t\tcreatedAt\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}",{filters:a,pagination:i},{filters:"DialTestingFiltersInput",pagination:"PaginationArg"}).then((function(t){n.list=t.data,n.$emit("getDialTestings",t.data),n.total=t.pagination.total,n.loading=!1}))},addBind:function(){var t,e=this;if(null!==(t=this.addBindVal)&&void 0!==t&&t.length){this.addBindVal[0].content||(this.addBindVal[0].content={}),this.addBindVal[0].content.targets||(this.addBindVal[0].content.targets=[]),this.addBindVal[0].content.targets.push({id:this.modeId,type:this.modeType,name:this.modeName});var n=this.addBindVal[0].content.targets.filter((function(t){return t.type==e.modeType}));n=n.map((function(t){return Number(t.id)}));var i,a=(0,m.Z)(this.addBindVal);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.$gql.mutation("updateDialTesting(id:".concat(o.id,", data: $data){data{id}}"),{data:{content:o.content,services:n}},{data:"DialTestingInput!"}).then((function(){e.addBindVal=[],e.$message.success(e.$t("Bind successfully"),3),e.search()}))}}catch(t){a.e(t)}finally{a.f()}}},unbind:function(t){var e=this;t.content.targets.some((function(n,i){n.id===e.modeId&&t.content.targets.splice(i,1)}));var n=t.content.targets.filter((function(t){return"service"==t.type}));n=n.map((function(t){return Number(t.id)})),this.$gql.mutation("updateDialTesting(id:".concat(t.id,", data: $data){data{id}}"),{data:{content:t.content,services:n}},{data:"DialTestingInput"}).then((function(){e.$message.success(e.$t("Unbind successfully"),3),e.search()}))},onClose:function(){this.visible=!1}}};var _=(0,n(83744).Z)(v,[["render",function(t,e,n,m,p,g){var w=(0,i.up)("a-input-search"),k=(0,i.up)("a-divider"),v=(0,i.up)("PlusCircleTwoTone"),_=(0,i.up)("a-button"),$=(0,i.up)("a-select-option"),y=(0,i.up)("a-select"),C=(0,i.up)("a-popconfirm"),b=(0,i.up)("WifiOutlined"),T=(0,i.up)("a-list-item-meta"),z=(0,i.up)("a-menu-item"),N=(0,i.up)("a-menu"),W=(0,i.up)("MoreOutlined"),D=(0,i.up)("a-dropdown"),q=(0,i.up)("a-tag"),B=(0,i.up)("a-list-item"),I=(0,i.up)("a-list"),V=(0,i.up)("a-card"),S=(0,i.up)("JsonEditor"),j=(0,i.up)("a-drawer");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(V,{bordered:!1,title:n.modeName?t.$t("Bind Dial Test"):t.$t("Dial Test"),loading:p.loading},{extra:(0,i.w5)((function(){return[(0,i._)("div",null,[n.modeName?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(w,{key:0,value:p.key,"onUpdate:value":e[0]||(e[0]=function(t){return p.key=t}),onSearch:e[1]||(e[1]=function(t){return g.search()}),class:"right-search-input",placeholder:t.$t("search")},null,8,["value","placeholder"])),n.modeName?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(k,{key:1,type:"vertical"})),n.modeName?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(_,{key:2,type:"link",shape:"circle",onClick:g.newLb},{icon:(0,i.w5)((function(){return[(0,i.Wm)(v,{class:"PlusCircle icon-menu-sm rotate-icon"})]})),_:1},8,["onClick"])),(0,i.Wm)(C,{"ok-text":t.$t("Add Bind"),onConfirm:g.addBind},{title:(0,i.w5)((function(){return[(0,i._)("p",null,(0,a.zw)(t.$t("Please select dial test")),1),(0,i.Wm)(y,{class:"width-220",mode:"multiple",value:t.addBindVal,"onUpdate:value":e[2]||(e[2]=function(e){return t.addBindVal=e})},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(p.dialTestings,(function(t,e){return(0,i.wg)(),(0,i.j4)($,{value:t,key:e},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.name),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["value"])]})),default:(0,i.w5)((function(){return[n.modeName?((0,i.wg)(),(0,i.iD)("a",o,[(0,i.Wm)(v,{class:"PlusCircle"})])):(0,i.kq)("",!0)]})),_:1},8,["ok-text","onConfirm"])])]})),default:(0,i.w5)((function(){return[(0,i.Wm)(I,{size:"large",pagination:!n.modeName&&{showSizeChanger:!0,showQuickJumper:!1,onShowSizeChange:g.search,onChange:g.search,current:p.pageNo,pageSize:p.pageSize,showTotal:function(e,n){return"".concat(t.$t("Total")," ").concat(e)},total:p.total}},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(p.list,(function(e,o){return(0,i.wg)(),(0,i.j4)(B,{key:o},{actions:(0,i.w5)((function(){return[(0,i._)("div",null,[(0,i.Wm)(D,null,{overlay:(0,i.w5)((function(){return[(0,i.Wm)(N,null,{default:(0,i.w5)((function(){return[(0,i.Wm)(z,null,{default:(0,i.w5)((function(){return[(0,i._)("a",{onClick:function(t){return g.viewLog(e.id)}},(0,a.zw)(t.$t("log")),9,r)]})),_:2},1024),(0,i.Wm)(z,null,{default:(0,i.w5)((function(){return[n.modeName?((0,i.wg)(),(0,i.iD)("a",{key:0,onClick:function(t){return g.unbind(e)}},(0,a.zw)(t.$t("Unbind")),9,c)):(0,i.kq)("",!0)]})),_:2},1024),n.modeName?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(z,{key:0},{default:(0,i.w5)((function(){return[(0,i._)("a",{onClick:function(t){return g.detail(e.id)}},(0,a.zw)(t.$t("edit")),9,s)]})),_:2},1024)),(0,i.Wm)(z,null,{default:(0,i.w5)((function(){return[(0,i.Wm)(C,{placement:"topLeft","ok-text":t.$t("Yes"),"cancel-text":t.$t("No"),onConfirm:function(t){return g.remove(e.id)}},{title:(0,i.w5)((function(){return[(0,i._)("p",null,(0,a.zw)(t.$t("Tip")),1),(0,i._)("p",null,(0,a.zw)(t.$t("Are you sure to delete this?")),1)]})),default:(0,i.w5)((function(){return[n.modeName?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("a",d,(0,a.zw)(t.$t("delete")),1))]})),_:2},1032,["ok-text","cancel-text","onConfirm"])]})),_:2},1024)]})),_:2},1024)]})),default:(0,i.w5)((function(){return[(0,i._)("a",null,[(0,i.Wm)(W)])]})),_:2},1024)])]})),default:(0,i.w5)((function(){return[(0,i.Wm)(T,null,{avatar:(0,i.w5)((function(){return[(0,i.Wm)(b,{class:"list-item-avatar"})]})),title:(0,i.w5)((function(){return[(0,i._)("a",{onClick:function(t){return g.detail(e.id)}},(0,a.zw)(e.name?e.name:"Unnamed"),9,l)]})),description:(0,i.w5)((function(){return[(0,i._)("span",null,[(0,i._)("a",{onClick:function(t){return g.hcdetail(e.healthcheck.id)}},(0,a.zw)(t.$t("Check configuration"))+"-"+(0,a.zw)(e.healthcheck.name),9,u)])]})),_:2},1024),(0,i._)("div",f,[(0,i._)("div",h,[(0,i._)("span",null,(0,a.zw)(t.$t("Checkpoint Target")),1),(0,i._)("p",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.content.targets,(function(t,e){return(0,i.wg)(),(0,i.j4)(q,{key:e},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.type)+":"+(0,a.zw)(t.name),1)]})),_:2},1024)})),128))])])])]})),_:2},1024)})),128))]})),_:1},8,["pagination"])]})),_:1},8,["title","loading"]),p.visible?((0,i.wg)(),(0,i.j4)(j,{key:0,"get-container":!1,title:t.$t("log"),placement:"bottom",height:"600",closable:!1,visible:p.visible,onClose:g.onClose},{default:(0,i.w5)((function(){return[(0,i.Wm)(S,{"is-readonly":!0,value:p.log},null,8,["value"])]})),_:1},8,["title","visible","onClose"])):(0,i.kq)("",!0)])}],["__scopeId","data-v-43a393ce"]])}}]);