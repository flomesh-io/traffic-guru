"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[7887],{9294:function(t,e,n){n.d(e,{Z:function(){return s}});var a=n(66252);var i=n(29764);(0,n(25552).H)({id:"javascript",extensions:[".js",".es6",".jsx",".mjs"],firstLine:"^#!.*\\bnode",filenames:["jakefile"],aliases:["JavaScript","javascript","js"],mimetypes:["text/javascript"],loader:function(){return n.e(6015).then(n.bind(n,6015))}});var o={name:"JsEditor",components:{monacoeditor:i.Z},props:["value","height","isReadonly","id","theme"],data(){return{code:"",cmOptions:{lineNumbers:!0,mode:"javascript",readOnly:!1,lint:!0}}},watch:{value(t,e){t!==e&&this.setValue()}},mounted(){this.setValue()},methods:{change(t){"string"==typeof t&&(this.$emit("update:value",t),this.$emit("change",t))},setValue(){null!=this.value.replace&&(this.code=this.value)}}};var s=(0,n(83744).Z)(o,[["render",function(t,e,n,i,o,s){const l=(0,a.up)("monacoeditor");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(l,{id:n.id||"JsEditor",content:o.code,"onUpdate:content":e[0]||(e[0]=t=>o.code=t),option:o.cmOptions,onChange:s.change,height:n.height,theme:n.theme,"is-readonly":n.isReadonly},null,8,["id","content","option","onChange","height","theme","is-readonly"])])}]])},77887:function(t,e,n){n.r(e),n.d(e,{default:function(){return h}});var a=n(66252),i=n(3577);var o=n(96486),s=n.n(o),l=n(61103),c=n(21936),d=n(9294),r=n(79332),u=n(33907),p={name:"Profile",components:{PageLayout:l.Z,JsonEditor:c.Z,JsEditor:d.Z,FormItem:r.Z},i18n:n(89234),data(){return{pid:"",json:{name:"",content:{pipy_config:"",tcp_config:"{}"}},loading:!0}},computed:{...(0,u.rn)("rules",["rules"]),dataColumns(){}},created(){this.pid=this.$route.params.id||""},mounted(){""!=this.pid?(this.loading=!0,this.$gql.query(`profile(id: ${this.pid}){data{id,attributes{name,content}}}`).then((t=>{this.json=t.data,this.json.content.tcp_config=JSON.stringify(this.json.content.tcp_config),this.loading=!1}))):(this.json.name="",this.json.content={pipy_config:"",tcp_config:"{}"},this.getDefaultPipyConfig(),this.loading=!1)},methods:{valid(){return""!=this.json.name||(this.$message.error(this.$t("The name cannot be empty"),3),!1)},validate(){this.$refs.layout.$refs.form.validateFields().then((()=>{this.save()})).catch((()=>{}))},save(){if(!this.valid())return;const t=s().cloneDeep(this.json);t.content=s().cloneDeep(this.json.content),content.pipy_config=this.json.content.pipy_config,content.tcp_config=JSON.parse(this.json.content.tcp_config),""!=this.pid?this.$gql.mutation(`updateProfile(id:${this.pid}, data: $data){data{id}}`,{data:t},{data:"ProfileInput!"}).then((()=>{this.$message.success(this.$t("Save successfully"),3),this.$closePage(this.$route)})):this.$gql.mutation("createProfile(data: $data){data{id}}",{data:t},{data:"ProfileInput!"}).then((t=>{this.pid=t.data.id,this.$message.success(this.$t("Created successfully"),3),this.$closePage(this.$route)}))},getDefaultPipyConfig(){fetch("pipy-4lb.js").then((t=>t.text())).then((t=>{this.json.content.pipy_config=t})).catch((t=>{}))}}};var h=(0,n(83744).Z)(p,[["render",function(t,e,n,o,s,l){const c=(0,a.up)("a-input"),d=(0,a.up)("FormItem"),r=(0,a.up)("a-button"),u=(0,a.up)("JsEditor"),p=(0,a.up)("a-card"),h=(0,a.up)("a-col"),m=(0,a.up)("JsonEditor"),f=(0,a.up)("a-row"),g=(0,a.up)("PageLayout");return(0,a.wg)(),(0,a.j4)(g,{title:t.$t("profile"),bordered:!1,"form-state":s.json,ref:"layout"},{headerContent:(0,a.w5)((()=>[(0,a.Wm)(d,{name:"name",rules:t.rules.uniqueName("profiles",{id:s.pid})},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{placeholder:t.$t("as"),value:s.json.name,"onUpdate:value":e[0]||(e[0]=t=>s.json.name=t),class:"width-200"},null,8,["placeholder","value"])])),_:1},8,["rules"])])),action:(0,a.w5)((()=>[(0,a.Wm)(r,{type:"primary",onClick:l.validate},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(s.pid?t.$t("save"):t.$t("create")),1)])),_:1},8,["onClick"])])),default:(0,a.w5)((()=>[(0,a.Wm)(f,{class:"row-mg"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{class:"col-pd",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"card mb-24",title:"Pipy "+t.$t("config"),bordered:!1},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{onClick:l.getDefaultPipyConfig,class:"profile-btn"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.$t("reset")),1)])),_:1},8,["onClick"]),(0,a.Wm)(u,{value:s.json.content.pipy_config,"onUpdate:value":e[1]||(e[1]=t=>s.json.content.pipy_config=t)},null,8,["value"])])),_:1},8,["title"])])),_:1}),(0,a.Wm)(h,{class:"col-pd",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"card mb-24",title:"TCP "+t.$t("config"),bordered:!1},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{value:s.json.content.tcp_config,"onUpdate:value":e[2]||(e[2]=t=>s.json.content.tcp_config=t)},null,8,["value"])])),_:1},8,["title"])])),_:1})])),_:1})])),_:1},8,["title","form-state"])}],["__scopeId","data-v-31635114"]])}}]);