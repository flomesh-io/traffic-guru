"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[656],{84793:function(t,a,e){e.r(a),e.d(a,{default:function(){return g}});e(68309);var n=e(66252),i=e(3577),o={key:0,class:"width-180"};var s=e(95082),r=e(96486),d=e.n(r),l=e(61103),u=e(15199),c=e(84722),p=e(1299),m=e(13589),f=e(33907),h={name:"Address",i18n:e(89234),components:{PageLayout:l.Z,IPList:u.Z,DetailList:p.Z,DetailListItem:m.Z},data:function(){return{pid:"",name:"",orgs:[],address:[],organization:{},organizationName:"",pool:{name:"",organization:null},loading:!0}},computed:(0,s.Z)({},(0,f.rn)("rules",["rules"])),created:function(){var t=this;this.pid=this.$route.params.id||"",this.pid?(this.loading=!0,this.$gql.query("addressPool(id: ".concat(this.pid,"){data{id,attributes{name,organization{data{id,attributes{name}}},content}}}")).then((function(a){t.pool=a.data,t.organization=a.data.organization,t.pool.organization=a.data.organization&&a.data.organization.id?a.data.organization.id:null,t.address=(0,c.Oy)(a.data.content);for(var e=0;e<t.address.length;e++)t.address[e].editable=!1,t.address[e].isNew=!1;t.loading=!1}))):this.loading=!1,this.$gql.query("myOrganizations{data{id,attributes{name}}}").then((function(a){t.orgs=a.data}))},methods:{validForm:function(){return""==this.pool.name?(this.$message.error(this.$t("Please enter a name"),3),!1):0==this.address.length?(this.$message.error(this.$t("Please enter a address pool"),3),!1):this.$refs.ip.valid()},valid:function(){var t=this;this.$refs.layout.$refs.form.validateFields().then((function(){t.save()})).catch((function(){}))},save:function(){var t=this;if(this.validForm()){var a=(0,c.H)(this.address);this.pool.addressField=a,""!=this.pid?this.$gql.mutation("updateAddressPool(id:".concat(this.pid,", data: $data){data{id}}"),{data:{name:this.pool.name,organization:this.pool.organization,content:d().cloneDeep(this.pool.addressField)}},{data:"AddressPoolInput!"}).then((function(){t.$message.success(t.$t("Save successfully"),3),t.$closePage(t.$route)})):this.$gql.mutation("createAddressPool(data: $data){data{id,attributes{name}}}",{data:{id:this.pool.id,name:this.pool.name,organization:this.pool.organization,content:d().cloneDeep(this.pool.addressField)}},{data:"AddressPoolInput!"}).then((function(a){t.pid=a.data.id,t.$message.success(t.$t("Created successfully"),3),t.$closePage(t.$route)}))}}}};var g=(0,e(83744).Z)(h,[["render",function(t,a,e,s,r,d){var l=(0,n.up)("a-input"),u=(0,n.up)("DetailListItem"),c=(0,n.up)("a-select-option"),p=(0,n.up)("a-select"),m=(0,n.up)("a-tag"),f=(0,n.up)("DetailList"),h=(0,n.up)("a-button"),g=(0,n.up)("IPList"),w=(0,n.up)("PageLayout"),v=(0,n.Q2)("permission");return(0,n.wg)(),(0,n.j4)(w,{title:t.$t("addressPool"),bordered:!1,"form-state":r.pool,ref:"layout"},{headerContent:(0,n.w5)((function(){return[(0,n.Wm)(f,{size:"small",col:2},{default:(0,n.w5)((function(){return[(0,n.Wm)(u,{term:t.$t("as"),name:"name",rules:t.rules.uniqueName("addressPools",{id:r.pid})},{default:(0,n.w5)((function(){return[(0,n.Wm)(l,{placeholder:t.$t("Name"),value:r.pool.name,"onUpdate:value":a[0]||(a[0]=function(t){return r.pool.name=t}),class:"width-200"},null,8,["placeholder","value"])]})),_:1},8,["term","rules"]),(0,n.Wm)(u,{term:t.$t("Organization"),rules:t.rules.required,name:"organization"},{default:(0,n.w5)((function(){return[(0,n.wy)(((0,n.wg)(),(0,n.j4)(p,{placeholder:t.$t("unset"),value:r.pool.organization,"onUpdate:value":a[1]||(a[1]=function(t){return r.pool.organization=t}),class:"width-180",ref:"select"},{default:(0,n.w5)((function(){return[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.orgs,(function(t,a){return(0,n.wg)(),(0,n.j4)(c,{value:t.id,key:a},{default:(0,n.w5)((function(){return[(0,n.Uk)((0,i.zw)(t.name),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["placeholder","value"])),[[v,r.pid?["admin"]:""]]),r.pid?((0,n.wg)(),(0,n.iD)("div",o,[(0,n.wy)(((0,n.wg)(),(0,n.j4)(m,null,{default:(0,n.w5)((function(){var t;return[(0,n.Uk)((0,i.zw)(null===(t=r.organization)||void 0===t?void 0:t.name),1)]})),_:1})),[[v,["!admin"]]])])):(0,n.kq)("",!0)]})),_:1},8,["term","rules"])]})),_:1})]})),action:(0,n.w5)((function(){return[""!=r.pid?(0,n.wy)(((0,n.wg)(),(0,n.j4)(h,{key:0,type:"primary",onClick:d.valid},{default:(0,n.w5)((function(){return[(0,n.Uk)((0,i.zw)(t.$t("save")),1)]})),_:1},8,["onClick"])),[[v,["address-pool:update"]]]):(0,n.wy)(((0,n.wg)(),(0,n.j4)(h,{key:1,type:"primary",onClick:d.valid},{default:(0,n.w5)((function(){return[(0,n.Uk)((0,i.zw)(t.$t("create")),1)]})),_:1},8,["onClick"])),[[v,["address-pool:create"]]])]})),default:(0,n.w5)((function(){return[(0,n.Wm)(g,{list:r.address,"onUpdate:list":a[2]||(a[2]=function(t){return r.address=t}),ref:"ip"},null,8,["list"])]})),_:1},8,["title","form-state"])}]])}}]);