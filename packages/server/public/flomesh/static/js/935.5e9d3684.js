"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[935],{47556:function(t,a,e){e.d(a,{Bl:function(){return o},Cb:function(){return S},DB:function(){return T},Gm:function(){return u},IJ:function(){return O},MZ:function(){return f},O7:function(){return c},Ru:function(){return A},Tf:function(){return y},US:function(){return _},ZC:function(){return i},eb:function(){return E},k5:function(){return r},l1:function(){return m},lr:function(){return n},q8:function(){return s},qF:function(){return b},sl:function(){return g},ud:function(){return p},vC:function(){return l},zN:function(){return h}});var d=e(6199);const s="system.common.ORGANIZATION_TOTAL,system.common.PROJECT_TOTAL,system.common.Space,system.common.Space,workload.dashboard.DEPLOYMENT,workload.dashboard.STATEFULSET,workload.dashboard.JOB,workload.dashboard.POD",n="flb.dashboard.TOTAL,flb.dashboard.ADDRESSPOOL,flb.dashboard.BYTES,flb.dashboard.PROCESS_MEMORY,flb.dashboard.CONNECTIONS,flb.dashboard.INACT_CONNECTIONS,flb.dashboard.FAIL_CONNECTIONS,flb.dashboard.TIME_WAIT,flb.dashboard.FREE_CPU,flb.dashboard.PROCESS_CPU,flb.dashboard.FULL_CONN_OVERFLOW_ERROR,flb.dashboard.HALF_CONN_OVERFLOW_ERROR,flb.dashboard.UNHEALTHY_UPSTREAM,flb.dashboard.RANKING,flb.dashboard.SANKEY",o="fsm.dashboard.REGISTRY_TOTAL,fsm.dashboard.NAMESPACE_TOTAL,fsm.dashboard.SERVICE_TOTAL,system.common.Space,fsm.dashboard.SERVICE_HEALTHCHECK,fsm.dashboard.SERVICE_STATUS,fsm.dashboard.INGRESS_STATUS,fsm.dashboard.MCS_TOPOLOGY",r="fsm.dashboard.NAMESPACE_MESH_TOTAL,fsm.dashboard.SERVICE_MESH_TOTAL,system.common.Space,system.common.Space,system.common.TPS_MESH,system.common.ERROR_RATE_MESH,system.common.LATENCY_MESH,workload.dashboard.POD,fsm.dashboard.TOPOLOGY",i="fsm.dashboard.TPS_ERROR,fsm.dashboard.BPS,fsm.dashboard.LATENCY,fsm.dashboard.LOAD_STATUS,fsm.dashboard.TOPOLOGY,fsm.dashboard.QOS",u="workload.dashboard.CRONJOB,workload.dashboard.DAEMONSET,workload.dashboard.DEPLOYMENT,workload.dashboard.JOB,workload.dashboard.POD,workload.dashboard.REPLICASET,workload.dashboard.REPLICATIONCONTROLLER,workload.dashboard.STATEFULSET",l="openapi.dashboard.API_TOTAL,openapi.dashboard.APP_TOTAL,system.common.ORGANIZATION_TOTAL,system.common.PROJECT_TOTAL,system.common.LATENCY,system.common.USER_AGENT,system.common.QPS,system.common.ERROR_RATE,openapi.dashboard.API_STATUS,openapi.dashboard.API_METRIC_WEEK,openapi.dashboard.API_METRIC_MONTH,system.common.Space,system.common.RANKING",c="openapi.dashboard.API_TOTAL,openapi.dashboard.APP_TOTAL,system.common.Space,system.common.Space,fsm.dashboard.QOS,fsm.dashboard.LATENCY,fsm.dashboard.LOAD_STATUS,fsm.dashboard.TPS_ERROR,fsm.dashboard.BPS,openapi.dashboard.API_STATUS,openapi.dashboard.API_METRIC_WEEK,openapi.dashboard.API_METRIC_MONTH",h="fsm.dashboard.TPS_ERROR,fsm.dashboard.BPS,fsm.dashboard.LATENCY,fsm.dashboard.LOAD_STATUS,openapi.dashboard.TOPOLOGY,fsm.dashboard.QOS,openapi.dashboard.API_METRIC_WEEK,openapi.dashboard.API_METRIC_MONTH";async function m(t){return(0,d.IO)(`dashboard(id:${t}){data{id,attributes{name,content,apply}}}`)}async function p(t){return(0,d.IO)(`dashboards(filters:{apply:{eq:"${t}"}}){data{id,attributes{name,content,apply}}}`)}async function b(t,a){let e={},s="";return a.subscribes&&(s=a.subscribes.join(","),e.content={widget:s}),a.name&&a.name.length>0&&(e.name=a.name),null!=a.apply&&(e.apply=a.apply),(0,d.QF)(`updateDashboard(id:${t}, data: $data){data{id}}`,{data:e},{data:"DashboardInput!"})}async function T(t){let a={};return null!=t.widget&&(a.content={widget:t.widget}),t.name&&t.name.length>0&&(a.name=t.name),null!=t.apply&&(a.apply=t.apply),(0,d.QF)("createDashboard(data: $data){data{id}}",{data:a},{data:"DashboardInput!"})}async function f(t){const a={content:t,name:t.id,shared:0};return(0,d.QF)("createWidget(data: $data){data{id}}",{data:a},{data:"WidgetInput!"})}async function O(t,a){delete a.uid;const e={content:a,name:a.id};return(0,d.QF)(`updateWidget(id:${t}, data: $data){data{id}}`,{data:e},{data:"WidgetInput!"})}async function E(t){return(0,d.QF)(`deleteWidget(id:${t}){data{id}}`)}async function _(){return(0,d.IO)("widgets{data{id,attributes{name,shared,user_id,content}}}")}async function S(t){return(0,d.IO)(`widget(id:${t}){data{id,attributes{name,shared,user_id,content}}}`)}const y={id:"TEST-CUSTOM",title:"A Sample",tag:{name:"Gauge"},service:{type:"rest",path:"hk.flomesh.cn:8090/kube-dashboard/?url=%2Fapi%2Fv1%2Fjob%2Fdefault%3FitemsPerPage%3D0%26page%3D1%26sortBy%3Dd%2CcreationTimestamp",method:"GET",payload:"{}",clickhouseSQL:"",prometheusSQL:""},col:6,data:"res => {\n\tlet _data = res.data;\n\tfunction getPercentage(current,status){\n\t\tlet per = (status.running+status.succeeded+status.failed);\n\t\treturn per ==0 ?0 :Math.round(current*100/per);\n\t}\n\treturn {\n\t\tid:'WP-CUSTOM',\n\t\tvals:[\n\t\t\tgetPercentage(_data.status.running,_data.status),\n\t\t\tgetPercentage(_data.status.succeeded,_data.status),\n\t\t\tgetPercentage(_data.status.failed,_data.status)\n\t\t]\n\t}\n}"},A={id:"CLICKHOUSE-TEST-CUSTOM",title:"A Clickhouse Datasource Sample",tag:{name:"MiniSector"},service:{type:"clickhouse",path:"",method:"GET",payload:"{}",clickhouseSQL:"select count() as count,res.status from log where res.status>'0' group by res.status order by res.status",prometheusSQL:""},col:6,data:"res => {\n\tlet dv = [];\n\tres.map((item) => {\n\t\t\tdv.push({type:item[1],value:item[0],name:item[1]});\n\t});\n\treturn {\n\t\tcolors:['#8bd4a1','#fac858','#fb9690'],\n\t\tdv:dv\n\t}\n}"},g={id:"PROMETHEUS-TEST-CUSTOM",title:"A Prometheus Datasource Sample",tag:{name:"MiniArea"},service:{type:"prometheus",path:"",method:"GET",payload:"{}",clickhouseSQL:"",prometheusSQL:"sum(pipy_chunk_size)"},col:6,data:"res => {\n\tlet dv = [];\n\tif(res.data?.result){\n\t\tres.data.result.forEach((result,i) => {\n\t\t\tresult.values.forEach((value,j) => {\n\t\t\t\tif(value[1]){\n\t\t\t\t\tdv.push({\n\t\t\t\t\t\ttype:'item'+i,\n\t\t\t\t\t\tvalue:(value[1]*1).toFixed(2),\n\t\t\t\t\t\tdate:new Date(value[0]*1000).toISOString().split('.')[0].replace('T',' ')\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\treturn {\n\t\tid: 'Test-Prometheus-MiniArea',\n\t\tcolors: ['#8bd4a1', '#fb9690'],\n\t\theight: 240,\n\t\tpadding: [0, 0, 0, 0],\n\t\taxis: false,\n\t\tunit: 'unitge',\n\t\tshowy: false,\n\t\tdv\n\t}\n}"}},71900:function(t,a,e){e.d(a,{Z:function(){return r}});var d=e(66252),s=e(3577);const n={class:"head-info"};var o={name:"HeadInfo",props:["title","content"]};var r=(0,e(83744).Z)(o,[["render",function(t,a,e,o,r,i){return(0,d.wg)(),(0,d.iD)("div",n,[(0,d._)("span",null,(0,s.zw)(e.title),1),(0,d._)("p",null,[(0,d.Uk)((0,s.zw)(e.content),1),(0,d.WI)(t.$slots,"body",{},void 0,!0)])])}],["__scopeId","data-v-00006846"]])},10935:function(t,a,e){e.r(a),e.d(a,{default:function(){return S}});var d=e(66252);const s=(0,d._)("div",null,null,-1),n={class:"search-content"};e(57658);var o=e(61103),r=e(71900),i=e(47556),u=e(99684),l=e(89056),c=e(33907),h=e(3577);const m={class:"search-content"},p={class:"mb-3"},b={class:"content"};var T=e(69596),f={name:"DashboardListResults",i18n:e(89234),components:{CardList:T.Z,LayoutOutlined:l.Z},props:["dashboards","loading"],data(){return{key:"",projects:[],categray:[{value:!0,label:"All"},{value:!1,label:"Success"},{value:!1,label:"Pending"},{value:!1,label:"Error"}]}},computed:{...(0,c.rn)("setting",["layout","pageWidth"])},mounted(){},methods:{detail(t,a,e){this.$router.push({path:"/system/dashboard/detail/"+e.id})},remove(t,a,e){this.$gql.mutation(`deleteDashboard(id:${e.id}){data{id}}`).then((()=>{this.$message.success(this.$t("Deleted successfully"),3),this.search()}))},search(){this.$emit("search")}}},O=e(83744);var E=(0,O.Z)(f,[["render",function(t,a,e,s,n,o){const r=(0,d.up)("LayoutOutlined"),i=(0,d.up)("a-card-meta"),u=(0,d.up)("CardList");return(0,d.wg)(),(0,d.iD)("div",m,[(0,d.Wm)(u,{"result-empty":{status:404,title:t.$t("No data")},loading:e.loading,"data-source":e.dashboards||[],"hide-action-title":!0,type:"component",actions:[{icon:"EditOutlined",text:t.$t("edit"),call:o.detail,permission:["dashboard:update"]},{icon:"DeleteOutlined",text:t.$t("delete"),call:o.remove,hide:!0,permission:["dashboard:delete"]}]},{default:(0,d.w5)((({item:a})=>[(0,d.Wm)(i,null,{title:(0,d.w5)((()=>[(0,d._)("div",p,(0,h.zw)(a.name),1)])),avatar:(0,d.w5)((()=>[(0,d.Wm)(r,{class:"LayoutOutlined primary"})])),description:(0,d.w5)((()=>[])),_:2},1024),(0,d._)("div",b,[(0,d._)("div",null,[(0,d._)("p",null,(0,h.zw)(t.$t("Usage")),1),(0,d._)("p",null,(0,h.zw)(a.apply?a.apply:"-"),1)]),(0,d._)("div",null,[(0,d._)("p",null,(0,h.zw)(t.$t("Widgets")),1),(0,d._)("p",null,(0,h.zw)(a.widgets?a.widgets.length:0),1)])])])),_:1},8,["result-empty","loading","data-source","actions"])])}],["__scopeId","data-v-6d6b9132"]]),_={name:"DashboardList",i18n:e(89234),components:{PageLayout:o.Z,DashboardListResults:E,PlusCircleTwoTone:u.Z,LayoutOutlined:l.Z,HeadInfo:r.Z},data(){return{dashboards:[],loading:!0}},computed:{...(0,c.rn)("setting",["layout","pageWidth"])},mounted(){this.search()},methods:{add(){(0,i.DB)({name:"New Dashboard",widget:"",apply:""}).then((t=>{this.$router.push({path:"/system/dashboard/detail/"+t.dashboard.id})}))},search(){this.loading=!0,this.$gql.query("dashboards{data{id,attributes{name,apply,content,updatedAt}}}").then((t=>{this.dashboards=t.data,this.dashboards.forEach((t=>{t.widgets=[],t.content.widget&&(t.widgets=t.content.widget.replace(/^,/g,"").split(","))})),this.loading=!1}))}}};var S=(0,O.Z)(_,[["render",function(t,a,e,o,r,i){const u=(0,d.up)("PlusCircleTwoTone"),l=(0,d.up)("HeadInfo"),c=(0,d.up)("DashboardListResults"),h=((0,d.up)("LayoutOutlined"),(0,d.up)("PageLayout")),m=(0,d.Q2)("permission");return(0,d.wg)(),(0,d.j4)(h,{avatar:t.LayoutOutlined,title:t.$t("Custom Dashboards")},{headerContent:(0,d.w5)((()=>[s])),extra:(0,d.w5)((()=>[(0,d.wy)(((0,d.wg)(),(0,d.iD)("div",null,[(0,d.Wm)(l,{class:"split-right",title:t.$t("New Dashboard")},{body:(0,d.w5)((()=>[(0,d._)("div",null,[(0,d.Wm)(u,{onClick:i.add,class:"font-primary icon-menu rotate-icon"},null,8,["onClick"])])])),_:1},8,["title"])])),[[m,["dashboard:create"]]])])),default:(0,d.w5)((()=>[(0,d._)("div",n,[(0,d.Wm)(c,{ref:"result",loading:r.loading,dashboards:r.dashboards,onSearch:i.search},null,8,["loading","dashboards","onSearch"])]),(0,d.kq)("",!0)])),_:1},8,["avatar","title"])}]])}}]);