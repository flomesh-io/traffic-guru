"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[6104],{71900:function(t,e,a){a.d(e,{Z:function(){return s}});var i=a(66252),n=a(3577),l={class:"head-info"};var o={name:"HeadInfo",props:["title","content"]};var s=(0,a(83744).Z)(o,[["render",function(t,e,a,o,s,r){return(0,i.wg)(),(0,i.iD)("div",l,[(0,i._)("span",null,(0,n.zw)(a.title),1),(0,i._)("p",null,[(0,i.Uk)((0,n.zw)(a.content),1),(0,i.WI)(t.$slots,"body",{},void 0,!0)])])}],["__scopeId","data-v-00006846"]])},6104:function(t,e,a){a.r(e),a.d(e,{default:function(){return z}});a(74916),a(64765),a(68309);var i=a(66252),n=a(3577),l={class:"search-input"},o={class:"content flex"},s={class:"flex-item"},r={class:"form-row"},u={class:"label"},c={class:"content"},d={class:"width-200"},p={class:"search-content"},h={class:"mb-3"},f={class:"card-avatar icon","aria-hidden":"true"},v=["xlink:href"],y={class:"meta-content"};var g=a(95082),m=(a(57658),a(57327),a(41539),a(92222),a(54747),a(71900)),w=a(99684),_=a(33907),b=a(69596),k=a(61103),$={name:"PipyList",i18n:a(89234),components:{PageLayout:k.Z,CardList:b.Z,PlusCircleTwoTone:w.Z,HeadInfo:m.Z},props:["hideHead"],data:function(){return{pageSize:12,pageNo:1,total:0,key:"",list:[],icons:{pipy:{icon:"icon-pipy",label:"API"},pipy4lb:{icon:"icon-pipy",label:"4LB"},sidecar:{icon:"icon-car",label:"Sidecar"}},viewtypevalue:0,viewtype:[{value:0,filter:{in:["pipy","pipy4lb","sidecar"]},label:"All"},{value:1,filter:{eq:"pipy"},label:"API"},{value:2,filter:{eq:"pipy4lb"},label:"4LB"},{value:3,filter:{eq:"sidecar"},label:"Sidecar"}],loading:!0}},computed:(0,g.Z)((0,g.Z)({},(0,_.rn)("setting",["layout","pageWidth"])),{},{start:function(){return(this.pageNo-1)*this.pageSize}}),mounted:function(){this.search()},methods:{addpipy:function(){this.$router.push({path:"/ops-center/pipy/create"})},detail:function(t,e,a){this.$router.push({path:"/ops-center/pipy/detail/"+a.id})},forcepush:function(t,e,a){var i=this;this.$gql.mutation("updatePipy(id: ".concat(a.id,")")).then((function(){i.$message.success(i.$t("Sync successfully"),3)}))},remove:function(t,e,a){var i=this;this.$gql.mutation("deleteFleet(id:".concat(a.id,"){data{id}}")).then((function(){i.$message.success(i.$t("Deleted successfully"),3),i.search()}))},search:function(t){var e=this;this.pageNo=t||1,this.loading=!0;var a={name:{contains:this.key},type:this.viewtype[this.viewtypevalue].filter};this.$gql.query("fleets(filters: $filters, pagination: {start: ".concat(this.start,", limit: ").concat(this.pageSize,"}){\n\t\t\t\t\t\tdata{id,attributes{name,type,content,apply,organizations{data{id,attributes{name}}},template{data{id,attributes{name}}}, status}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}"),{filters:a},{filters:"FleetFiltersInput"}).then((function(t){e.list=[],e.total=t.pagination.total,e.loading=!1,t.data&&t.data.forEach((function(t){t.template&&t.template.id&&(t.template=t.template.id),"pipy4lb"!=t.type||t.content.healthcheck||(t.content.healthcheck={interval:"3s",connectTimeout:"1s",readTimeout:"1s",host:"localhost",port:8888,failures:3});var a=t.organizations;t.organizations=[],a&&a.forEach((function(e){t.organizations.push(e.id)})),e.list.push(t)}))}))},select:function(t,e,a){this.$emit("selectPolicy",a)},getData:function(){}}};var z=(0,a(83744).Z)($,[["render",function(t,e,a,g,m,w){var _=(0,i.up)("a-input-search"),b=(0,i.up)("a-radio-button"),k=(0,i.up)("a-radio-group"),$=(0,i.up)("a-form-item"),z=(0,i.up)("a-form"),C=(0,i.up)("PlusCircleTwoTone"),W=(0,i.up)("HeadInfo"),P=(0,i.up)("a-card"),q=(0,i.up)("a-badge"),I=(0,i.up)("a-card-meta"),L=(0,i.up)("CardList"),Z=(0,i.up)("a-pagination"),H=(0,i.up)("PageLayout"),S=(0,i.Q2)("permission");return(0,i.wg)(),(0,i.j4)(H,{title:t.$t("Pipy"),"hide-head":a.hideHead,style:(0,n.j5)(a.hideHead?"padding-top:0 ;":"")},{headerContent:(0,i.w5)((function(){return[(0,i._)("div",{class:(0,n.C_)(["search-head",t.layout,t.pageWidth])},[(0,i._)("div",l,[(0,i.Wm)(_,{value:m.key,"onUpdate:value":e[0]||(e[0]=function(t){return m.key=t}),class:"search-ipt",onSearch:e[1]||(e[1]=function(t){return w.search()}),placeholder:t.$t("Please input")+"...",size:"large"},null,8,["value","placeholder"])]),(0,i.Wm)(P,{bordered:!1,class:"search-form"},{default:(0,i.w5)((function(){return[(0,i._)("div",o,[(0,i._)("div",s,[(0,i.Wm)(z,null,{default:(0,i.w5)((function(){return[(0,i._)("div",r,[(0,i._)("div",u,[(0,i._)("span",null,(0,n.zw)(t.$t("Type")),1)]),(0,i._)("div",c,[(0,i.Wm)($,null,{default:(0,i.w5)((function(){return[(0,i.Wm)(k,{size:"small",onChange:e[2]||(e[2]=function(t){return w.search(1)}),value:m.viewtypevalue,"onUpdate:value":e[3]||(e[3]=function(t){return m.viewtypevalue=t}),"button-style":"solid"},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(m.viewtype,(function(e,a){return(0,i.wg)(),(0,i.j4)(b,{value:e.value,key:a},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,n.zw)(t.$t(e.label)),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["value"])]})),_:1})])])]})),_:1})]),(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",d,[(0,i.Wm)(W,{class:"pd-0 split-right",title:t.$t("create")+" Pipy"},{body:(0,i.w5)((function(){return[(0,i._)("div",null,[(0,i.Wm)(C,{onClick:w.addpipy,class:"font-primary icon-menu rotate-icon"},null,8,["onClick"])])]})),_:1},8,["title"])])),[[S,["fleet:create"]]])])]})),_:1})],2)]})),default:(0,i.w5)((function(){return[(0,i._)("div",p,[(0,i.Wm)(L,{"result-empty":{status:404,title:t.$t("No data")},loading:m.loading,"data-source":m.list,"hide-action-title":!a.hideHead,type:"component",actions:[{icon:"EditOutlined",text:t.$t("edit"),call:w.detail},{icon:"DeleteOutlined",text:t.$t("delete"),call:w.remove,hide:!0}]},{default:(0,i.w5)((function(e){var a=e.item;return[(0,i.Wm)(I,null,{title:(0,i.w5)((function(){var t,e;return[(0,i._)("div",h,["running"==a.status&&"pipy"==(null===(t=a.type)||void 0===t?void 0:t.toLowerCase())?((0,i.wg)(),(0,i.j4)(q,{key:0,status:"processing"})):(0,i.kq)("",!0),"running"!=a.status&&"pipy"==(null===(e=a.type)||void 0===e?void 0:e.toLowerCase())?((0,i.wg)(),(0,i.j4)(q,{key:1,status:"processing",color:"red"})):(0,i.kq)("",!0),(0,i.Uk)((0,n.zw)(a.name),1)])]})),avatar:(0,i.w5)((function(){return[((0,i.wg)(),(0,i.iD)("svg",f,[(0,i._)("use",{"xlink:href":"#"+m.icons[a.type].icon},null,8,v)]))]})),description:(0,i.w5)((function(){return[(0,i._)("div",y,(0,n.zw)(t.$t("Type"))+"ï¼š"+(0,n.zw)(m.icons[a.type].label),1)]})),_:2},1024)]})),_:1},8,["result-empty","loading","data-source","hide-action-title","actions"]),(0,i.Wm)(Z,{onChange:w.search,current:m.pageNo,"onUpdate:current":e[4]||(e[4]=function(t){return m.pageNo=t}),total:m.total,"page-size":m.pageSize,"show-less-items":""},null,8,["onChange","current","total","page-size"])])]})),_:1},8,["title","hide-head","style"])}],["__scopeId","data-v-3d7ffb3c"]])}}]);