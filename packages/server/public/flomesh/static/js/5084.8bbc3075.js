"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[5084],{60389:function(t,e,i){i.d(e,{Z:function(){return v}});var a=i(66252),n=i(3577);const l={key:0,href:"#"},s=["onClick"],d=["onClick"],o=["onClick"],c=["onClick"],u=["onClick"],r={key:0},h={class:"list-content"},m={class:"list-content-item"};i(57658);var p=i(21936),g=i(2692),w=i(99684),k=i(26129),f={name:"CheckpointList",i18n:i(89234),components:{MoreOutlined:g.Z,PlusCircleTwoTone:w.Z,WifiOutlined:k.Z,JsonEditor:p.Z},props:["modeId","modeName","modeType"],data(){return{visible:!1,key:"",log:"{}",pageSize:10,pageNo:1,total:0,loading:!0,list:[],dialTestings:[]}},computed:{start(){return(this.pageNo-1)*this.pageSize}},created(){this.search()},methods:{viewLog(){this.visible=!0},remove(t){this.$gql.mutation(`deleteDialTesting(id:${t}){data{id}}`).then((()=>{this.$message.success(this.$t("Deleted successfully"),3),this.search()}))},newLb(){this.$router.push({path:"/inspector/checkpoint/create"})},hcdetail(t){this.$router.push({path:"/inspector/healthcheck/detail/"+t})},detail(t){this.$router.push({path:"/inspector/checkpoint/detail/"+t})},search(t,e){this.modeId&&this.$gql.query("dialTestings{data{id,attributes{name,content, services{data{id}}}}}").then((t=>{this.dialTestings=t.data.filter((t=>!t.services.find((t=>this.modeId==t.id))))})),t&&(this.pageNo=t,this.pageSize=e),this.loading=!0;let i={start:this.start,limit:this.pageSize},a={};a.name={contains:this.key},this.modeId&&(a.services={id:{eq:this.modeId}}),this.$gql.query("dialTestings(filters: $filters, pagination: $pagination){\n\t\t\t\t\t\tdata{\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tattributes{\n\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\thealthcheck{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\tfleet{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\t\tcreatedAt\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}",{filters:a,pagination:i},{filters:"DialTestingFiltersInput",pagination:"PaginationArg"}).then((t=>{this.list=t.data,this.$emit("getDialTestings",t.data),this.total=t.pagination.total,this.loading=!1}))},addBind(){if(!this.addBindVal?.length)return;this.addBindVal[0].content||(this.addBindVal[0].content={}),this.addBindVal[0].content.targets||(this.addBindVal[0].content.targets=[]),this.addBindVal[0].content.targets.push({id:this.modeId,type:this.modeType,name:this.modeName});let t=this.addBindVal[0].content.targets.filter((t=>t.type==this.modeType));t=t.map((t=>Number(t.id)));for(let e of this.addBindVal)this.$gql.mutation(`updateDialTesting(id:${e.id}, data: $data){data{id}}`,{data:{content:e.content,services:t}},{data:"DialTestingInput!"}).then((()=>{this.addBindVal=[],this.$message.success(this.$t("Bind successfully"),3),this.search()}))},unbind(t){t.content.targets.some(((e,i)=>{e.id===this.modeId&&t.content.targets.splice(i,1)}));let e=t.content.targets.filter((t=>"service"==t.type));e=e.map((t=>Number(t.id))),this.$gql.mutation(`updateDialTesting(id:${t.id}, data: $data){data{id}}`,{data:{content:t.content,services:e}},{data:"DialTestingInput"}).then((()=>{this.$message.success(this.$t("Unbind successfully"),3),this.search()}))},onClose(){this.visible=!1}}};var v=(0,i(83744).Z)(f,[["render",function(t,e,i,p,g,w){const k=(0,a.up)("a-input-search"),f=(0,a.up)("a-divider"),v=(0,a.up)("PlusCircleTwoTone"),$=(0,a.up)("a-button"),_=(0,a.up)("a-select-option"),C=(0,a.up)("a-select"),y=(0,a.up)("a-popconfirm"),b=(0,a.up)("WifiOutlined"),T=(0,a.up)("a-list-item-meta"),z=(0,a.up)("a-menu-item"),N=(0,a.up)("a-menu"),W=(0,a.up)("MoreOutlined"),D=(0,a.up)("a-dropdown"),q=(0,a.up)("a-tag"),B=(0,a.up)("a-list-item"),I=(0,a.up)("a-list"),V=(0,a.up)("a-card"),S=(0,a.up)("JsonEditor"),j=(0,a.up)("a-drawer");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(V,{bordered:!1,title:i.modeName?t.$t("Bind Dial Test"):t.$t("Dial Test"),loading:g.loading},{extra:(0,a.w5)((()=>[(0,a._)("div",null,[i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(k,{key:0,value:g.key,"onUpdate:value":e[0]||(e[0]=t=>g.key=t),onSearch:e[1]||(e[1]=t=>w.search()),class:"right-search-input",placeholder:t.$t("search")},null,8,["value","placeholder"])),i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(f,{key:1,type:"vertical"})),i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)($,{key:2,type:"link",shape:"circle",onClick:w.newLb},{icon:(0,a.w5)((()=>[(0,a.Wm)(v,{class:"PlusCircle icon-menu-sm rotate-icon"})])),_:1},8,["onClick"])),(0,a.Wm)(y,{"ok-text":t.$t("Add Bind"),onConfirm:w.addBind},{title:(0,a.w5)((()=>[(0,a._)("p",null,(0,n.zw)(t.$t("Please select dial test")),1),(0,a.Wm)(C,{class:"width-220",mode:"multiple",value:t.addBindVal,"onUpdate:value":e[2]||(e[2]=e=>t.addBindVal=e)},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(g.dialTestings,((t,e)=>((0,a.wg)(),(0,a.j4)(_,{value:t,key:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(t.name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),default:(0,a.w5)((()=>[i.modeName?((0,a.wg)(),(0,a.iD)("a",l,[(0,a.Wm)(v,{class:"PlusCircle"})])):(0,a.kq)("",!0)])),_:1},8,["ok-text","onConfirm"])])])),default:(0,a.w5)((()=>[(0,a.Wm)(I,{size:"large",pagination:!i.modeName&&{showSizeChanger:!0,showQuickJumper:!1,onShowSizeChange:w.search,onChange:w.search,current:g.pageNo,pageSize:g.pageSize,showTotal:(e,i)=>`${t.$t("Total")} ${e}`,total:g.total}},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(g.list,((e,l)=>((0,a.wg)(),(0,a.j4)(B,{key:l},{actions:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a.Wm)(D,null,{overlay:(0,a.w5)((()=>[(0,a.Wm)(N,null,{default:(0,a.w5)((()=>[(0,a.Wm)(z,null,{default:(0,a.w5)((()=>[(0,a._)("a",{onClick:t=>w.viewLog(e.id)},(0,n.zw)(t.$t("log")),9,o)])),_:2},1024),(0,a.Wm)(z,null,{default:(0,a.w5)((()=>[i.modeName?((0,a.wg)(),(0,a.iD)("a",{key:0,onClick:t=>w.unbind(e)},(0,n.zw)(t.$t("Unbind")),9,c)):(0,a.kq)("",!0)])),_:2},1024),i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(z,{key:0},{default:(0,a.w5)((()=>[(0,a._)("a",{onClick:t=>w.detail(e.id)},(0,n.zw)(t.$t("edit")),9,u)])),_:2},1024)),(0,a.Wm)(z,null,{default:(0,a.w5)((()=>[(0,a.Wm)(y,{placement:"topLeft","ok-text":t.$t("Yes"),"cancel-text":t.$t("No"),onConfirm:t=>w.remove(e.id)},{title:(0,a.w5)((()=>[(0,a._)("p",null,(0,n.zw)(t.$t("Tip")),1),(0,a._)("p",null,(0,n.zw)(t.$t("Are you sure to delete this?")),1)])),default:(0,a.w5)((()=>[i.modeName?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("a",r,(0,n.zw)(t.$t("delete")),1))])),_:2},1032,["ok-text","cancel-text","onConfirm"])])),_:2},1024)])),_:2},1024)])),default:(0,a.w5)((()=>[(0,a._)("a",null,[(0,a.Wm)(W)])])),_:2},1024)])])),default:(0,a.w5)((()=>[(0,a.Wm)(T,null,{avatar:(0,a.w5)((()=>[(0,a.Wm)(b,{class:"list-item-avatar"})])),title:(0,a.w5)((()=>[(0,a._)("a",{onClick:t=>w.detail(e.id)},(0,n.zw)(e.name?e.name:"Unnamed"),9,s)])),description:(0,a.w5)((()=>[(0,a._)("span",null,[(0,a._)("a",{onClick:t=>w.hcdetail(e.healthcheck.id)},(0,n.zw)(t.$t("Check configuration"))+"-"+(0,n.zw)(e.healthcheck.name),9,d)])])),_:2},1024),(0,a._)("div",h,[(0,a._)("div",m,[(0,a._)("span",null,(0,n.zw)(t.$t("Checkpoint Target")),1),(0,a._)("p",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.content.targets,((t,e)=>((0,a.wg)(),(0,a.j4)(q,{key:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(t.type)+":"+(0,n.zw)(t.name),1)])),_:2},1024)))),128))])])])])),_:2},1024)))),128))])),_:1},8,["pagination"])])),_:1},8,["title","loading"]),g.visible?((0,a.wg)(),(0,a.j4)(j,{key:0,"get-container":!1,title:t.$t("log"),placement:"bottom",height:"600",closable:!1,visible:g.visible,onClose:w.onClose},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{"is-readonly":!0,value:g.log},null,8,["value"])])),_:1},8,["title","visible","onClose"])):(0,a.kq)("",!0)])}],["__scopeId","data-v-43a393ce"]])},35084:function(t,e,i){i.r(e),i.d(e,{default:function(){return l}});var a=i(66252);var n={name:"CheckpointList",components:{Checkpoints:i(60389).Z}};var l=(0,i(83744).Z)(n,[["render",function(t,e,i,n,l,s){const d=(0,a.up)("Checkpoints");return(0,a.wg)(),(0,a.j4)(d)}]])}}]);