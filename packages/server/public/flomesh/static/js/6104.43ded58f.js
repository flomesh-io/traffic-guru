"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[6104],{71900:function(e,t,a){a.d(t,{Z:function(){return o}});var i=a(66252),l=a(3577);const s={class:"head-info"};var n={name:"HeadInfo",props:["title","content"]};var o=(0,a(83744).Z)(n,[["render",function(e,t,a,n,o,r){return(0,i.wg)(),(0,i.iD)("div",s,[(0,i._)("span",null,(0,l.zw)(a.title),1),(0,i._)("p",null,[(0,i.Uk)((0,l.zw)(a.content),1),(0,i.WI)(e.$slots,"body",{},void 0,!0)])])}],["__scopeId","data-v-00006846"]])},6104:function(e,t,a){a.r(t),a.d(t,{default:function(){return k}});var i=a(66252),l=a(3577);const s={class:"search-input"},n={class:"content flex"},o={class:"flex-item"},r={class:"form-row"},p={class:"label"},d={class:"content"},c={class:"width-200"},u={class:"search-content"},h={class:"mb-3"},y={class:"card-avatar icon","aria-hidden":"true"},g=["xlink:href"],m={class:"meta-content"};a(57658);var v=a(71900),f=a(99684),w=a(33907),_=a(69596),b=a(61103),$={name:"PipyList",i18n:a(89234),components:{PageLayout:b.Z,CardList:_.Z,PlusCircleTwoTone:f.Z,HeadInfo:v.Z},props:["hideHead"],data(){return{pageSize:12,pageNo:1,total:0,key:"",list:[],icons:{pipy:{icon:"icon-pipy",label:"API"},pipy4lb:{icon:"icon-pipy",label:"4LB"},sidecar:{icon:"icon-car",label:"Sidecar"}},viewtypevalue:0,viewtype:[{value:0,filter:{in:["pipy","pipy4lb","sidecar"]},label:"All"},{value:1,filter:{eq:"pipy"},label:"API"},{value:2,filter:{eq:"pipy4lb"},label:"4LB"},{value:3,filter:{eq:"sidecar"},label:"Sidecar"}],loading:!0}},computed:{...(0,w.rn)("setting",["layout","pageWidth"]),start(){return(this.pageNo-1)*this.pageSize}},mounted(){this.search()},methods:{addpipy(){this.$router.push({path:"/ops-center/pipy/create"})},detail(e,t,a){this.$router.push({path:"/ops-center/pipy/detail/"+a.id})},forcepush(e,t,a){this.$gql.mutation(`updatePipy(id: ${a.id})`).then((()=>{this.$message.success(this.$t("Sync successfully"),3)}))},remove(e,t,a){this.$gql.mutation(`deleteFleet(id:${a.id}){data{id}}`).then((()=>{this.$message.success(this.$t("Deleted successfully"),3),this.search()}))},search(e){this.pageNo=e||1,this.loading=!0;let t={name:{contains:this.key},type:this.viewtype[this.viewtypevalue].filter};this.$gql.query(`fleets(filters: $filters, pagination: {start: ${this.start}, limit: ${this.pageSize}}){\n\t\t\t\t\t\tdata{id,attributes{name,type,content,apply,organizations{data{id,attributes{name}}},template{data{id,attributes{name}}}, status}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}`,{filters:t},{filters:"FleetFiltersInput"}).then((e=>{this.list=[],this.total=e.pagination.total,this.loading=!1,e.data&&e.data.forEach((e=>{e.template&&e.template.id&&(e.template=e.template.id),"pipy4lb"!=e.type||e.content.healthcheck||(e.content.healthcheck={interval:"3s",connectTimeout:"1s",readTimeout:"1s",host:"localhost",port:8888,failures:3});let t=e.organizations;e.organizations=[],t&&t.forEach((t=>{e.organizations.push(t.id)})),this.list.push(e)}))}))},select(e,t,a){this.$emit("selectPolicy",a)},getData(){}}};var k=(0,a(83744).Z)($,[["render",function(e,t,a,v,f,w){const _=(0,i.up)("a-input-search"),b=(0,i.up)("a-radio-button"),$=(0,i.up)("a-radio-group"),k=(0,i.up)("a-form-item"),z=(0,i.up)("a-form"),C=(0,i.up)("PlusCircleTwoTone"),W=(0,i.up)("HeadInfo"),P=(0,i.up)("a-card"),q=(0,i.up)("a-badge"),I=(0,i.up)("a-card-meta"),L=(0,i.up)("CardList"),H=(0,i.up)("a-pagination"),S=(0,i.up)("PageLayout"),T=(0,i.Q2)("permission");return(0,i.wg)(),(0,i.j4)(S,{title:e.$t("Pipy"),"hide-head":a.hideHead,style:(0,l.j5)(a.hideHead?"padding-top:0 ;":"")},{headerContent:(0,i.w5)((()=>[(0,i._)("div",{class:(0,l.C_)(["search-head",e.layout,e.pageWidth])},[(0,i._)("div",s,[(0,i.Wm)(_,{value:f.key,"onUpdate:value":t[0]||(t[0]=e=>f.key=e),class:"search-ipt",onSearch:t[1]||(t[1]=e=>w.search()),placeholder:e.$t("Please input")+"...",size:"large"},null,8,["value","placeholder"])]),(0,i.Wm)(P,{bordered:!1,class:"search-form"},{default:(0,i.w5)((()=>[(0,i._)("div",n,[(0,i._)("div",o,[(0,i.Wm)(z,null,{default:(0,i.w5)((()=>[(0,i._)("div",r,[(0,i._)("div",p,[(0,i._)("span",null,(0,l.zw)(e.$t("Type")),1)]),(0,i._)("div",d,[(0,i.Wm)(k,null,{default:(0,i.w5)((()=>[(0,i.Wm)($,{size:"small",onChange:t[2]||(t[2]=e=>w.search(1)),value:f.viewtypevalue,"onUpdate:value":t[3]||(t[3]=e=>f.viewtypevalue=e),"button-style":"solid"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(f.viewtype,((t,a)=>((0,i.wg)(),(0,i.j4)(b,{value:t.value,key:a},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.$t(t.label)),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1})])])])),_:1})]),(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",c,[(0,i.Wm)(W,{class:"pd-0 split-right",title:e.$t("create")+" Pipy"},{body:(0,i.w5)((()=>[(0,i._)("div",null,[(0,i.Wm)(C,{onClick:w.addpipy,class:"font-primary icon-menu rotate-icon"},null,8,["onClick"])])])),_:1},8,["title"])])),[[T,["fleet:create"]]])])])),_:1})],2)])),default:(0,i.w5)((()=>[(0,i._)("div",u,[(0,i.Wm)(L,{"result-empty":{status:404,title:e.$t("No data")},loading:f.loading,"data-source":f.list,"hide-action-title":!a.hideHead,type:"component",actions:[{icon:"EditOutlined",text:e.$t("edit"),call:w.detail},{icon:"DeleteOutlined",text:e.$t("delete"),call:w.remove,hide:!0}]},{default:(0,i.w5)((({item:t})=>[(0,i.Wm)(I,null,{title:(0,i.w5)((()=>[(0,i._)("div",h,["running"==t.status&&"pipy"==t.type?.toLowerCase()?((0,i.wg)(),(0,i.j4)(q,{key:0,status:"processing"})):(0,i.kq)("",!0),"running"!=t.status&&"pipy"==t.type?.toLowerCase()?((0,i.wg)(),(0,i.j4)(q,{key:1,status:"processing",color:"red"})):(0,i.kq)("",!0),(0,i.Uk)((0,l.zw)(t.name),1)])])),avatar:(0,i.w5)((()=>[((0,i.wg)(),(0,i.iD)("svg",y,[(0,i._)("use",{"xlink:href":"#"+f.icons[t.type].icon},null,8,g)]))])),description:(0,i.w5)((()=>[(0,i._)("div",m,(0,l.zw)(e.$t("Type"))+"ï¼š"+(0,l.zw)(f.icons[t.type].label),1)])),_:2},1024)])),_:1},8,["result-empty","loading","data-source","hide-action-title","actions"]),(0,i.Wm)(H,{onChange:w.search,current:f.pageNo,"onUpdate:current":t[4]||(t[4]=e=>f.pageNo=e),total:f.total,"page-size":f.pageSize,"show-less-items":""},null,8,["onChange","current","total","page-size"])])])),_:1},8,["title","hide-head","style"])}],["__scopeId","data-v-3d7ffb3c"]])}}]);