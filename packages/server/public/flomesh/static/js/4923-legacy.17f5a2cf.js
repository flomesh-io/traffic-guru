(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[4923],{27780:function(t,e,n){"use strict";n.d(e,{Z:function(){return u}});var i=n(66252),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M709.6 210l.4-.2h.2L512 96 313.9 209.8h-.2l.7.3L151.5 304v416L512 928l360.5-208V304l-162.9-94zM482.7 843.6L339.6 761V621.4L210 547.8V372.9l272.7 157.3v313.4zM238.2 321.5l134.7-77.8 138.9 79.7 139.1-79.9 135.2 78-273.9 158-274-158zM814 548.3l-128.8 73.1v139.1l-143.9 83V530.4L814 373.1v175.2z"}}]},name:"code-sandbox",theme:"outlined"},l=n(33058);function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?Object(arguments[e]):{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),i.forEach((function(e){r(t,e,n[e])}))}return t}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=function(t,e){var n=o({},t,e.attrs);return(0,i.Wm)(l.Z,o({},n,{icon:a}),null)};s.displayName="CodeSandboxOutlined",s.inheritAttrs=!1;var u=s},74353:function(t,e,n){"use strict";n.d(e,{Z:function(){return u}});var i=n(66252),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},l=n(33058);function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?Object(arguments[e]):{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),i.forEach((function(e){r(t,e,n[e])}))}return t}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=function(t,e){var n=o({},t,e.attrs);return(0,i.Wm)(l.Z,o({},n,{icon:a}),null)};s.displayName="StopOutlined",s.inheritAttrs=!1;var u=s},30541:function(t,e,n){"use strict";var i=n(82109),a=n(47908),l=n(26244),o=n(83658),r=n(85117),s=n(7207),u=1!==[].unshift(0),c=!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}();i({target:"Array",proto:!0,arity:1,forced:u||c},{unshift:function(t){var e=a(this),n=l(e),i=arguments.length;if(i){s(n+i);for(var u=n;u--;){var c=u+i;u in e?e[c]=e[u]:r(e,c)}for(var d=0;d<i;d++)e[d]=arguments[d]}return o(e,n+i)}})},79797:function(t,e,n){!function(){"use strict";var e=n(17536).typeOf;t.exports.stringify=function(t){var n,i="";return"---"+(n={undefined:function(){return"null"},null:function(){return"null"},number:function(t){return t},boolean:function(t){return t?"true":"false"},string:function(t){return JSON.stringify(t)},array:function(t){var a="";return 0===t.length?a+="[]":(i=i.replace(/$/,"  "),t.forEach((function(t){var l=n[e(t)];if(!l)throw new Error("what the crap: "+e(t));a+="\n"+i+"- "+l(t)})),i=i.replace(/  /,""),a)},object:function(t){var a="";return 0===Object.keys(t).length?a+="{}":(i=i.replace(/$/,"  "),Object.keys(t).forEach((function(l){var o=t[l],r=n[e(o)];if(void 0!==o){if(!r)throw new Error("what the crap: "+e(o));a+="\n"+i+l+": "+r(o)}})),i=i.replace(/  /,""),a)},function:function(){return"[object Function]"}})[e(t)](t)+"\n"}}()},17536:function(t){!function(){"use strict";var e,n,i=Function("return this")(),a="Boolean Number String Function Array Date RegExp Object".split(" "),l={};for(e in a)a.hasOwnProperty(e)&&(n=a[e],l["[object "+n+"]"]=n.toLowerCase());function o(t){return null==t?String(t):l[Object.prototype.toString.call(t)]||"object"}function r(t){var e,n;if("object"===o(t))for(e in t)if(void 0!==(n=t[e])&&"function"!==o(n))return!1;return!0}String.prototype.entityify||(String.prototype.entityify=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}),String.prototype.quote||(String.prototype.quote=function(){var t,e,n=this.length,i='"';for(e=0;e<n;e+=1)if((t=this.charAt(e))>=" ")"\\"!==t&&'"'!==t||(i+="\\"),i+=t;else switch(t){case"\b":i+="\\b";break;case"\f":i+="\\f";break;case"\n":i+="\\n";break;case"\r":i+="\\r";break;case"\t":i+="\\t";break;default:t=t.charCodeAt(),i+="\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16)}return i+'"'}),String.prototype.supplant||(String.prototype.supplant=function(t){return this.replace(/{([^{}]*)}/g,(function(e,n){var i=t[n];return"string"==typeof i||"number"==typeof i?i:e}))}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s*(\S*(?:\s+\S+)*)\s*$/,"$1")}),t.exports={typeOf:o,isEmpty:r},i.typeOf=i.typeOf||o,i.isEmpty=i.isEmpty||r}()},44107:function(t,e,n){"use strict";n.d(e,{Z:function(){return d}});var i=n(66252),a=n(3577);var l=n(3336),o=(n(38862),n(41539),n(21936)),r=n(8333),s=n(79797),u=n(93320),c={name:"Json2YamlCard",components:{JsonEditor:o.Z,YamlEditor:r.Z},props:["jsonVal","isCreate","height","isReadonly","url","isPop"],i18n:n(89234),data:function(){return{configTab:[{key:"YAML",tab:"YAML"},{key:"JSON",tab:"JSON"}],configKey:"YAML",json:"{}",yaml:""}},watch:{json:function(t,e){t!=e&&this.jsonInput(t)},yaml:function(t,e){t!=e&&this.yamlInput(t)},jsonVal:{handler:function(t,e){if("{}"!=t&&""!=t||(t='{"key":"value"}'),t!=e){var n=JSON.parse(t);"object"==(0,l.Z)(n)&&(this.json=t)}},immediate:!0}},created:function(){},mounted:function(){this.init()},methods:{onTabChange:function(t,e){this[e]=t},jsonInput:function(t){try{var e=JSON.parse(t);"object"==(0,l.Z)(e)&&(this.yaml=this.convertToYaml(t),this.$emit("update:jsonVal",this.json),this.$emit("change",this.json))}catch(t){}},yamlInput:function(t){var e=u.load(t),n=JSON.stringify(e,null,"  "),i=JSON.parse(n);"object"==(0,l.Z)(i)&&(this.$emit("update:jsonVal",n),this.$emit("change",n))},getDefaultYamlConfig:function(){var t=this;if(!this.url)return this.yaml=this.convertToYaml(this.jsonVal),void this.yamlInput(this.yaml);fetch(this.url).then((function(t){return t.text()})).then((function(e){t.url.indexOf(".yaml");var n=u.load(e),i=JSON.stringify(n,null,"  "),a=JSON.parse(i);a.spec&&a.spec.namespace&&(a.spec.namespace="_all"==localStorage.getItem("NAMESPACE")?"default":localStorage.getItem("NAMESPACE"));var l=JSON.stringify(a);t.yaml=t.convertToYaml(l),setTimeout((function(){t.yamlInput(t.yaml)}),2e3)})).catch((function(){}))},convertToYaml:function(t){if(""==t)return"";var e=JSON.parse(t);return s.stringify(e)},init:function(){this.isCreate?this.getDefaultYamlConfig():(this.yaml=this.convertToYaml(this.jsonVal),this.yamlInput(this.yaml))}}};var d=(0,n(83744).Z)(c,[["render",function(t,e,n,l,o,r){var s=(0,i.up)("YamlEditor"),u=(0,i.up)("JsonEditor"),c=(0,i.up)("a-button"),d=(0,i.up)("a-card");return(0,i.wg)(),(0,i.j4)(d,{class:(0,a.C_)(["card nopd",n.isPop?"isPop":""]),"tab-list":o.configTab,"active-tab-key":o.configKey,onTabChange:e[2]||(e[2]=function(t){return r.onTabChange(t,"configKey")}),bordered:!1},{tabBarExtraContent:(0,i.w5)((function(){return[n.url?((0,i.wg)(),(0,i.j4)(c,{key:0,type:"dashed",onClick:r.getDefaultYamlConfig},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("reset")),1)]})),_:1},8,["onClick"])):(0,i.kq)("",!0)]})),default:(0,i.w5)((function(){return["YAML"==o.configKey?((0,i.wg)(),(0,i.j4)(s,{key:0,height:n.height,"is-readonly":n.isReadonly,value:o.yaml,"onUpdate:value":e[0]||(e[0]=function(t){return o.yaml=t})},null,8,["height","is-readonly","value"])):(0,i.kq)("",!0),"JSON"==o.configKey?((0,i.wg)(),(0,i.j4)(u,{key:1,height:n.height,"is-readonly":n.isReadonly,"is-json":!0,noreset:!n.isReadonly,value:o.json,"onUpdate:value":e[1]||(e[1]=function(t){return o.json=t})},null,8,["height","is-readonly","noreset","value"])):(0,i.kq)("",!0)]})),_:1},8,["class","tab-list","active-tab-key"])}]])},990:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var i=n(66252),a={class:"DashboardCore"};var l=n(56912),o={name:"Dashboard",i18n:n(89234),components:{DashboardCore:l.Z},props:["pageId","prometheus","apply","params","hideAdd","init","defaultWidget"],data:function(){return{prometheusVal:null}},computed:{},watch:{prometheus:function(t){this.prometheusVal=t}},created:function(){},mounted:function(){this.prometheusVal=this.prometheus},methods:{prometheusChange:function(){this.$emit("update:prometheus",this.prometheusVal),this.$emit("prometheusChange",this.prometheusVal)}}};var r=(0,n(83744).Z)(o,[["render",function(t,e,n,l,o,r){var s=(0,i.up)("DashboardCore");return(0,i.wg)(),(0,i.iD)("div",a,[(0,i.Wm)(s,{"hide-add":n.hideAdd,init:n.init,"hide-head":!0,"page-id":n.pageId,params:n.params,kind:n.apply,prometheus:o.prometheusVal,"onUpdate:prometheus":e[0]||(e[0]=function(t){return o.prometheusVal=t}),onPrometheusChange:r.prometheusChange,apply:n.apply+"."+n.pageId,embed:!0,"default-widget":n.defaultWidget},null,8,["hide-add","init","page-id","params","kind","prometheus","onPrometheusChange","apply","default-widget"])])}]])},92911:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return It}});n(68309),n(47941),n(74916),n(15306),n(92222),n(26699),n(32023);var i=n(66252),a=n(3577),l=n(49963),o=function(t){return(0,i.dD)("data-v-769f7a1a"),t=t(),(0,i.Cn)(),t},r={class:"template-div"},s={key:0},u={key:1,class:"gray"},c={key:0},d={key:1,class:"gray"},p=["onClick"],f=["onClick"],h={class:"list-content width-230"},m={class:"list-content-item"},v=o((function(){return(0,i._)("span",null,"Methods",-1)})),w=["onClick"],g={key:0},y={key:0},b={key:1},k={key:2},_=["onClick"],$={class:"list-content"},P={class:"flex list-content-item"},S={class:"flex-item"},C={class:"flex-item pl-10"},W=o((function(){return(0,i._)("div",{class:"swagger",id:"swagger"},null,-1)})),j={key:0},z=["onClick"],U={key:0},A={key:1},D={key:0},E={key:0,class:"absolute",style:{right:"0"}},O=["onClick"],x=["onClick"],q={key:0},I={key:1,class:"width-80"},T={class:"pt-10"},L={key:0},N={key:1,class:"gray"},V={class:"ml-15 pt-10"},R={key:0},H={key:1,class:"gray"},Z={class:"ml-15 pt-10"},K=o((function(){return(0,i._)("text",{class:"ml-10 pt-10"}," => ",-1)})),Y={class:"width-80"},F={key:0},M={key:0};var B=n(66347),J=n(95082),G=(n(41539),n(54747),n(57658),n(69600),n(57327),n(30541),n(40561),n(9653),n(38862),n(69826),n(21249),n(96486)),Q=n.n(G),X=n(11416),tt=n.n(X),et=n(44107),nt=n(38718),it=n(79954),at=n(77809),lt=n(47556),ot=n(74353),rt=n(99684),st=n(2692),ut=n(75255),ct=n(54367),dt=n(44218),pt=n(52255),ft=n(16527),ht={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917 211.1l-199.2 24c-6.6.8-9.4 8.9-4.7 13.6l59.3 59.3-226 226-101.8-101.7c-6.3-6.3-16.4-6.2-22.6 0L100.3 754.1a8.03 8.03 0 000 11.3l45 45.2c3.1 3.1 8.2 3.1 11.3 0L433.3 534 535 635.7c6.3 6.2 16.4 6.2 22.6 0L829 364.5l59.3 59.3a8.01 8.01 0 0013.6-4.7l24-199.2c.7-5.1-3.7-9.5-8.9-8.8z"}}]},name:"rise",theme:"outlined"},mt=n(33058);function vt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?Object(arguments[e]):{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),i.forEach((function(e){wt(t,e,n[e])}))}return t}function wt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var gt=function(t,e){var n=vt({},t,e.attrs);return(0,i.Wm)(mt.Z,vt({},n,{icon:ht}),null)};gt.displayName="RiseOutlined",gt.inheritAttrs=!1;var yt=gt,bt=n(64137),kt=n(27780),_t=n(62611),Pt=n(61103),St=n(1299),Ct=n(13589),Wt=n(76754),jt=n(33907),zt=n(71900),Ut=n(48551),At=n(21936),Dt=n(49702),Et=n(990),Ot=n(34531),xt=n(93320),qt={name:"ApiDetail",i18n:n(89234),components:{HeadInfo:zt.Z,FormItem:Wt.Z,StopOutlined:ot.Z,DetailListItem:Ct.Z,DetailList:St.Z,PageLayout:Pt.Z,MiniArea:Ut.Z,JsonEditor:At.Z,PlusCircleTwoTone:rt.Z,MoreOutlined:st.Z,CheckOutlined:ut.Z,CloseOutlined:ct.Z,Json2YamlCard:et.Z,PlusOutlined:dt.Z,PauseOutlined:pt.Z,RocketOutlined:ft.Z,PluginConfig:nt.Z,PolicyList:at.default,PluginList:it.Z,LogViewer:Dt.Z,EmbedDashboard:Et.Z,RiseOutlined:yt,CardSelector:Ot.Z,MinusCircleTwoTone:bt.Z,CodeSandboxOutlined:kt.Z,PartitionOutlined:_t.Z},props:["embed","name"],data:function(){return{RiseOutlined:yt,DEFAULT_API_DETAIL:lt.zN,detail:{project:null,pipy:null,blacklistServices:[],whitelistServices:[],name:"",status:0,step:0,approvalLevel:0,scope:1,content:{log:{level:"All"},metadata:{labels:{}},isCanary:!1,plugins:[],versions:{},hosts:{},systemCode:[],endpoints:[],providers:[],msg:[[],[],[],[]]},spec:"{}"},labelVisible:!1,labelValue:"",projects:[],pipys:[],type:"API",screenWidth:document.body.clientWidth,systemCodeVisible:!1,systemCodeValue:"",visibleAP:!1,versionVisible:!1,versionValue:"",hostVisible:!1,hostValue:"",visibleReview:!1,visibleRevise:!1,visibleDeploy:!1,visibleStop:!1,visibleRestart:!1,description1:"",description2:"",description3:"",description4:"",step:0,stepStatus:"process",editorIsCreate:!0,activeKey:"1",upstreams:[],functions:["func1","func2","func3"],zones:["zone1","zone2","zone3"],payloadEndpoint:{host:"192.168.1.1\n192.168.1.2",path:"subpath1/\nsubpath2/",customPaths:[],protocols:["HTTP","HTTPS"],methods:["GET","POST","PATCH","PUT","DELETE","HEAD","OPTIONS"],stripPath:!0,preserveHost:!1},payloadProvider:{name:"pro1",content:"192.168.1.1",path:"subpath1/",id:"test01",protocols:["HTTP","HTTPS"],type:"Host",versions:[],hosts:[],isDefault:!1,upstream:{id:null},upstreamId:""},types:["Host","Upstream"],protocols:["HTTP","HTTPS","WS","MQTT","HTTP2","GRPC","REDIS","DUBBO","TCP"],methods:["GET","POST","PATCH","PUT","DELETE","HEAD","OPTIONS"],endpoints:[],approvalLevels:[],providers:[],bindPolicy:null,visiblelog:!1,visibleEndpoint:!1,visibleProvider:!1,loading:!0,logloading:!0,swaggerLoading:!0,logs:[],log:"{}",pid:"",pcontent:"",pspec:"",filter:"",params:{pageNo:1,pageSize:10,total:0},application:{loading:!0,key:"",pageSize:10,pageNo:1,total:0,list:[]},applies:{loading:!0,key:"",pageSize:10,pageNo:1,total:0,list:[]},black:{loading:!0,key:"",pageSize:10,pageNo:1,total:0,list:[]},white:{loading:!0,key:"",pageSize:10,pageNo:1,total:0,list:[]},profiles:[],clusters:[],tps:[],tpsCnt:0,activeTabKey:"2"}},computed:(0,J.Z)((0,J.Z)((0,J.Z)({},(0,jt.rn)({rules:function(t){return t.rules.rules},isMobile:function(t){return t.setting.isMobile}})),(0,jt.Se)("account",["user"])),{},{appliesStart:function(){return(this.applies.pageNo-1)*this.applies.pageSize},applicationStart:function(){return(this.application.pageNo-1)*this.application.pageSize},dataleftColumns:function(){return[{dataIndex:"name",title:this.$t("Name")},{dataIndex:"clusterName",title:this.$t("cluster")}]},datarightColumns:function(){return[{dataIndex:"name",title:this.$t("Name")},{dataIndex:"clusterName",title:this.$t("cluster")}]},findApprovalLevel:function(){var t=this,e=null;return this.approvalLevels.forEach((function(n){n.value==t.detail.approvalLevel&&(e=n)})),e},appliesCnt:function(){var t=0;return(this.detail.subscribeApiApplies||[]).forEach((function(e){0==e.status&&t++})),t}}),created:function(){this.getBlackUpstreams(),this.getWhiteUpstreams(),this.pid=this.$route.params.id||"",this.pcontent=this.$route.params.content||"",this.pspec=this.$route.params.spec||"",this.type=0==this.$route.path.indexOf("/openapi/policy")?"Policy":"API",this.activeKey="Policy"==this.type?"2":"1",this.editorIsCreate=""==this.pid,this.embed&&(this.pid="")},mounted:function(){var t=this;this.$gql.query("projects{data{id,attributes{name}}}").then((function(e){t.projects=e.data})),this.$gql.query("upstreams{data{id,attributes{name,content}}}").then((function(e){t.upstreams=e.data})),this.$gql.query('systemSettings(filters:{type:{eq:"ApiApprovalLevelType"}}){data{id,attributes{mode,content}}}').then((function(e){t.approvalLevels=[{label:"unset",value:0,approvalRoles:null}],t.approvalLevels=t.approvalLevels.concat(e.data[0].content),t.approvalLevels.forEach((function(t){t.value=1*t.value}))})),this.$gql.query('fleets(filters:{type:{eq:"pipy"}}){data{id,attributes{name,content,upstreams{data{id,attributes{content}}}}}}').then((function(e){t.pipys=e.data})),""!=this.pid?this.loadapi():this.pcontent?(this.detail.content=JSON.parse(this.pcontent),this.detail.content.metadata=this.detail.content.metadata?this.detail.content.metadata:{},this.detail.content.metadata.labels=this.detail.content.metadata.labels?this.detail.content.metadata.labels:{},this.pspec?this.detail.spec=this.pspec:this.detail.spec="{}",this.loading=!1):(this.detail={project:null,pipy:null,name:"",status:0,step:0,approvalLevel:0,scope:1,content:{log:{level:"All"},metadata:{labels:{}},plugins:[],versions:{},systemCode:[],endpoints:[],providers:[],msg:[[],[],[],[]]},spec:"{}"},this.loading=!1),this.embed&&(this.detail.name=this.name);var e=this;window&&(window.onresize=function(){window.screenWidth=document.body.clientWidth,e.screenWidth=window.screenWidth})},methods:{appDetail:function(t){this.$router.push({path:"/openapi/application/detail/"+t})},handleClose:function(t,e){delete t[e]},labelShowInput:function(){var t=this;this.labelVisible=!0,this.$nextTick().then((function(){t.$refs.labelRef.focus()}))},labelInputConfirm:function(){if(""!=this.labelValue){var t=this.labelValue.split(":");t.length<2?this.$message.error({content:this.$t("Please enter the format of [key]:[value]")}):(this.detail.content.metadata.labels=this.detail.content.metadata.labels||{},this.detail.content.metadata.labels[t.shift()]=t.join(":"),this.labelValue="",this.labelVisible=!1)}else this.labelVisible=!1},finish:function(){},finishFailed:function(){},getHistory:function(t){var e=t.content;if(e||(e={}),e.history){if(e.history.length<this.detail.approvalLevel){e.history=[];for(var n=0;n<this.detail.approvalLevel-e.history.length;n++)e.history.push({time:"",user:{}})}}else{e.history=[];for(var i=0;i<this.detail.approvalLevel;i++)e.history.push({time:"",user:{}})}return e.history[t.approvalStep]={time:(new Date).toLocaleString(),user:this.user},e},removeSubApi:function(t){var e=this;this.$gql.query("application(id:".concat(t.id,"){data{id,attributes{apis{data{id,attributes{name}}}}}}")).then((function(n){var i=[];n.data.apis.forEach((function(t){i.push(t.id)})),i=i.filter((function(t){return t!=e.pid})),e.$gql.mutation("updateApplication(id:".concat(t.id,", data: $data){data{id}}"),{data:{apis:i}},{data:"ApplicationInput!"}).then((function(){e.loadapi(),e.$message.success($t("Removed successfully"),3)}))}))},approvalApply:function(t){var e=this;this.$gql.mutation("updateSubscribeApiApply(id:".concat(t.id,", data: $data){data{id,attributes{approvalStep,status}}}"),{data:{status:t.approvalStep+1==this.detail.approvalLevel?1:0,approvalStep:t.approvalStep+1==this.detail.approvalLevel?t.approvalStep:t.approvalStep+1,content:this.getHistory(t)}},{data:"SubscribeApiApplyInput!"}).then((function(n){n.data.approvalStep+1==e.detail.approvalLevel&&1==n.data.status?e.$gql.query("application(id:".concat(t.application.id,"){data{id,attributes{apis{data{id,attributes{name}}}}}}")).then((function(n){var i=[];n.data.apis.forEach((function(t){i.push(t.id)})),i.push(e.pid),e.$gql.mutation("updateApplication(id:".concat(t.application.id,", data: $data){data{id}}"),{data:{apis:i}},{data:"ApplicationInput!"}).then((function(){e.loadapi(),e.$message.success(e.$t("Save successfully"),3)}))})):(e.loadapi(),e.$message.success(e.$t("Save successfully"),3))}))},refuseApply:function(t){var e=this;this.$gql.mutation("updateSubscribeApiApply(id:".concat(t.id,", data: $data){data{id}}"),{data:{status:2,content:this.getHistory(t)}},{data:"SubscribeApiApplyInput!"}).then((function(){e.$message.success(e.$t("Save successfully"),3),e.loadapi()}))},selectPlugin:function(t){this.detail.content.plugins.push((0,J.Z)((0,J.Z)({},t),{},{enable:!0})),this.visibleAP=!1,this.$message.success(this.$t("Added successfully"),3)},showPluginBox:function(){this.visibleAP=!0},changePrdDefault:function(t,e){this.detail.content.providers.forEach((function(t,n){e!=n&&(t.isDefault=!1)})),t.isDefault&&this.detail.content.providers.unshift(this.detail.content.providers.splice(e,1)[0])},handleArrayClose:function(t,e){t.splice(e,1)},systemCodeShowInput:function(){var t=this;this.systemCodeVisible=!0,this.$nextTick().then((function(){t.$refs.systemCodeRef.focus()}))},systemCodeInputConfirm:function(){""!=this.systemCodeValue?(this.detail.content.systemCode.push(this.systemCodeValue),this.systemCodeValue="",this.systemCodeVisible=!1):this.systemCodeVisible=!1},versionShowInput:function(){var t=this;this.versionVisible=!0,this.$nextTick().then((function(){t.$refs.versionRef.focus()}))},versionInputConfirm:function(){""!=this.versionValue?(this.payloadProvider.versions.push(this.versionValue),this.versionValue="",this.versionVisible=!1):this.versionVisible=!1},hostShowInput:function(){var t=this;this.hostVisible=!0,this.$nextTick().then((function(){t.$refs.hostRef.focus()}))},hostInputConfirm:function(){""!=this.hostValue?(this.payloadProvider.hosts||(this.payloadProvider.hosts=[]),this.payloadProvider.hosts.push(this.hostValue),this.hostValue="",this.hostVisible=!1):this.hostVisible=!1},toReview:function(t,e){this.detail.step=1,this.stepStatus="process",this.detail.content.msg[e].unshift(t),this.visibleReview=!1,this.validate()},toRevise:function(t,e){this.detail.step=0,this.stepStatus="error",this.detail.content.msg[e].unshift(t),this.visibleRevise=!1,this.validate()},toDeploy:function(t,e){this.detail.step=2,this.stepStatus="process",this.detail.content.msg[e].unshift(t),this.visibleDeploy=!1,this.validate()},toStop:function(t,e){this.detail.step=3,this.stepStatus="error",this.detail.content.msg[e].unshift(t),this.visibleStop=!1,this.validate()},toRestart:function(t,e){this.detail.step=2,this.stepStatus="process",this.detail.content.msg[e].unshift(t),this.visibleRestart=!1,this.validate()},validForm:function(){var t=this;this.$refs.form.validateFields().then((function(){t.handleOkEndpoint()})).catch((function(){}))},handleOkEndpoint:function(){this.visibleEndpoint=!1,this.isEdit||this.detail.content.endpoints.push(Q().cloneDeep(this.payloadEndpoint))},validProvider:function(){var t=this;this.$refs.providerForm.validateFields().then((function(){t.handleOkProvider()})).catch((function(){}))},handleOkProvider:function(){var t=this;this.visibleProvider=!1,this.upstreams.forEach((function(e){e.id==t.payloadProvider.upstreamId&&(t.payloadProvider.upstream=e)})),this.isEdit||this.detail.content.providers.push(Q().cloneDeep(this.payloadProvider))},addEndpoint:function(){this.isEdit=!1,this.payloadEndpoint={host:"",path:"",customPaths:[],protocols:[],methods:[],stripPath:!0,preserveHost:!1,denyenable:!1,regExpPriority:1,dubboMethodName:"",dubboMethodSignature:""},this.visibleEndpoint=!0},editEndpoint:function(t){this.isEdit=!0,this.payloadEndpoint=t,this.visibleEndpoint=!0},addProvider:function(){this.isEdit=!1,this.payloadProvider={name:"",content:"",path:"/",versions:[],upstream:{id:null},protocols:[],type:"Host",payloadProvider:""},this.visibleProvider=!0},editProvider:function(t){var e=this;this.isEdit=!0,this.payloadProvider=t,this.visibleProvider=!0,this.payloadProvider.upstream&&this.payloadProvider.upstream.id&&this.upstreams.forEach((function(t){e.payloadProvider.upstream.id==t.id&&(e.payloadProvider.upstream=t,e.payloadProvider.upstreamId=e.payloadProvider.upstream.id)}))},removeEndpoint:function(t){this.detail.content.endpoints.splice(t,1)},removeProvider:function(t){this.detail.content.providers.splice(t,1)},onTabChange:function(t){},valid:function(){if(""==this.detail.name)return this.$message.error(this.$t("The name cannot be empty"),3),!1;if(this.detail.content.providers)for(var t=0;t<this.detail.content.providers.length;t++)if(t>0&&this.detail.content.providers[t].type!=this.detail.content.providers[t-1].type)return this.$message.error(this.$t("All providers can only set the same type"),3),!1;if(this.detail.content.plugins){var e,n=(0,B.Z)(this.detail.content.plugins);try{for(n.s();!(e=n.n()).done;){var i=e.value;if("black-white-list"==i.name){var a,l=(0,B.Z)(i.content.fields);try{for(l.s();!(a=l.n()).done;){var o=a.value;if("header"==o.name)try{o.value&&JSON.parse(o.value)}catch(t){return this.$message.error(this.$t("The header format of the black-white-list plugin is incorrect"),3),!1}}}catch(t){l.e(t)}finally{l.f()}}}}catch(t){n.e(t)}finally{n.f()}}return!0},validate:function(){var t=this;this.$refs.layout.$refs.form.validateFields().then((function(){t.save()})).catch((function(){}))},saveLogLevel:function(t){this.detail.content.log.level=t.logLevel,this.save()},save:function(){var t=this;if(this.valid()){1==this.detail.content.providers.length&&(this.detail.content.providers[0].isDefault=!0);var e=Q().cloneDeep(this.detail);e.spec=JSON.parse(e.spec),this.bindPolicy?e.policy=this.bindPolicy.id:e.policy=void 0,e.plugins=[],e.content.plugins&&e.content.plugins.forEach((function(t){t.content.fields.forEach((function(t){"number"==t.type&&(t.value=Number(t.value))})),e.plugins.push(t.id)})),delete e.createdAt,delete e.updatedAt,delete e.id,delete e.chart,delete e.subscribeApiApplies;var n,i=[],a=(0,B.Z)(e.content.providers);try{for(a.s();!(n=a.n()).done;){var l=n.value;"Upstream"==l.type&&i.push(Number(l.upstream.id))}}catch(t){a.e(t)}finally{a.f()}e.upstreams=i,""!=this.pid?this.$gql.mutation("updateApi(id:".concat(this.pid,", data: $data){data{id}}"),{data:e},{data:"ApiInput!"}).then((function(){t.$message.success(t.$t("Save successfully"),3)})):this.$gql.mutation("createApi(data: $data){data{id}}",{data:e},{data:"ApiInput!"}).then((function(e){t.pid=e.data.id,t.$router.replace({path:"/openapi/api/detail/"+t.pid}),t.$message.success(t.$t("Created successfully"),3)}))}},handleChange:function(){},hide:function(){this.visible=!1},clearSelector:function(){this.payloadProvider.upstream=null,this.payloadProvider.upstreamId=null},saveSelector:function(t){this.payloadProvider.upstream=t,this.payloadProvider.upstreamId=t.id},swaggerchange:function(){var t=this;setTimeout((function(){var e=t.detail.spec?JSON.parse(t.detail.spec):"";tt()({spec:e,dom_id:"#swagger",deepLinking:!1,presets:[tt().presets.apis,tt().SwaggerUIStandalonePreset],plugins:[tt().plugins.DownloadUrl]})}),300)},getDefaultSwaggerConfig:function(){var t=this;fetch("swagger.yaml").then((function(t){return t.text()})).then((function(e){var n=xt.load(e),i=JSON.stringify(n,null,"  ");t.detail.spec=i,tt()({spec:n,dom_id:"#swagger",deepLinking:!1,presets:[tt().presets.apis,tt().SwaggerUIStandalonePreset],plugins:[tt().plugins.DownloadUrl]})})).catch((function(t){}))},selectPolicy:function(t){this.bindPolicy=t,this.detail.content.plugins=t.content.plugins,this.$message.success(this.$t("Bound policy")+"："+t.name,3)},resetPolicy:function(){this.bindPolicy=null,this.$message.success(this.$t("Custom policy restored"),3)},selectUpStream:function(t){var e=this.upstreams.find((function(e){return e.id==t}));e&&e.content&&e.content.path&&(this.payloadProvider.path=e.content.path)},onBlackChange:function(t){this.detail.blacklistServices=t},onWhiteChange:function(t){this.detail.whitelistServices=t},getRowSelection:function(t,e,n,i){return{getCheckboxProps:function(e){return{disabled:t||e.disabled}},onSelectAll:function(t,e){var i=e.filter((function(t){return!t.disabled})).map((function(t){return t.key}));n(i,t)},onSelect:function(t,e){i(t.key,e)},selectedRowKeys:e}},blackSearch:function(t,e){"left"==t&&(this.black.key=e,this.getBlackUpstreams())},whiteSearch:function(t,e){"left"==t&&(this.white.key=e,this.getWhiteUpstreams())},blackPagging:function(t){this.black.pageNo=t},whitePagging:function(t){this.white.pageNo=t},getBlackUpstreams:function(t,e,n){this.getUpstreams(this.black,t,e,n)},getWhiteUpstreams:function(t,e,n){this.getUpstreams(this.white,t,e,n)},getUpstreams:function(t,e,n){e&&(t.pageNo=e,t.pageSize=n),t.loading=!0;var i={name:{contains:t.key}};this.$gql.query("upstreams(pagination:{start: 0, limit: ".concat(this.$DFT_LIMIT,"}, filters: $filters){\n\t\t\t\t\t\tdata{id,attributes{\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\tpipy{data{id,attributes{name}}},\n\t\t\t\t\t\t\tcluster{data{id,attributes{name}}},\n\t\t\t\t\t\t\tdescription\n\t\t\t\t\t\t}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}"),{filters:i},{filters:"UpstreamFiltersInput"}).then((function(e){t.list=e.data,t.list.forEach((function(t){t.cluster?t.clusterName=t.cluster.name:t.clusterName="-",t.key="".concat(t.id)})),t.total=e.pagination.total,t.loading=!1}))},addCustompath:function(){0!=this.detail.content.providers.length?(this.payloadEndpoint.customPaths||(this.payloadEndpoint.customPaths=[]),this.payloadEndpoint.customPaths.push({path:[],providers:[],oldPath:"",newPath:""})):this.$message.error(this.$t("Please add a provider for the current API first"),3)},removeCustompath:function(t){var e=this.payloadEndpoint.customPaths.indexOf(t);-1!==e&&this.payloadEndpoint.customPaths.splice(e,1)},searchApplications:function(t){var e=this;this.application.pageNo=t||1,this.loading=!0;var n={apis:{id:{eq:this.pid}}};this.$gql.query("applications(filters: $filters, pagination:{start: ".concat(this.applicationStart,", limit: ").concat(this.application.pageSize,"}){\n\t\t\t\t\t\tdata{id,attributes{\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tproject{data{id,attributes{\n\t\t\t\t\t\t\t\torganization{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\t}}},\n\t\t\t\t\t\t\tapis{data{id,attributes{name}}},\n\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\t}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}"),{filters:n},{filters:"ApplicationFiltersInput"}).then((function(t){e.application.list=t.data,e.application.total=t.pagination.total,e.application.loading=!1}))},searchApplies:function(t){var e=this;this.applies.pageNo=t||1,this.loading=!0;var n={api:{id:{eq:this.pid}}};this.$gql.query("subscribeApiApplies(filters: $filters, pagination:{start: ".concat(this.appliesStart,", limit: ").concat(this.applies.pageSize,"}){\n\t\t\t\t\t\tdata{id,attributes{\n\t\t\t\t\t\t\tmsg,\n\t\t\t\t\t\t\tstatus,\n\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\tapprovalStep,\n\t\t\t\t\t\t\tapplication{data{id,attributes{name}}},\n\t\t\t\t\t\t\tapplyUser{data{id,attributes{username}}},\n\t\t\t\t\t\t\tcreatedAt,\n\t\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\t}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}"),{filters:n},{filters:"SubscribeApiApplyFiltersInput"}).then((function(t){e.applies.list=t.data,e.applies.total=t.pagination.total,e.applies.loading=!1}))},loadapi:function(){var t=this;this.loading=!0,this.$gql.query("api(id: ".concat(this.pid,"){data{id,attributes{\n\t\t\t\t\t\tuid,\n\t\t\t\t\t\tname,\n\t\t\t\t\t\tstatus,\n\t\t\t\t\t\tapprovalLevel,\n\t\t\t\t\t\tsubscribeApiApplies{data{id,attributes{\n\t\t\t\t\t\t\tmsg,\n\t\t\t\t\t\t\tstatus,\n\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\tapprovalStep,\n\t\t\t\t\t\t\tapplication{data{id,attributes{name}}},\n\t\t\t\t\t\t\tapplyUser{data{id,attributes{username}}},\n\t\t\t\t\t\t\tcreatedAt,\n\t\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\t}}},\n\t\t\t\t\t\tstep,\n\t\t\t\t\t\tscope,\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t\tspec,\n\t\t\t\t\t\tchart,\n\t\t\t\t\t\tblacklistServices{data{id}},\n\t\t\t\t\t\twhitelistServices{data{id}},\n\t\t\t\t\t\tpolicy{data{id,attributes{name,content}}},\n\t\t\t\t\t\tplugins{data{id,attributes{\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\ticon{data{id,attributes{url,previewUrl}}},\n\t\t\t\t\t\t\ttype{data{id,attributes{name}}},\n\t\t\t\t\t\t\tdesc,\n\t\t\t\t\t\t\tcontent\n\t\t\t\t\t\t}}},\n\t\t\t\t\t\tproject{data{id}},\n\t\t\t\t\t\tpipy{data{id}},\n\t\t\t\t\t\tcreatedAt,\n\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t}}}")).then((function(e){var n;t.loading=!1;var i,a,l=e.data;(t.detail=l,t.detail.spec=JSON.stringify(l.spec),t.detail.project=l.project?l.project.id:null,t.detail.content.metadata=l.content.metadata?l.content.metadata:{},t.detail.content.metadata.labels=l.content.metadata.labels?l.content.metadata.labels:{},t.detail.content.log||(t.detail.content.log={}),t.detail.content.log.level||(t.detail.content.log.level="All"),t.detail.pipy?t.detail.pipy=l.pipy.id:t.detail.pipy=null,t.detail.content.systemCode&&t.detail.content.systemCode.length||(t.detail.content.systemCode=[]),t.detail.content.versions||(t.detail.content.versions={}),t.detail.content.plugins||(t.detail.content.plugins=[]),t.detail.content.isCanary||(t.detail.content.isCanary=!1),t.detail.policy)&&(t.detail.content.plugins=null===(i=t.detail.policy)||void 0===i||null===(a=i.content)||void 0===a?void 0:a.plugins);if(t.detail.blacklistServices){var o=t.detail.blacklistServices;t.detail.blacklistServices=[],o.forEach((function(e){t.detail.blacklistServices.push(e.id)}))}else t.detail.blacklistServices=[];if(t.detail.whitelistServices){var r=t.detail.whitelistServices;t.detail.whitelistServices=[],r.forEach((function(e){t.detail.whitelistServices.push(e.id)}))}else t.detail.whitelistServices=[];var s={};t.detail.content.plugins&&t.detail.content.plugins.forEach((function(t){s[t.id]=t,s[t.id].content.script||(s[t.id].content.script="")})),t.detail.content.plugins=[],t.detail.plugins&&t.detail.plugins.forEach((function(e){e.content.script=s[e.id].content.script,e.content.script||(e.content.script=""),s[e.id]?(s[e.id].content.fields&&e.content.fields&&e.content.fields.forEach((function(t){s[e.id].content.fields.forEach((function(e){t.name==e.name&&(t.value=e.value)}))})),e.enable=s[e.id].enable):e.enable=!1,t.detail.content.plugins.push(e)})),t.detail.content.providers&&t.detail.content.providers.forEach((function(t){t.isDefault=!!t.isDefault&&t.isDefault})),t.bindPolicy=null===(n=t.detail.policy)||void 0===n?void 0:n.data})),this.searchApplications(),this.searchApplies()}}};var It=(0,n(83744).Z)(qt,[["render",function(t,e,n,o,B,J){var G=(0,i.up)("a-tooltip"),Q=(0,i.up)("a-step"),X=(0,i.up)("RocketOutlined"),tt=(0,i.up)("PauseOutlined"),et=(0,i.up)("a-steps"),nt=(0,i.up)("DetailListItem"),it=(0,i.up)("a-input"),at=(0,i.up)("a-select-option"),lt=(0,i.up)("a-select"),ot=(0,i.up)("a-tag"),rt=(0,i.up)("PlusOutlined"),st=(0,i.up)("a-radio"),ut=(0,i.up)("a-radio-group"),ct=(0,i.up)("DetailList"),dt=((0,i.up)("HeadInfo"),(0,i.up)("a-button")),pt=(0,i.up)("a-textarea"),ft=(0,i.up)("a-popover"),ht=(0,i.up)("PlusCircleTwoTone"),mt=(0,i.up)("a-list-item-meta"),vt=(0,i.up)("a-menu-item"),wt=(0,i.up)("a-popconfirm"),gt=(0,i.up)("a-menu"),yt=(0,i.up)("MoreOutlined"),bt=(0,i.up)("a-dropdown"),kt=(0,i.up)("a-list-item"),_t=(0,i.up)("a-list"),$t=(0,i.up)("a-card"),Pt=(0,i.up)("a-switch"),St=(0,i.up)("a-col"),Ct=(0,i.up)("MiniArea"),Wt=(0,i.up)("JsonEditor"),jt=(0,i.up)("a-drawer"),zt=(0,i.up)("a-row"),Ut=(0,i.up)("a-tab-pane"),At=(0,i.up)("a-divider"),Dt=(0,i.up)("PluginConfig"),Et=(0,i.up)("PolicyList"),Ot=(0,i.up)("Json2YamlCard"),xt=(0,i.up)("LogViewer"),qt=(0,i.up)("a-table"),It=(0,i.up)("a-transfer"),Tt=(0,i.up)("a-badge"),Lt=(0,i.up)("CodeSandboxOutlined"),Nt=(0,i.up)("StopOutlined"),Vt=(0,i.up)("PartitionOutlined"),Rt=(0,i.up)("CloseOutlined"),Ht=(0,i.up)("CheckOutlined"),Zt=(0,i.up)("EmbedDashboard"),Kt=(0,i.up)("a-tabs"),Yt=(0,i.up)("PageLayout"),Ft=(0,i.up)("a-descriptions-item"),Mt=(0,i.up)("FormItem"),Bt=(0,i.up)("MinusCircleTwoTone"),Jt=(0,i.up)("a-descriptions"),Gt=(0,i.up)("a-form"),Qt=(0,i.up)("a-modal"),Xt=(0,i.up)("CardSelector"),te=(0,i.up)("PluginList"),ee=((0,i.up)("RiseOutlined"),(0,i.Q2)("permission"));return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(Yt,{"hide-breadcrumb":n.embed,title:n.embed?" ":B.detail.name?B.detail.name:t.$t("new")+t.$t(B.type),"form-state":B.detail,ref:"layout"},(0,i.Nv)({headerContent:(0,i.w5)((function(){return[(0,i._)("div",r,[(0,i.Wm)(et,{status:B.stepStatus,type:"navigation",current:B.detail.step,"onUpdate:current":e[0]||(e[0]=function(t){return B.detail.step=t}),size:"small",class:"steps"},{default:(0,i.w5)((function(){return[(0,i.Wm)(Q,{disabled:!0,title:t.$t("Design")},{description:(0,i.w5)((function(){return[(0,i.Wm)(G,null,{title:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(B.detail.content.msg[0][0]||t.$t("No description")),1)]})),default:(0,i.w5)((function(){return[(0,i.Uk)(" "+(0,a.zw)(B.detail.content.msg[0][0]?t.$t("View notes"):t.$t("No description")),1)]})),_:1})]})),_:1},8,["title"]),(0,i.Wm)(Q,{disabled:!0,title:t.$t("Review")},{description:(0,i.w5)((function(){return[(0,i.Wm)(G,null,{title:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(B.detail.content.msg[1][0]||t.$t("No description")),1)]})),default:(0,i.w5)((function(){return[(0,i.Uk)(" "+(0,a.zw)(B.detail.content.msg[1][0]?t.$t("Approval opinions"):t.$t("No description")),1)]})),_:1})]})),_:1},8,["title"]),(0,i.Wm)(Q,{disabled:!0,title:t.$t("Run")},{icon:(0,i.w5)((function(){return[(0,i.Wm)(X)]})),description:(0,i.w5)((function(){return[(0,i.Wm)(G,null,{title:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(B.detail.content.msg[2][0]||t.$t("No description")),1)]})),default:(0,i.w5)((function(){return[(0,i.Uk)(" "+(0,a.zw)(B.detail.content.msg[2][0]?t.$t("View notes"):t.$t("No description")),1)]})),_:1})]})),_:1},8,["title"]),(0,i.Wm)(Q,{disabled:!0,title:t.$t("Stop")},{icon:(0,i.w5)((function(){return[(0,i.Wm)(tt)]})),description:(0,i.w5)((function(){return[(0,i.Wm)(G,null,{title:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(B.detail.content.msg[3][0]||t.$t("No description")),1)]})),default:(0,i.w5)((function(){return[(0,i.Uk)(" "+(0,a.zw)(B.detail.content.msg[3][0]?t.$t("View notes"):t.$t("No description")),1)]})),_:1})]})),_:1},8,["title"])]})),_:1},8,["status","current"])]),(0,i.Wm)(ct,{size:"small",col:1},{default:(0,i.w5)((function(){return[""!=B.pid?((0,i.wg)(),(0,i.j4)(nt,{key:0,term:t.$t("UID")},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(B.detail.uid),1)]})),_:1},8,["term"])):(0,i.kq)("",!0),n.embed?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(nt,{key:1,term:t.$t("as"),name:"name",rules:t.rules.uniqueName("apis",{id:B.pid,project:B.detail.project})},{default:(0,i.w5)((function(){return[(0,i.Wm)(it,{placeholder:t.$t("unset"),value:B.detail.name,"onUpdate:value":e[1]||(e[1]=function(t){return B.detail.name=t}),class:"width-200"},null,8,["placeholder","value"])]})),_:1},8,["term","rules"])),(0,i.Wm)(nt,{term:t.$t("Project"),name:"project",rules:t.rules.required},{default:(0,i.w5)((function(){return[(0,i.Wm)(lt,{placeholder:t.$t("unallocated"),class:"width-200",value:B.detail.project,"onUpdate:value":e[2]||(e[2]=function(t){return B.detail.project=t}),onChange:e[3]||(e[3]=function(t){return J.handleChange()})},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.projects,(function(t,e){return(0,i.wg)(),(0,i.j4)(at,{key:e,value:t.id},{default:(0,i.w5)((function(){return[t.id?((0,i.wg)(),(0,i.iD)("span",s,(0,a.zw)(t.name),1)):(0,i.kq)("",!0),t.id?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("i",u,(0,a.zw)(t.name),1))]})),_:2},1032,["value"])})),128))]})),_:1},8,["placeholder","value"])]})),_:1},8,["term","rules"]),(0,i.Wm)(nt,{term:t.$t("Pipy"),name:"pipy",rules:t.rules.required},{default:(0,i.w5)((function(){return[(0,i.Wm)(lt,{placeholder:t.$t("unallocated"),class:"width-160",value:B.detail.pipy,"onUpdate:value":e[4]||(e[4]=function(t){return B.detail.pipy=t}),onChange:e[5]||(e[5]=function(t){return J.handleChange()})},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.pipys,(function(t,e){return(0,i.wg)(),(0,i.j4)(at,{key:e,value:t.id},{default:(0,i.w5)((function(){return[t.id?((0,i.wg)(),(0,i.iD)("span",c,(0,a.zw)(t.name),1)):(0,i.kq)("",!0),t.id?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("i",d,(0,a.zw)(t.name),1))]})),_:2},1032,["value"])})),128))]})),_:1},8,["placeholder","value"])]})),_:1},8,["term","rules"]),(0,i.Wm)(nt,{term:t.$t("Labels")},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(Object.keys(B.detail.content.metadata.labels||{}),(function(t,e){return(0,i.wg)(),(0,i.j4)(ot,{key:e,onClose:function(e){return J.handleClose(B.detail.content.metadata.labels,t)},closable:!0},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t)+":"+(0,a.zw)(B.detail.content.metadata.labels[t]),1)]})),_:2},1032,["onClose"])})),128)),(0,i.wy)((0,i.Wm)(it,{ref:"labelRef",type:"text",size:"small",class:"width-100",placeholder:"[KEY:VALUE]",value:B.labelValue,"onUpdate:value":e[6]||(e[6]=function(t){return B.labelValue=t}),onBlur:J.labelInputConfirm,onKeyup:(0,l.D2)(J.labelInputConfirm,["enter"])},null,8,["value","onBlur","onKeyup"]),[[l.F8,B.labelVisible]]),B.labelVisible?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(ot,{key:0,onClick:J.labelShowInput,class:"dashed-tag"},{default:(0,i.w5)((function(){return[(0,i.Wm)(rt),(0,i.Uk)(" "+(0,a.zw)(t.$t("add")),1)]})),_:1},8,["onClick"]))]})),_:1},8,["term"]),(0,i.Wm)(nt,{term:t.$t("Permission")},{default:(0,i.w5)((function(){return[(0,i.Wm)(ut,{value:B.detail.scope,"onUpdate:value":e[7]||(e[7]=function(t){return B.detail.scope=t})},{default:(0,i.w5)((function(){return[(0,i.Wm)(st,{value:1},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Public")),1)]})),_:1}),(0,i.Wm)(st,{value:2},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Private")),1)]})),_:1})]})),_:1},8,["value"])]})),_:1},8,["term"]),(0,i.Wm)(nt,{term:t.$t("Audit Level")},{default:(0,i.w5)((function(){return[(0,i.Wm)(lt,{placeholder:t.$t("unset"),class:"width-120",value:B.detail.approvalLevel,"onUpdate:value":e[8]||(e[8]=function(t){return B.detail.approvalLevel=t})},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.approvalLevels,(function(e,n){return(0,i.wg)(),(0,i.j4)(at,{key:n,value:e.value},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t(e.label)),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["placeholder","value"]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.approvalLevels,(function(t,e){return(0,i.wg)(),(0,i.iD)("div",{class:"inline-block",key:e},[B.detail.approvalLevel>0&&t.value==B.detail.approvalLevel?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"relative",style:(0,a.j5)([{top:"-15px",left:"10px"},"width:"+100*B.detail.approvalLevel+"px"])},[(0,i.Wm)(et,{current:-1,size:"small"},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.approvalRoles,(function(t,e){return(0,i.wg)(),(0,i.j4)(Q,{key:e,title:t.label},null,8,["title"])})),128))]})),_:2},1024)],4)):(0,i.kq)("",!0)])})),128))]})),_:1},8,["term"])]})),_:1})]})),default:(0,i.w5)((function(){return[(0,i.Wm)(zt,{class:"row-mg"},{default:(0,i.w5)((function(){return[(0,i.Wm)(St,{class:"col-pd",xl:24,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((function(){return[(0,i.Wm)(Kt,{type:"card",activeKey:B.activeKey,"onUpdate:activeKey":e[28]||(e[28]=function(t){return B.activeKey=t})},{rightExtra:(0,i.w5)((function(){return[(0,i.wy)((0,i.Wm)(dt,{type:"primary",onClick:J.showPluginBox},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Add Plugin")),1)]})),_:1},8,["onClick"]),[[l.F8,"2"==B.activeKey&&!B.bindPolicy&&B.detail.content.plugins.length>0]])]})),default:(0,i.w5)((function(){return["API"==B.type?((0,i.wg)(),(0,i.j4)(Ut,{key:"1",tab:t.$t("Overview")},{default:(0,i.w5)((function(){return[(0,i.Wm)(zt,{class:"row-mg"},{default:(0,i.w5)((function(){return[(0,i.Wm)(St,{class:"col-pd",xl:""!=B.pid?14:24,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((function(){return[(0,i.Wm)($t,{class:"nopd",bordered:!1,title:t.$t("Endpoints"),loading:B.loading},{extra:(0,i.w5)((function(){return[(0,i._)("div",null,[(0,i.Wm)(dt,{type:"link",shape:"circle",onClick:J.addEndpoint},{icon:(0,i.w5)((function(){return[(0,i.Wm)(ht,{class:"font-20 icon-menu-sm rotate-icon"})]})),_:1},8,["onClick"])])]})),default:(0,i.w5)((function(){return[(0,i.Wm)(_t,{size:"large",pagination:!1},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.detail.content.endpoints,(function(e,n){return(0,i.wg)(),(0,i.j4)(kt,{key:n},{actions:(0,i.w5)((function(){return[(0,i._)("div",null,[(0,i.Wm)(bt,null,{overlay:(0,i.w5)((function(){return[(0,i.Wm)(gt,null,{default:(0,i.w5)((function(){return[(0,i.Wm)(vt,null,{default:(0,i.w5)((function(){return[(0,i._)("a",{onClick:function(t){return J.editEndpoint(e)}},(0,a.zw)(t.$t("edit")),9,f)]})),_:2},1024),(0,i.Wm)(vt,null,{default:(0,i.w5)((function(){return[(0,i.Wm)(wt,{placement:"topLeft","ok-text":t.$t("Yes"),"cancel-text":t.$t("No"),onConfirm:function(t){return J.removeEndpoint(n)}},{title:(0,i.w5)((function(){return[(0,i._)("p",null,(0,a.zw)(t.$t("Tip")),1),(0,i._)("p",null,(0,a.zw)(t.$t("Are you sure to remove this?")),1)]})),default:(0,i.w5)((function(){return[(0,i._)("a",null,(0,a.zw)(t.$t("Remove")),1)]})),_:2},1032,["ok-text","cancel-text","onConfirm"])]})),_:2},1024)]})),_:2},1024)]})),default:(0,i.w5)((function(){return[(0,i._)("a",null,[(0,i.Wm)(yt,{class:"mr-20"})])]})),_:2},1024)])]})),default:(0,i.w5)((function(){return[(0,i.Wm)(mt,null,{title:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.protocols,(function(t,e){return(0,i.wg)(),(0,i.j4)(ot,{color:"HTTPS"==t?"#23B899":"#00adef",key:e},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t),1)]})),_:2},1032,["color"])})),128)),(0,i._)("a",{onClick:function(t){return J.editEndpoint(e)}},(0,a.zw)(e.host?e.host.replace(/\n/g,","):"-"),9,p)]})),description:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(e.path?e.path.replace(/\n/g,","):"-"),1)]})),_:2},1024),(0,i._)("div",h,[(0,i._)("div",m,[v,(0,i._)("p",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.methods,(function(t,e){return(0,i.wg)(),(0,i.j4)(ot,{key:e,class:"mb-5"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t),1)]})),_:2},1024)})),128))])])])]})),_:2},1024)})),128))]})),_:1})]})),_:1},8,["title","loading"]),(0,i.Wm)($t,{class:"mt-15 nopd",bordered:!1,title:t.$t("Providers"),loading:B.loading},{extra:(0,i.w5)((function(){return[(0,i._)("div",null,[(0,i.Wm)(dt,{type:"link",shape:"circle",onClick:J.addProvider},{icon:(0,i.w5)((function(){return[(0,i.Wm)(ht,{class:"font-20 icon-menu-sm rotate-icon"})]})),_:1},8,["onClick"])])]})),default:(0,i.w5)((function(){return[(0,i.Wm)(_t,{size:"large",pagination:!1},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.detail.content.providers,(function(e,n){return(0,i.wg)(),(0,i.j4)(kt,{key:n},{actions:(0,i.w5)((function(){return[(0,i._)("div",null,[(0,i.Wm)(bt,null,{overlay:(0,i.w5)((function(){return[(0,i.Wm)(gt,null,{default:(0,i.w5)((function(){return[(0,i.Wm)(vt,null,{default:(0,i.w5)((function(){return[(0,i._)("a",{onClick:function(t){return J.editProvider(e)}},(0,a.zw)(t.$t("edit")),9,_)]})),_:2},1024),(0,i.Wm)(vt,null,{default:(0,i.w5)((function(){return[(0,i.Wm)(wt,{placement:"topLeft","ok-text":t.$t("Yes"),"cancel-text":t.$t("No"),onConfirm:function(t){return J.removeProvider(n)}},{title:(0,i.w5)((function(){return[(0,i._)("p",null,(0,a.zw)(t.$t("Tip")),1),(0,i._)("p",null,(0,a.zw)(t.$t("Are you sure to remove this?")),1)]})),default:(0,i.w5)((function(){return[(0,i._)("a",null,(0,a.zw)(t.$t("Remove")),1)]})),_:2},1032,["ok-text","cancel-text","onConfirm"])]})),_:2},1024)]})),_:2},1024)]})),default:(0,i.w5)((function(){return[(0,i._)("a",null,[(0,i.Wm)(yt,{class:"mr-20"})])]})),_:2},1024)])]})),default:(0,i.w5)((function(){return[(0,i.Wm)(mt,null,{title:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.protocols,(function(t,e){return(0,i.wg)(),(0,i.j4)(ot,{color:"HTTPS"==t?"#23B899":"#00adef",key:e},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t),1)]})),_:2},1032,["color"])})),128)),(0,i._)("a",{onClick:function(t){return J.editProvider(e)}},["Upstream"==e.type&&e.upstream&&e.upstream.name?((0,i.wg)(),(0,i.iD)("span",g,[e.upstream.content.displayName?((0,i.wg)(),(0,i.iD)("span",y,(0,a.zw)(e.upstream.content.displayName||e.upstream.name),1)):(0,i.kq)("",!0)])):"Host"==e.type&&e.hosts&&e.hosts.length>0?((0,i.wg)(),(0,i.iD)("span",b,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.hosts,(function(t,e){return(0,i.wg)(),(0,i.iD)("span",{key:e},(0,a.zw)(t)+"; ",1)})),128))])):((0,i.wg)(),(0,i.iD)("span",k,(0,a.zw)(e.content),1)),(0,i.Uk)(" ( "+(0,a.zw)(e.type)+" ) ",1)],8,w)]})),description:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(e.path?e.path:"-"),1)]})),_:2},1024),(0,i._)("div",$,[(0,i._)("div",P,[(0,i._)("div",S,[(0,i._)("span",null,(0,a.zw)(t.$t("as")),1),(0,i._)("p",null,[(0,i.Wm)(ot,null,{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(e.name),1)]})),_:2},1024)])]),(0,i._)("div",C,[(0,i._)("span",null,(0,a.zw)(t.$t("Default")),1),(0,i._)("p",null,[(0,i.Wm)(Pt,{onChange:function(t){return J.changePrdDefault(e,n)},checked:e.isDefault,"onUpdate:checked":function(t){return e.isDefault=t},size:"small"},null,8,["onChange","checked","onUpdate:checked"])])])])])]})),_:2},1024)})),128))]})),_:1})]})),_:1},8,["title","loading"])]})),_:1},8,["xl"]),""!=B.pid&&B.detail.chart?((0,i.wg)(),(0,i.j4)(St,{key:0,class:"pd-x-20",xl:10,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((function(){return["API"==B.type?((0,i.wg)(),(0,i.j4)($t,{key:0,class:"card mb-15 nopd overflowHidden",loading:B.loading,title:t.$t("Metrics")},{default:(0,i.w5)((function(){return[(0,i.Wm)(Ct,{colors:["#8be4c1"],height:200,id:B.pid,padding:[0,0,0,0],axis:!1,ver:B.screenWidth,showy:!1,dv:B.detail.chart},null,8,["id","ver","dv"])]})),_:1},8,["loading","title"])):(0,i.kq)("",!0),B.visiblelog?((0,i.wg)(),(0,i.j4)(jt,{key:1,"get-container":!1,title:t.$t("log"),placement:"bottom",height:"600",closable:!1,visible:B.visiblelog,onClose:J.hide},{default:(0,i.w5)((function(){return[(0,i.Wm)(Wt,{"is-readonly":!0,value:B.log},null,8,["value"])]})),_:1},8,["title","visible","onClose"])):(0,i.kq)("",!0)]})),_:1})):(0,i.kq)("",!0)]})),_:1})]})),_:1},8,["tab"])):(0,i.kq)("",!0),(0,i.Wm)(Ut,{key:"2",tab:t.$t("Policy")},{default:(0,i.w5)((function(){return[(0,i.Wm)(zt,{class:"pt-20 row-mg"},{default:(0,i.w5)((function(){return[(0,i.Wm)(St,{class:"col-pd",xl:"API"==B.type?18:24,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((function(){return["API"==B.type?((0,i.wg)(),(0,i.j4)(At,{key:0,dashed:""},{default:(0,i.w5)((function(){return[B.bindPolicy?((0,i.wg)(),(0,i.j4)(ot,{key:0,closable:"",onClose:J.resetPolicy},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Binding policy"))+"："+(0,a.zw)(B.bindPolicy.name),1)]})),_:1},8,["onClose"])):(0,i.kq)("",!0),B.bindPolicy?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(ot,{key:1},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Custom")),1)]})),_:1}))]})),_:1})):(0,i.kq)("",!0),(0,i._)("div",null,[(0,i.Wm)(Dt,{disabled:!("API"!=B.type||!B.bindPolicy),plugins:B.detail.content.plugins,"onUpdate:plugins":e[24]||(e[24]=function(t){return B.detail.content.plugins=t}),onAdd:J.showPluginBox,"add-text":t.$t("Add Plugin")},null,8,["disabled","plugins","onAdd","add-text"])])]})),_:1},8,["xl"]),"API"==B.type?((0,i.wg)(),(0,i.j4)(St,{key:0,class:"col-pd",xl:6,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((function(){return[(0,i.Wm)(At,{dashed:""},{default:(0,i.w5)((function(){return[(0,i.Wm)(ot,null,{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Select an existing policy")),1)]})),_:1})]})),_:1}),(0,i.Wm)(Et,{"hide-head":!0,onSelectPolicy:J.selectPolicy},null,8,["onSelectPolicy"])]})),_:1})):(0,i.kq)("",!0)]})),_:1})]})),_:1},8,["tab"]),(0,i.wy)((0,i.Wm)(Ut,{key:"3",tab:t.$t("Specs")},{default:(0,i.w5)((function(){return[(0,i.Wm)($t,{class:"card nopd"},{default:(0,i.w5)((function(){return[(0,i.Wm)(zt,{class:"row-mg"},{default:(0,i.w5)((function(){return[(0,i.Wm)(St,{class:"col-pd",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((function(){return[W]})),_:1}),(0,i.Wm)(St,{class:"col-pd",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((function(){return[(0,i.Wm)(Ot,{"is-create":B.editorIsCreate,jsonVal:B.detail.spec,"onUpdate:jsonVal":e[25]||(e[25]=function(t){return B.detail.spec=t}),onChange:J.swaggerchange,height:"800px",class:"mb-24"},null,8,["is-create","jsonVal","onChange"])]})),_:1})]})),_:1})]})),_:1})]})),_:1},8,["tab"]),[[l.F8,"API"==B.type]]),""!=B.pid&&"API"==B.type?((0,i.wg)(),(0,i.j4)(Ut,{key:"4",tab:t.$t("log")},{default:(0,i.w5)((function(){return[(0,i.Wm)(xt,{uid:B.pid,type:"api","log-level":B.detail.content.log.level,onSave:J.saveLogLevel},null,8,["uid","log-level","onSave"])]})),_:1},8,["tab"])):(0,i.kq)("",!0),"API"==B.type?((0,i.wg)(),(0,i.j4)(Ut,{key:"6",tab:t.$t("ACL")},{default:(0,i.w5)((function(){return[(0,i.Wm)(zt,{class:"row-mg"},{default:(0,i.w5)((function(){return[(0,i.Wm)(St,{class:"row-padding",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((function(){return[(0,i.Wm)($t,{title:t.$t("Service Black")},{default:(0,i.w5)((function(){return[(0,i.Wm)(It,{titles:[t.$t("Service")," "+t.$t("Added")],"data-source":B.black.list,"target-keys":B.detail.blacklistServices,"onUpdate:target-keys":e[26]||(e[26]=function(t){return B.detail.blacklistServices=t}),"show-search":!0,"filter-option":function(t,e){return-1!==e.name.indexOf(t)},"show-select-all":!1,onSearch:J.blackSearch,onChange:J.onBlackChange},{children:(0,i.w5)((function(e){var n=e.direction,l=e.filteredItems,o=e.selectedKeys,r=e.disabled,s=e.onItemSelectAll,u=e.onItemSelect;return[(0,i.Wm)(qt,{"row-selection":J.getRowSelection(r,o,s,u),columns:"left"===n?J.dataleftColumns:J.datarightColumns,"data-source":l,size:"small",pagination:"left"===n&&{onChange:J.blackPagging,current:B.black.pageNo,pageSize:B.black.pageSize,showTotal:function(e,n){return"".concat(t.$t("Total")," ").concat(e)},total:B.black.total},style:(0,a.j5)({pointerEvents:r?"none":null}),"custom-row":function(t){var e=t.key,n=t.disabled;return{onClick:function(){n||r||u(e,!o.includes(e))}}}},null,8,["row-selection","columns","data-source","pagination","style","custom-row"])]})),_:1},8,["titles","data-source","target-keys","filter-option","onSearch","onChange"])]})),_:1},8,["title"])]})),_:1}),(0,i.Wm)(St,{class:"col-pd",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((function(){return[(0,i.Wm)($t,{title:t.$t("Service White")},{default:(0,i.w5)((function(){return[(0,i.Wm)(It,{titles:[t.$t("Service")," "+t.$t("Added")],"data-source":B.white.list,"target-keys":B.detail.whitelistServices,"onUpdate:target-keys":e[27]||(e[27]=function(t){return B.detail.whitelistServices=t}),"show-search":!0,"filter-option":function(t,e){return-1!==e.name.indexOf(t)},"show-select-all":!1,onSearch:J.whiteSearch,onChange:J.onWhiteChange},{children:(0,i.w5)((function(e){var n=e.direction,l=e.filteredItems,o=e.selectedKeys,r=e.disabled,s=e.onItemSelectAll,u=e.onItemSelect;return[(0,i.Wm)(qt,{"row-selection":J.getRowSelection(r,o,s,u),columns:"left"===n?J.dataleftColumns:J.datarightColumns,"data-source":l,size:"small",pagination:"left"===n&&{onChange:J.whitePagging,current:B.white.pageNo,pageSize:B.white.pageSize,showTotal:function(e,n){return"".concat(t.$t("Total")," ").concat(e)},total:B.white.total},style:(0,a.j5)({pointerEvents:r?"none":null}),"custom-row":function(t){var e=t.key,n=t.disabled;return{onClick:function(){n||r||u(e,!o.includes(e))}}}},null,8,["row-selection","columns","data-source","pagination","style","custom-row"])]})),_:1},8,["titles","data-source","target-keys","filter-option","onSearch","onChange"])]})),_:1},8,["title"])]})),_:1})]})),_:1})]})),_:1},8,["tab"])):(0,i.kq)("",!0),""!=B.pid&&"API"==B.type?((0,i.wg)(),(0,i.j4)(Ut,{key:"7"},{tab:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Applications"))+" ",1),J.appliesCnt>0?((0,i.wg)(),(0,i.iD)("span",j,[(0,i.Wm)(Tt,{count:J.appliesCnt},null,8,["count"])])):(0,i.kq)("",!0)]})),default:(0,i.w5)((function(){return[(0,i.Wm)(zt,{class:"row-mg",gutter:16},{default:(0,i.w5)((function(){return[(0,i.Wm)(St,{class:"row-padding",xl:B.detail.approvalLevel>0?16:24,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((function(){return[(0,i.Wm)($t,{class:"card",title:t.$t("Applications")},{default:(0,i.w5)((function(){return[(0,i.Wm)(_t,{"item-layout":"horizontal","data-source":B.application.list,pagination:{onChange:J.searchApplications,current:B.application.pageNo,pageSize:B.application.pageSize,showTotal:function(e,n){return"".concat(t.$t("Total")," ").concat(e)},total:B.application.total}},{renderItem:(0,i.w5)((function(t){var e=t.item;return[(0,i.Wm)(kt,null,{actions:(0,i.w5)((function(){return[(0,i.Wm)(Nt,{class:"icon-menu rotate-icon",onClick:function(t){return J.removeSubApi(e)}},null,8,["onClick"])]})),default:(0,i.w5)((function(){return[(0,i.Wm)(mt,null,{title:(0,i.w5)((function(){return[(0,i._)("a",{onClick:function(t){return J.appDetail(e.id)}},(0,a.zw)(e.name),9,z)]})),avatar:(0,i.w5)((function(){return[(0,i.Wm)(Lt,{class:"CodeSandboxOutlined primary"})]})),description:(0,i.w5)((function(){return[e.project?((0,i.wg)(),(0,i.iD)("span",U,(0,a.zw)(e.project.organization?e.project.organization.name+" / ":"")+" "+(0,a.zw)(e.project.name),1)):((0,i.wg)(),(0,i.iD)("span",A,"-"))]})),_:2},1024)]})),_:2},1024)]})),_:1},8,["data-source","pagination"])]})),_:1},8,["title"])]})),_:1},8,["xl"]),B.detail.approvalLevel>0?((0,i.wg)(),(0,i.j4)(St,{key:0,class:"row-padding",xl:8,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((function(){return[(0,i.Wm)($t,null,{title:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Applies"))+" ",1),J.appliesCnt>0?((0,i.wg)(),(0,i.iD)("span",D,[(0,i.Wm)(Tt,{count:J.appliesCnt},null,8,["count"])])):(0,i.kq)("",!0)]})),default:(0,i.w5)((function(){return[(0,i.Wm)(_t,{"item-layout":"vertical","data-source":B.applies.list,pagination:{onChange:J.searchApplies,current:B.applies.pageNo,pageSize:B.applies.pageSize,showTotal:function(e,n){return"".concat(t.$t("Total")," ").concat(e)},total:B.applies.total}},{renderItem:(0,i.w5)((function(e){var n=e.item;return[(0,i.Wm)(kt,null,{extra:(0,i.w5)((function(){return[0==n.status?((0,i.wg)(),(0,i.iD)("div",E,[(0,i._)("a",{href:"javascript:void(0)",onClick:function(t){return J.refuseApply(n)}},[(0,i.Wm)(Rt,{class:"icon-menu"})],8,O),(0,i._)("a",{href:"javascript:void(0)",onClick:function(t){return J.approvalApply(n)},class:"ml-15"},[(0,i.Wm)(Ht,{class:"icon-menu"})],8,x)])):(0,i.kq)("",!0)]})),default:(0,i.w5)((function(){return[(0,i.Wm)(mt,null,{description:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(new Date(n.updatedAt).toLocaleString())+" ("+(0,a.zw)(n.applyUser.username)+") "+(0,a.zw)(t.$t("applies for subscription")),1)]})),title:(0,i.w5)((function(){return[(0,i._)("b",null,(0,a.zw)(n.application?n.application.name:""),1)]})),avatar:(0,i.w5)((function(){return[(0,i.Wm)(Vt,{class:"primary"})]})),_:2},1024),(0,i._)("div",null,[(0,i._)("div",{class:"relative vm",style:(0,a.j5)([{left:"15px"},"width:"+120*B.detail.approvalLevel+"px"])},[(0,i.Wm)(et,{current:n.approvalStep,size:"small",status:["process","finish","error"][n.status]},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(J.findApprovalLevel.approvalRoles,(function(t,e){return(0,i.wg)(),(0,i.j4)(Q,{class:"pb-10",key:e,title:t.label},(0,i.Nv)({_:2},[e<=n.approvalStep&&n.content&&n.content.history&&n.content.history[e]?{name:"description",fn:(0,i.w5)((function(){return[n.content.history[e].user?((0,i.wg)(),(0,i.iD)("div",q,[(0,i._)("b",null,(0,a.zw)(n.content.history[e].user.username),1)])):(0,i.kq)("",!0),n.content.history[e].time?((0,i.wg)(),(0,i.iD)("div",I,(0,a.zw)(n.content.history[e].time),1)):(0,i.kq)("",!0)]})),key:"0"}:void 0]),1032,["title"])})),128))]})),_:2},1032,["current","status"])],4)])]})),_:2},1024)]})),_:1},8,["data-source","pagination"])]})),_:1})]})),_:1})):(0,i.kq)("",!0)]})),_:1})]})),_:1})):(0,i.kq)("",!0),""!=B.pid&&"API"==B.type?((0,i.wg)(),(0,i.j4)(Ut,{key:"5",tab:t.$t("Dashboard")},{default:(0,i.w5)((function(){return[(0,i.Wm)(Zt,{"page-id":B.pid,apply:"openapi","default-widget":B.DEFAULT_API_DETAIL,"hide-add":"5"!=B.activeKey},null,8,["page-id","default-widget","hide-add"])]})),_:1},8,["tab"])):(0,i.kq)("",!0)]})),_:1},8,["activeKey"])]})),_:1})]})),_:1})]})),_:2},[void 0,n.embed?void 0:{name:"action",fn:(0,i.w5)((function(){return[""!=B.pid?(0,i.wy)(((0,i.wg)(),(0,i.j4)(dt,{key:0,type:"default",onClick:J.validate},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("save")),1)]})),_:1},8,["onClick"])),[[ee,[B.detail.project?"api:update:project:"+B.detail.project:"api:update"]]]):(0,i.wy)(((0,i.wg)(),(0,i.j4)(dt,{key:1,type:"primary",onClick:J.validate},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("create")),1)]})),_:1},8,["onClick"])),[[ee,[B.detail.project?"api:create:project:"+B.detail.project:"api:create"]]]),(0,i.Wm)(ft,{title:t.$t("Review"),trigger:"click",visible:B.visibleReview,"onUpdate:visible":e[11]||(e[11]=function(t){return B.visibleReview=t})},{content:(0,i.w5)((function(){return[(0,i.Wm)(pt,{value:B.description2,"onUpdate:value":e[9]||(e[9]=function(t){return B.description2=t}),placeholder:t.$t("Description"),"auto-size":{minRows:2,maxRows:5}},null,8,["value","placeholder"]),(0,i.Wm)(dt,{type:"primary",onClick:e[10]||(e[10]=function(t){return J.toReview(B.description2,0)}),class:"mt-8"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Submit")),1)]})),_:1})]})),default:(0,i.w5)((function(){return[""==B.pid||0!=B.detail.step&&2!=B.detail.step?(0,i.kq)("",!0):(0,i.wy)(((0,i.wg)(),(0,i.j4)(dt,{key:0,type:"primary",class:"ml-8"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Review")),1)]})),_:1})),[[ee,["api:update"]]])]})),_:1},8,["title","visible"]),(0,i.Wm)(ft,{title:t.$t("Revise"),trigger:"click",visible:B.visibleRevise,"onUpdate:visible":e[14]||(e[14]=function(t){return B.visibleRevise=t})},{content:(0,i.w5)((function(){return[(0,i.Wm)(pt,{value:B.description1,"onUpdate:value":e[12]||(e[12]=function(t){return B.description1=t}),placeholder:t.$t("Description"),"auto-size":{minRows:2,maxRows:5}},null,8,["value","placeholder"]),(0,i.Wm)(dt,{type:"primary",onClick:e[13]||(e[13]=function(t){return J.toRevise(B.description1,1)}),class:"mt-8"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Submit")),1)]})),_:1})]})),default:(0,i.w5)((function(){return[""!=B.pid&&1==B.detail.step?(0,i.wy)(((0,i.wg)(),(0,i.j4)(dt,{key:0,type:"danger",class:"ml-8"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Revise")),1)]})),_:1})),[[ee,["api:update"]]]):(0,i.kq)("",!0)]})),_:1},8,["title","visible"]),(0,i.Wm)(ft,{title:t.$t("Deploy"),trigger:"click",visible:B.visibleDeploy,"onUpdate:visible":e[17]||(e[17]=function(t){return B.visibleDeploy=t})},{content:(0,i.w5)((function(){return[(0,i.Wm)(pt,{value:B.description3,"onUpdate:value":e[15]||(e[15]=function(t){return B.description3=t}),placeholder:t.$t("Description"),"auto-size":{minRows:2,maxRows:5}},null,8,["value","placeholder"]),(0,i.Wm)(dt,{type:"primary",onClick:e[16]||(e[16]=function(t){return J.toDeploy(B.description3,2)}),class:"mt-8"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Submit")),1)]})),_:1})]})),default:(0,i.w5)((function(){return[""!=B.pid&&1==B.detail.step?(0,i.wy)(((0,i.wg)(),(0,i.j4)(dt,{key:0,type:"primary",class:"ml-8"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Deploy")),1)]})),_:1})),[[ee,["api:update"]]]):(0,i.kq)("",!0)]})),_:1},8,["title","visible"]),(0,i.Wm)(ft,{title:t.$t("Stop"),trigger:"click",visible:B.visibleStop,"onUpdate:visible":e[20]||(e[20]=function(t){return B.visibleStop=t})},{content:(0,i.w5)((function(){return[(0,i.Wm)(pt,{value:B.description4,"onUpdate:value":e[18]||(e[18]=function(t){return B.description4=t}),placeholder:t.$t("Description"),"auto-size":{minRows:2,maxRows:5}},null,8,["value","placeholder"]),(0,i.Wm)(dt,{type:"primary",onClick:e[19]||(e[19]=function(t){return J.toStop(B.description4,3)}),class:"mt-8"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Submit")),1)]})),_:1})]})),default:(0,i.w5)((function(){return[""!=B.pid&&2==B.detail.step?(0,i.wy)(((0,i.wg)(),(0,i.j4)(dt,{key:0,type:"danger",class:"ml-8"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Stop")),1)]})),_:1})),[[ee,["api:update"]]]):(0,i.kq)("",!0)]})),_:1},8,["title","visible"]),(0,i.Wm)(ft,{title:t.$t("Restart"),trigger:"click",visible:B.visibleRestart,"onUpdate:visible":e[23]||(e[23]=function(t){return B.visibleRestart=t})},{content:(0,i.w5)((function(){return[(0,i.Wm)(pt,{value:B.description3,"onUpdate:value":e[21]||(e[21]=function(t){return B.description3=t}),placeholder:t.$t("Description"),"auto-size":{minRows:2,maxRows:5}},null,8,["value","placeholder"]),(0,i.Wm)(dt,{type:"primary",onClick:e[22]||(e[22]=function(t){return J.toRestart(B.description3,2)}),class:"mt-8"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Submit")),1)]})),_:1})]})),default:(0,i.w5)((function(){return[""!=B.pid&&3==B.detail.step?(0,i.wy)(((0,i.wg)(),(0,i.j4)(dt,{key:0,type:"primary",class:"ml-8"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Restart")),1)]})),_:1})),[[ee,["api:update"]]]):(0,i.kq)("",!0)]})),_:1},8,["title","visible"])]})),key:"1"}]),1032,["hide-breadcrumb","title","form-state"]),(0,i.Wm)(Qt,{"destroy-on-close":!0,visible:B.visibleEndpoint,"onUpdate:visible":e[35]||(e[35]=function(t){return B.visibleEndpoint=t}),title:t.$t("Endpoint"),onOk:J.validForm,width:"70%","cancel-text":t.$t("cancel"),"ok-text":t.isEdit?t.$t("Save"):t.$t("create")},{default:(0,i.w5)((function(){return[(0,i.Wm)(Gt,{model:B.payloadEndpoint,"wrapper-col":{span:24},ref:"form"},{default:(0,i.w5)((function(){return[(0,i.Wm)(Jt,{bordered:""},{default:(0,i.w5)((function(){return[(0,i.Wm)(Ft,{label:t.$t("Protocol")},{default:(0,i.w5)((function(){return[(0,i.Wm)(lt,{mode:"multiple",placeholder:t.$t("unset"),class:"width-200",value:B.payloadEndpoint.protocols,"onUpdate:value":e[29]||(e[29]=function(t){return B.payloadEndpoint.protocols=t})},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.protocols,(function(t,e){return(0,i.wg)(),(0,i.j4)(at,{key:e,value:t},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["placeholder","value"])]})),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("method"),span:2},{default:(0,i.w5)((function(){return[(0,i.Wm)(lt,{mode:"multiple",placeholder:t.$t("unset"),class:"width-300",value:B.payloadEndpoint.methods,"onUpdate:value":e[30]||(e[30]=function(t){return B.payloadEndpoint.methods=t}),onChange:t.changeMethods},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.methods,(function(t,e){return(0,i.wg)(),(0,i.j4)(at,{key:e,value:t},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["placeholder","value","onChange"])]})),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("Host"),span:1},{default:(0,i.w5)((function(){return[(0,i.Wm)(pt,{value:B.payloadEndpoint.host,"onUpdate:value":e[31]||(e[31]=function(t){return B.payloadEndpoint.host=t}),placeholder:t.$t("unset"),"allow-clear":"",rows:4},null,8,["value","placeholder"])]})),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("paths"),span:2},{default:(0,i.w5)((function(){return[(0,i.Wm)(pt,{value:B.payloadEndpoint.path,"onUpdate:value":e[32]||(e[32]=function(t){return B.payloadEndpoint.path=t}),placeholder:t.$t("unset"),"allow-clear":"",rows:4},null,8,["value","placeholder"])]})),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("Custom path"),span:3},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.payloadEndpoint.customPaths,(function(e,n){return(0,i.wg)(),(0,i.iD)("div",{key:n,class:"flex mb-10 pd-10"},[(0,i._)("text",T,(0,a.zw)(t.$t("path")),1),(0,i.Wm)(Mt,{name:["customPaths",n,"path"],rules:t.rules.arrayRequired},{default:(0,i.w5)((function(){return[(0,i.Wm)(lt,{placeholder:t.$t("path"),class:"ml-10 width-200",value:e.path,"onUpdate:value":function(t){return e.path=t},mode:"multiple"},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.payloadEndpoint.path.split("\n"),(function(t,e){return(0,i.wg)(),(0,i.j4)(at,{key:e,value:t},{default:(0,i.w5)((function(){return[t?((0,i.wg)(),(0,i.iD)("span",L,(0,a.zw)(t),1)):(0,i.kq)("",!0),t?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("i",N,(0,a.zw)(t),1))]})),_:2},1032,["value"])})),128))]})),_:2},1032,["placeholder","value","onUpdate:value"])]})),_:2},1032,["name","rules"]),(0,i._)("text",V,(0,a.zw)(t.$t("Provider")),1),(0,i.Wm)(Mt,{name:["customPaths",n,"providers"],rules:t.rules.arrayRequired},{default:(0,i.w5)((function(){return[(0,i.Wm)(lt,{placeholder:t.$t("Provider"),class:"ml-10 width-200",value:e.providers,"onUpdate:value":function(t){return e.providers=t},mode:"multiple"},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.detail.content.providers,(function(t,e){return(0,i.wg)(),(0,i.j4)(at,{key:e,value:t.name},{default:(0,i.w5)((function(){return[t.name?((0,i.wg)(),(0,i.iD)("span",R,(0,a.zw)(t.name),1)):(0,i.kq)("",!0),t.name?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("i",H,(0,a.zw)(t.name),1))]})),_:2},1032,["value"])})),128))]})),_:2},1032,["placeholder","value","onUpdate:value"])]})),_:2},1032,["name","rules"]),(0,i._)("text",Z,(0,a.zw)(t.$t("Rewrite path")),1),(0,i.Wm)(it,{value:e.oldPath,"onUpdate:value":function(t){return e.oldPath=t},placeholder:t.$t("Old path"),class:"width-150"},null,8,["value","onUpdate:value","placeholder"]),K,(0,i.Wm)(it,{value:e.newPath,"onUpdate:value":function(t){return e.newPath=t},placeholder:t.$t("New path"),class:"width-150"},null,8,["value","onUpdate:value","placeholder"]),(0,i._)("div",Y,[(0,i.Wm)(Bt,{class:"font-20 ml-10 two-tone",onClick:function(t){return J.removeCustompath(e)},"two-tone-color":"#00adef"},null,8,["onClick"])])])})),128)),(0,i.Wm)(ht,{class:"font-20 ml-10 two-tone",onClick:J.addCustompath,"two-tone-color":"#00adef"},null,8,["onClick"])]})),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("Strip Path")},{default:(0,i.w5)((function(){return[(0,i.Wm)(G,{title:t.$t("Strip Path Tip")},{default:(0,i.w5)((function(){return[(0,i.Wm)(Pt,{checked:B.payloadEndpoint.stripPath,"onUpdate:checked":e[33]||(e[33]=function(t){return B.payloadEndpoint.stripPath=t})},null,8,["checked"])]})),_:1},8,["title"])]})),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("Preserve Host")},{default:(0,i.w5)((function(){return[(0,i.Wm)(G,{title:t.$t("Preserve Host Tip")},{default:(0,i.w5)((function(){return[(0,i.Wm)(Pt,{checked:B.payloadEndpoint.preserveHost,"onUpdate:checked":e[34]||(e[34]=function(t){return B.payloadEndpoint.preserveHost=t})},null,8,["checked"])]})),_:1},8,["title"])]})),_:1},8,["label"])]})),_:1})]})),_:1},8,["model"])]})),_:1},8,["visible","title","onOk","cancel-text","ok-text"]),(0,i.Wm)(Qt,{"destroy-on-close":!0,visible:B.visibleProvider,"onUpdate:visible":e[44]||(e[44]=function(t){return B.visibleProvider=t}),title:t.$t("Provider"),onOk:J.validProvider,width:"70%","cancel-text":t.$t("cancel"),"ok-text":t.isEdit?t.$t("Save"):t.$t("create")},{default:(0,i.w5)((function(){return[(0,i.Wm)(Gt,{model:B.payloadProvider,"wrapper-col":{span:24},ref:"providerForm"},{default:(0,i.w5)((function(){return[(0,i.Wm)(Jt,{bordered:""},{default:(0,i.w5)((function(){return[(0,i.Wm)(Ft,{label:t.$t("as"),span:3},{default:(0,i.w5)((function(){return[(0,i.Wm)(Mt,{name:"name",rules:t.rules.name},{default:(0,i.w5)((function(){return[(0,i.Wm)(it,{placeholder:t.$t("unset"),value:B.payloadProvider.name,"onUpdate:value":e[36]||(e[36]=function(t){return B.payloadProvider.name=t}),class:"width-300"},null,8,["placeholder","value"])]})),_:1},8,["rules"])]})),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("Type"),span:1},{default:(0,i.w5)((function(){return[(0,i.Wm)(lt,{placeholder:t.$t("unset"),class:"width-300",value:B.payloadProvider.type,"onUpdate:value":e[37]||(e[37]=function(t){return B.payloadProvider.type=t})},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.types,(function(t,e){return(0,i.wg)(),(0,i.j4)(at,{key:e,value:t},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["placeholder","value"])]})),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("Protocol"),span:2},{default:(0,i.w5)((function(){return[(0,i.Wm)(lt,{mode:"multiple",placeholder:t.$t("unset"),class:"width-200",value:B.payloadProvider.protocols,"onUpdate:value":e[38]||(e[38]=function(t){return B.payloadProvider.protocols=t})},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.protocols,(function(t,e){return(0,i.wg)(),(0,i.j4)(at,{key:e,value:t},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["placeholder","value"])]})),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t(B.payloadProvider.type),span:1},{default:(0,i.w5)((function(){return["Host"==B.payloadProvider.type?((0,i.wg)(),(0,i.iD)("div",F,[(0,i.Wm)(Mt,{name:"hosts",rules:t.rules.arrayRequired},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.payloadProvider.hosts||[],(function(t,e){return(0,i.wg)(),(0,i.j4)(ot,{key:e,onClose:(0,l.iM)((function(t){return J.handleArrayClose(B.payloadProvider.hosts,e)}),["prevent"]),closable:""},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t),1)]})),_:2},1032,["onClose"])})),128)),(0,i.wy)((0,i.Wm)(it,{ref:"hostRef",type:"text",size:"small",class:"width-300",placeholder:t.$t("unset"),value:B.hostValue,"onUpdate:value":e[39]||(e[39]=function(t){return B.hostValue=t}),onBlur:J.hostInputConfirm,onKeyup:(0,l.D2)(J.hostInputConfirm,["enter"])},null,8,["placeholder","value","onBlur","onKeyup"]),[[l.F8,B.hostVisible]]),B.hostVisible?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(ot,{key:0,onClick:J.hostShowInput,class:"dashed-tag"},{default:(0,i.w5)((function(){return[(0,i.Wm)(rt),(0,i.Uk)(" "+(0,a.zw)(t.$t("add")),1)]})),_:1},8,["onClick"]))]})),_:1},8,["rules"])])):(0,i.kq)("",!0),"Upstream"==B.payloadProvider.type?((0,i.wg)(),(0,i.j4)(Mt,{key:1,name:"upstreamId",rules:t.rules.required},{default:(0,i.w5)((function(){return["Upstream"==B.payloadProvider.type?((0,i.wg)(),(0,i.iD)("div",M,[B.payloadProvider.upstream&&B.payloadProvider.upstream.name?((0,i.wg)(),(0,i.j4)(ot,{key:0,closable:"",onClose:J.clearSelector},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(B.payloadProvider.upstream.content.displayName||B.payloadProvider.upstream.name),1)]})),_:1},8,["onClose"])):(0,i.kq)("",!0),(0,i.Wm)(Xt,{width:500,search:!0,placement:"right",icon:B.RiseOutlined,col:2,onSelect:J.saveSelector,"get-tag":function(t){return t.content&&t.name!=t.content.displayName?t.content.displayName:null},options:B.upstreams},{default:(0,i.w5)((function(){return[(0,i._)("a",null,[(0,i.Wm)(ot,{color:"#00adef",key:"submit",type:"primary"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(B.payloadProvider.upstream?t.$t("select"):t.$t("unset")),1)]})),_:1})])]})),_:1},8,["icon","onSelect","get-tag","options"])])):(0,i.kq)("",!0)]})),_:1},8,["rules"])):(0,i.kq)("",!0),"Function"==B.payloadProvider.type?((0,i.wg)(),(0,i.j4)(Mt,{key:2,name:"content",rules:t.rules.required},{default:(0,i.w5)((function(){return["Function"==B.payloadProvider.type?((0,i.wg)(),(0,i.j4)(lt,{key:0,placeholder:t.$t("unset"),class:"width-300",value:B.payloadProvider.content,"onUpdate:value":e[40]||(e[40]=function(t){return B.payloadProvider.content=t})},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.functions,(function(t,e){return(0,i.wg)(),(0,i.j4)(at,{key:e,value:t},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["placeholder","value"])):(0,i.kq)("",!0)]})),_:1},8,["rules"])):(0,i.kq)("",!0),"Zone"==B.payloadProvider.type?((0,i.wg)(),(0,i.j4)(Mt,{key:3,name:"content",rules:t.rules.required},{default:(0,i.w5)((function(){return["Zone"==B.payloadProvider.type?((0,i.wg)(),(0,i.j4)(lt,{key:0,placeholder:t.$t("unset"),class:"width-300",value:B.payloadProvider.content,"onUpdate:value":e[41]||(e[41]=function(t){return B.payloadProvider.content=t})},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.zones,(function(t,e){return(0,i.wg)(),(0,i.j4)(at,{key:e,value:t},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["placeholder","value"])):(0,i.kq)("",!0)]})),_:1},8,["rules"])):(0,i.kq)("",!0)]})),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("path"),span:2},{default:(0,i.w5)((function(){return[(0,i.Wm)(it,{placeholder:t.$t("unset"),value:B.payloadProvider.path,"onUpdate:value":e[42]||(e[42]=function(t){return B.payloadProvider.path=t}),class:"width-300"},null,8,["placeholder","value"])]})),_:1},8,["label"]),(0,i.Wm)(Ft,{label:t.$t("Versions"),span:3},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(B.payloadProvider.versions||[],(function(t,e){return(0,i.wg)(),(0,i.j4)(ot,{key:e,onClose:(0,l.iM)((function(t){return J.handleArrayClose(B.payloadProvider.versions,e)}),["prevent"]),closable:""},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t),1)]})),_:2},1032,["onClose"])})),128)),(0,i.wy)((0,i.Wm)(it,{ref:"versionRef",type:"text",size:"small",class:"width-300",placeholder:"SNAPSHOT:"+B.payloadProvider.name+"-SNAPSHOT (eg)",value:B.versionValue,"onUpdate:value":e[43]||(e[43]=function(t){return B.versionValue=t}),onBlur:J.versionInputConfirm,onKeyup:(0,l.D2)(J.versionInputConfirm,["enter"])},null,8,["placeholder","value","onBlur","onKeyup"]),[[l.F8,B.versionVisible]]),B.versionVisible?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(ot,{key:0,onClick:J.versionShowInput,class:"dashed-tag"},{default:(0,i.w5)((function(){return[(0,i.Wm)(rt),(0,i.Uk)(" "+(0,a.zw)(t.$t("add")),1)]})),_:1},8,["onClick"]))]})),_:1},8,["label"])]})),_:1})]})),_:1},8,["model"])]})),_:1},8,["visible","title","onOk","cancel-text","ok-text"]),(0,i.Wm)(Qt,{footer:null,width:800,visible:B.visibleAP,"onUpdate:visible":e[45]||(e[45]=function(t){return B.visibleAP=t}),title:t.$t("Add Plugin"),onOk:t.handleOk},{default:(0,i.w5)((function(){return[(0,i.Wm)(te,{onSelectPlugin:J.selectPlugin,"hide-head":!0},null,8,["onSelectPlugin"])]})),_:1},8,["visible","title","onOk"]),(0,i.kq)("",!0)],64)}],["__scopeId","data-v-769f7a1a"]])},77809:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return z}});n(74916),n(64765),n(68309);var i=n(66252),a=n(3577),l=n(49963),o={class:"search-input"},r={class:"content flex"},s={class:"flex-item"},u={class:"form-row"},c={class:"label"},d={class:"content"},p={class:"width-200"},f={class:"search-content"},h={class:"project-selection"},m={class:"font-22"},v={class:"font-16"},w={class:"font-20 primary"},g={class:"mb-3"},y={key:0,class:"blockquote"};var b=n(95082),k=(n(57658),n(92222),n(71900)),_=n(92246),$=n(99684),P=n(33907),S=n(69596),C=n(61103),W=n(85263),j={name:"ApiList",i18n:n(89234),components:{BulbOutlined:_.Z,PageLayout:C.Z,CardList:S.Z,PlusCircleTwoTone:$.Z,HeadInfo:k.Z},props:["hideHead"],data:function(){return{pageSize:12,pageNo:1,total:0,key:"",filterApp:"",simpleImage:W.Z.PRESENTED_IMAGE_SIMPLE,visible:!1,visible2:!1,showApp:!1,projects:[],json:"{}",policyType:["Sign Encrypt","Encrypt Attestation","Decrypt","Encrypt","Forward Proxy"],policies:[],viewtypevalue:0,viewtypeproject:null,viewtype:[{value:0,label:"All"},{value:1,label:"Goup By Project"}],loading:!0}},computed:(0,b.Z)((0,b.Z)({},(0,P.rn)("setting",["layout","pageWidth"])),{},{start:function(){return(this.pageNo-1)*this.pageSize}}),mounted:function(){this.search()},methods:{addpolicy:function(){this.$router.push({path:"/openapi/policy/create"})},detail:function(t,e,n){this.$router.push({path:"/openapi/policy/detail/"+n.id})},remove:function(t,e,n){var i=this;this.$gql.mutation("deletePolicy(id:".concat(n.id,"){data{id}}")).then((function(){i.$message.success(i.$t("Deleted successfully"),3),i.search()}))},search:function(t){var e=this;this.pageNo=t||1,this.loading=!0;var n={name:{contains:this.key}};this.$gql.query("policies(filters: $filters, pagination: {start: ".concat(this.start,", limit: ").concat(this.pageSize,"}){\n\t\t\t\t\t\tdata{id,attributes{name,project{data{id,attributes{name}}},content,updatedAt}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}"),{filters:n},{filters:"PolicyFiltersInput"}).then((function(t){e.policies=t.data,e.total=t.pagination.total,e.loading=!1}))},searchProject:function(t){var e=this;this.pageNo=t||1,this.loading=!0,this.$gql.query("projects(filters: $filters, pagination: {start: ".concat(this.start,", limit: ").concat(this.pageSize,"}){data{id,attributes{\n\t\t\t\t\t\tname,\n\t\t\t\t\t\tapis{data{id,attributes{name}}},\n\t\t\t\t\t\tcontent,\n\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t}}}")).then((function(t){e.projects=t.data,e.loading=!1}))},select:function(t,e,n){this.$emit("selectPolicy",n)},getData:function(){}}};var z=(0,n(83744).Z)(j,[["render",function(t,e,n,b,k,_){var $=(0,i.up)("a-input-search"),P=(0,i.up)("a-radio-button"),S=(0,i.up)("a-radio-group"),C=(0,i.up)("a-tag"),W=(0,i.up)("a-form-item"),j=(0,i.up)("a-form"),z=(0,i.up)("PlusCircleTwoTone"),U=(0,i.up)("HeadInfo"),A=(0,i.up)("a-card"),D=(0,i.up)("a-col"),E=(0,i.up)("a-row"),O=(0,i.up)("BulbOutlined"),x=(0,i.up)("a-card-meta"),q=(0,i.up)("a-badge"),I=(0,i.up)("CardList"),T=(0,i.up)("a-pagination"),L=(0,i.up)("PageLayout"),N=(0,i.Q2)("permission");return(0,i.wg)(),(0,i.j4)(L,{title:t.$t("Policy"),"hide-head":n.hideHead,style:(0,a.j5)(n.hideHead?"padding-top:0 ;":"")},{headerContent:(0,i.w5)((function(){return[(0,i._)("div",{class:(0,a.C_)(["search-head",t.layout,t.pageWidth])},[(0,i._)("div",o,[(0,i.Wm)($,{value:k.key,"onUpdate:value":e[0]||(e[0]=function(t){return k.key=t}),class:"search-ipt",onSearch:e[1]||(e[1]=function(t){return _.search()}),placeholder:t.$t("Please input")+"...",size:"large"},null,8,["value","placeholder"])]),(0,i.Wm)(A,{bordered:!1,class:"search-form"},{default:(0,i.w5)((function(){return[(0,i._)("div",r,[(0,i._)("div",s,[(0,i.Wm)(j,null,{default:(0,i.w5)((function(){return[(0,i._)("div",u,[(0,i._)("div",c,[(0,i._)("span",null,(0,a.zw)(t.$t("Card View")),1)]),(0,i._)("div",d,[(0,i.Wm)(W,null,{default:(0,i.w5)((function(){return[(0,i.Wm)(S,{size:"small",onChange:t.changeView,value:k.viewtypevalue,"onUpdate:value":e[2]||(e[2]=function(t){return k.viewtypevalue=t}),"button-style":"solid"},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(k.viewtype,(function(e,n){return(0,i.wg)(),(0,i.j4)(P,{value:e.value,key:n},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t(e.label)),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["onChange","value"]),k.viewtypeproject?((0,i.wg)(),(0,i.j4)(C,{key:0,class:"ml-10",closable:"",onClose:t.removeViewtypeproject},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(k.viewtypeproject.name),1)]})),_:1},8,["onClose"])):(0,i.kq)("",!0)]})),_:1})])])]})),_:1})]),(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",p,[(0,i.Wm)(U,{class:"pd-0 split-right",title:t.$t("Create policy")},{body:(0,i.w5)((function(){return[(0,i._)("div",null,[(0,i.Wm)(z,{onClick:_.addpolicy,class:"font-primary icon-menu rotate-icon"},null,8,["onClick"])])]})),_:1},8,["title"])])),[[N,["policy:create"]]])])]})),_:1})],2)]})),default:(0,i.w5)((function(){return[(0,i._)("div",f,[(0,i.wy)((0,i.Wm)(E,{gutter:[16,8],class:"mb-10"},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(k.projects,(function(e,n){return(0,i.wg)(),(0,i.j4)(D,{key:n,span:4,onClick:function(n){return t.filterData(e)}},{default:(0,i.w5)((function(){return[(0,i._)("div",h,[(0,i._)("p",m,(0,a.zw)(e.name),1),(0,i._)("p",v,[(0,i.Uk)(" API "),(0,i._)("span",w,(0,a.zw)(e.policies.length),1),(0,i.Uk)(" "+(0,a.zw)(t.$t("unitge")),1)])])]})),_:2},1032,["onClick"])})),128))]})),_:1},512),[[l.F8,1==k.viewtypevalue&&!k.viewtypeproject]]),(0,i.wy)((0,i.Wm)(I,{"result-empty":{status:404,title:t.$t("No data")},col:n.hideHead?1:null,loading:k.loading,"data-source":k.policies,"hide-action-title":!n.hideHead,type:"component",actions:n.hideHead?[{icon:"SelectOutlined",text:t.$t("Selector"),call:_.select}]:[{icon:"EditOutlined",text:t.$t("edit"),call:_.detail},{icon:"DeleteOutlined",text:t.$t("delete"),call:_.remove,hide:!0}]},{default:(0,i.w5)((function(t){var e=t.item;return[(0,i.Wm)(x,null,{title:(0,i.w5)((function(){return[(0,i._)("div",g,[(0,i.Uk)((0,a.zw)(e.name)+" ",1),e.project?((0,i.wg)(),(0,i.j4)(C,{key:0,color:"pink",class:"result-tag"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(e.project.name),1)]})),_:2},1024)):(0,i.kq)("",!0)])]})),avatar:(0,i.w5)((function(){return[(0,i.Wm)(O,{class:"primary"})]})),description:(0,i.w5)((function(){return[]})),_:2},1024),e.content&&e.content.plugins?((0,i.wg)(),(0,i.iD)("blockquote",y,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.content.plugins,(function(t,e){return(0,i.wg)(),(0,i.iD)("span",{key:e,class:"mr-20 nowrap"},[(0,i.Wm)(q,{status:t.switch?"processing":"orange"},null,8,["status"]),(0,i.Uk)(" "+(0,a.zw)(t.content.displayName),1)])})),128))])):(0,i.kq)("",!0)]})),_:1},8,["result-empty","col","loading","data-source","hide-action-title","actions"]),[[l.F8,0==k.viewtypevalue||k.viewtypeproject]]),(0,i.wy)((0,i.Wm)(T,{onChange:_.searchProject,current:k.pageNo,"onUpdate:current":e[3]||(e[3]=function(t){return k.pageNo=t}),total:k.total,"page-size":k.pageSize,"show-less-items":""},null,8,["onChange","current","total","page-size"]),[[l.F8,1==k.viewtypevalue&&!k.viewtypeproject]]),(0,i.wy)((0,i.Wm)(T,{onChange:_.search,current:k.pageNo,"onUpdate:current":e[4]||(e[4]=function(t){return k.pageNo=t}),total:k.total,"page-size":k.pageSize,"show-less-items":""},null,8,["onChange","current","total","page-size"]),[[l.F8,0==k.viewtypevalue||k.viewtypeproject]])])]})),_:1},8,["title","hide-head","style"])}],["__scopeId","data-v-ac71bda6"]])}}]);