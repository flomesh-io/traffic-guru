"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[7461],{9280:function(t,e,n){n.d(e,{Z:function(){return c}});var a=n(66252),i=(0,a._)("div",{id:"DataChart",class:"height-500"},null,-1),r=(0,a._)("div",{id:"PercentilesChart",class:"height-500"},null,-1);n(38862),n(41539),n(54747),n(57658);var s=n(21936),l=n(3336);n(92222),n(68309);function o(t,e){var n=document.getElementById(t.id);n&&e.dispose(n);var a,i=e.init(n);(a={title:{text:t.title},tooltip:t.tooltip,legend:{data:t.legend},grid:{left:"3%",right:"4%",bottom:t.hasZoom?"60px":"10px",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},dataZoom:t.hasZoom?[{type:"slider",start:0,end:100,labelFormatter:function(e){return Math.ceil(100*e/t.xAxisLength)+"%"}}]:null,xAxis:t.xAxis,yAxis:{boundaryGap:!0,name:t.yAxis.name,type:"value"},series:t.series})&&"object"===(0,l.Z)(a)&&i.setOption(a)}var u={name:"TestReportContent",i18n:n(89234),components:{JsonEditor:s.Z},props:["reports"],data:function(){return{}},computed:{logStringify:function(){return this.reports?JSON.stringify(this.reports):"{}"}},mounted:function(){var t,e,n,a,i,r=[];this.reports.forEach((function(t){1==t.status&&r.push(t.content)})),t=r,e=this.$echarts,n=[],a=[],i=[],t&&t.forEach((function(t){if(t.DurationHistogram&&t.DurationHistogram.Percentiles){i=[];var e=[];e.push({value:0}),i.push(0),t.DurationHistogram.Percentiles.forEach((function(t){e.push({value:1e3*t.Value}),i.push(t.Percentile)}));var r="pipy-".concat(t.StartTime.split(".")[0]);a.push(r),n.push({name:r,type:"line",areaStyle:{},smooth:!0,data:e})}})),o({id:"PercentilesChart",title:"Latency P99",legend:a,tooltip:{trigger:"axis"},xAxis:{data:i,name:"(%)",boundaryGap:!1,type:"category"},yAxis:{name:"(ms)"},series:n},e),function(t,e){var n=[],a=[],i=0;t&&t.forEach((function(t){if(t.DurationHistogram&&t.DurationHistogram.Data){var e=[];t.DurationHistogram.Data.forEach((function(t){var n=Math.ceil(1e3*t.Start),a=Math.ceil(1e3*t.End);e.push({type:"start",value:[n,t.Count],start:n,end:a,lantency:a-n,count:t.Count,percent:Math.ceil(t.Percent)}),e.push({type:"end",value:[a,t.Count],start:n,end:a,lantency:a-n,count:t.Count,percent:Math.ceil(t.Percent)}),i<a&&(i=a)}));var r="pipy-".concat(t.StartTime.split(".")[0]);a.push(r),n.push({name:r,type:"line",symbol:"none",areaStyle:{},smooth:!1,data:e})}})),o({id:"DataChart",title:"TPS",hasZoom:!0,legend:a,tooltip:{trigger:"axis",formatter:function(t){var e="";return t.forEach((function(t){"end"==t.data.type&&(e+='<span style="background:'.concat(t.color,';width:10px;height:10px;display:inline-block;margin-right:10px"></span>').concat(t.data.start,"ms ~ ").concat(t.data.end,"ms (").concat(t.data.lantency,"ms) / ").concat(t.data.count," (").concat(t.data.percent,"%)<br/>"))})),e}},xAxisLength:i,xAxis:{name:"(ms)",max:i,type:"value"},yAxis:{},series:n},e)}(r,this.$echarts)},methods:{}};var c=(0,n(83744).Z)(u,[["render",function(t,e,n,s,l,o){var u=(0,a.up)("a-col"),c=(0,a.up)("a-row"),d=(0,a.up)("a-tab-pane"),p=(0,a.up)("JsonEditor"),f=(0,a.up)("a-tabs");return n.reports&&n.reports.length>0?((0,a.wg)(),(0,a.j4)(f,{key:0,type:"card"},{default:(0,a.w5)((function(){return[(0,a.Wm)(d,{key:"1",tab:t.$t("Overview")},{default:(0,a.w5)((function(){return[(0,a.Wm)(c,{class:"row-mg"},{default:(0,a.w5)((function(){return[(0,a.Wm)(u,{class:"col-pd",xl:24,lg:24,md:24,sm:24,xs:24},{default:(0,a.w5)((function(){return[i,r]})),_:1})]})),_:1})]})),_:1},8,["tab"]),(0,a.Wm)(d,{key:"2",tab:t.$t("log")},{default:(0,a.w5)((function(){return[(0,a.Wm)(p,{"is-readonly":!0,value:o.logStringify},null,8,["value"])]})),_:1},8,["tab"])]})),_:1})):(0,a.kq)("",!0)}]])},77461:function(t,e,n){n.r(e),n.d(e,{default:function(){return R}});n(74916),n(64765),n(92222),n(68309);var a=n(66252),i=n(3577),r={class:"search-input"},s={class:"form-row"},l={class:"content flex"},o={class:"flex-item"},u={class:"label"},c=function(t){return(0,a.dD)("data-v-48a41a01"),t=t(),(0,a.Cn)(),t}((function(){return(0,a._)("em",null," ~ ",-1)})),d={class:"content"},p={class:"flex"},f={class:"flex-item"},h=["onClick"],m={class:"flex-item"},g=["onClick"],v={class:"flex-item"},w={key:0},_={key:1},y={key:2},b={class:"flex-item"},x={class:"flex-item"},k={class:"font-right"};var C=n(95082),D=(n(41539),n(54747),n(57658),n(9280)),$=n(50320),W=n(13471),T=n(2692),S=n(33907),z=n(61103),A={name:"TestcaseList",i18n:n(89234),components:{LoadingOutlined:$.Z,PageLayout:z.Z,FieldTimeOutlined:W.Z,MoreOutlined:T.Z,TestReportContent:D.Z},data:function(){return{selectTR:[],selectReports:[],date:"",log:"{}",arrow:"desc",visible:!1,endDate:"",sortBy:"timestamp",prefix:" ",key:"",loading:!0,timeoutCnt:1,pageNo:1,pageSize:10,total:0,testresults:[]}},computed:(0,C.Z)((0,C.Z)({},(0,S.rn)("setting",["layout","pageWidth"])),{},{start:function(){return(this.pageNo-1)*this.pageSize}}),created:function(){this.search(),this.timer()},methods:{remove:function(t){var e=this;this.$gql.mutation("deleteTestresult(id:".concat(t,"){data{id}}")).then((function(){e.$message.success(e.$t("Deleted successfully"),3),e.search()}))},previewAlone:function(t){this.selectReports=[t],this.visible=!0},preview:function(){var t=this;this.selectReports=[],this.selectTR.forEach((function(e){t.testresults.forEach((function(n){n.id==e&&(t.selectReports.push(n),t.visible=!0)}))}))},timer:function(){var t=this;setTimeout((function(){t.search(null,null,null,!0),t.timer(),t.timeoutCnt++}),2e3*this.timeoutCnt)},search:function(t,e,n,a){var i=this;this.pageNo=t||1,a||(this.loading=!0);var r={};this.key&&(r.id={eq:this.key}),this.endDate&&(r.updatedAt={lte:this.endDate}),this.date&&(r.createdAt={gte:this.date}),this.$gql.query('testresults(sort: "testcase.id:DESC,id:DESC", filters: $filters, pagination:{start: '.concat(this.start,", limit: ").concat(this.pageSize,"}){\n\t\t\t\t\t\tdata{id,attributes{status,testcase{data{id,attributes{name,content,updatedAt}}},content,createdAt,updatedAt}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}"),{filters:r},{filters:"TestresultFiltersInput"}).then((function(t){i.testresults=t.data,i.total=t.pagination.total,i.loading=!1}))},add:function(){this.$router.push({path:"/inspector/testcase/create"})},detail:function(t){this.$router.push({path:"/inspector/testcase/detail/"+t})},onClose:function(){this.visible=!1}}};var R=(0,n(83744).Z)(A,[["render",function(t,e,n,C,D,$){var W=(0,a.up)("a-input-search"),T=(0,a.up)("a-date-picker"),S=(0,a.up)("a-form-item"),z=(0,a.up)("a-form"),A=(0,a.up)("a-card"),R=(0,a.up)("a-button"),Z=(0,a.up)("a-checkbox"),E=(0,a.up)("LoadingOutlined"),P=(0,a.up)("a-badge"),H=(0,a.up)("FieldTimeOutlined"),L=(0,a.up)("a-popconfirm"),M=(0,a.up)("a-menu-item"),Y=(0,a.up)("a-menu"),O=(0,a.up)("MoreOutlined"),U=(0,a.up)("a-dropdown"),q=(0,a.up)("a-list-item"),N=(0,a.up)("a-list"),j=(0,a.up)("a-checkbox-group"),F=(0,a.up)("TestReportContent"),I=(0,a.up)("a-modal"),J=(0,a.up)("PageLayout");return(0,a.wg)(),(0,a.j4)(J,{title:t.$t("Test Report"),"hide-breadcrumb":!0},{headerContent:(0,a.w5)((function(){return[(0,a._)("div",{class:(0,i.C_)(["search-head",t.layout,t.pageWidth])},[(0,a._)("div",r,[(0,a.Wm)(W,{value:D.key,"onUpdate:value":e[0]||(e[0]=function(t){return D.key=t}),class:"search-ipt",onSearch:e[1]||(e[1]=function(t){return $.search()}),placeholder:t.$t("Please input")+"...",size:"large"},null,8,["value","placeholder"])]),(0,a.Wm)(A,{bordered:!1,class:"search-form"},{default:(0,a.w5)((function(){return[(0,a.Wm)(z,null,{default:(0,a.w5)((function(){return[(0,a._)("div",s,[(0,a._)("div",l,[(0,a._)("div",o,[(0,a.Wm)(S,null,{default:(0,a.w5)((function(){return[(0,a._)("span",u,[(0,a._)("span",null,(0,i.zw)(t.$t("Time screening")),1)]),(0,a.Wm)(T,{value:D.date,"onUpdate:value":e[2]||(e[2]=function(t){return D.date=t}),"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:t.$t("Start Date"),onChange:e[3]||(e[3]=function(t){return $.search()})},null,8,["value","placeholder"]),c,(0,a.Wm)(T,{value:D.endDate,"onUpdate:value":e[4]||(e[4]=function(t){return D.endDate=t}),"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:t.$t("End Date"),onChange:e[5]||(e[5]=function(t){return $.search()})},null,8,["value","placeholder"])]})),_:1})])])])]})),_:1})]})),_:1})],2)]})),default:(0,a.w5)((function(){return[(0,a.Wm)(A,{class:"search-content",loading:D.loading},{extra:(0,a.w5)((function(){return[(0,a.Wm)(R,{onClick:$.preview,type:"primary"},{default:(0,a.w5)((function(){return[(0,a.Uk)((0,i.zw)(t.$t("Preview")),1)]})),_:1},8,["onClick"])]})),default:(0,a.w5)((function(){return[(0,a.Wm)(j,{value:D.selectTR,"onUpdate:value":e[6]||(e[6]=function(t){return D.selectTR=t}),class:"full"},{default:(0,a.w5)((function(){return[(0,a.Wm)(N,{"item-layout":"vertical",pagination:{showSizeChanger:!1,showQuickJumper:!1,onShowSizeChange:$.search,onChange:$.search,current:D.pageNo,pageSize:D.pageSize,showTotal:function(e,n){return"".concat(t.$t("Total")," ").concat(e)},total:D.total}},{default:(0,a.w5)((function(){return[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(D.testresults,(function(e,n){return(0,a.wg)(),(0,a.j4)(q,{key:n},{default:(0,a.w5)((function(){return[(0,a._)("div",d,[(0,a._)("div",p,[(0,a._)("div",f,[(0,a._)("div",null,[(0,a._)("b",null,(0,i.zw)(t.$t("Testcase")),1),(0,a.Uk)(" : "),(0,a._)("a",{onClick:function(t){return $.detail(e.testcase.id)}},[(0,a._)("b",null,(0,i.zw)(e.testcase.name),1)],8,h)])]),(0,a._)("div",m,[(0,a._)("div",null,[D.testresults.length>1?((0,a.wg)(),(0,a.j4)(Z,{key:0,disabled:1!=e.status,value:e.id,class:"mr-10"},null,8,["disabled","value"])):(0,a.kq)("",!0),(0,a._)("a",{onClick:function(t){return $.previewAlone(e)}},[(0,a._)("b",null,"#"+(0,i.zw)(e.id),1)],8,g)])]),(0,a._)("div",v,[(0,a._)("div",null,[0==e.status?((0,a.wg)(),(0,a.iD)("span",w,[(0,a.Wm)(E,{class:"font-primary"}),(0,a.Uk)(" "+(0,i.zw)(t.$t("Running")),1)])):null!=e.status?((0,a.wg)(),(0,a.iD)("span",_,[(0,a.Wm)(P,{color:["red","processing","green"][e.status+1],text:t.$t(["Failed","Running","Done"][e.status+1])},null,8,["color","text"])])):((0,a.wg)(),(0,a.iD)("span",y,"="))])]),(0,a._)("div",b,[(0,a._)("div",null,[(0,a._)("b",null,(0,i.zw)(t.$t("Target")),1),(0,a.Uk)(" : "),(0,a._)("span",null,(0,i.zw)(e.from||"-"),1)])]),(0,a._)("div",x,[(0,a._)("div",null,[(0,a.Wm)(H),(0,a._)("span",null,(0,i.zw)(new Date(e.updatedAt).toLocaleString()),1)])]),(0,a._)("div",k,[(0,a._)("div",null,[(0,a.Wm)(U,null,{overlay:(0,a.w5)((function(){return[(0,a.Wm)(Y,null,{default:(0,a.w5)((function(){return[(0,a.Wm)(M,null,{default:(0,a.w5)((function(){return[(0,a.Wm)(L,{placement:"topLeft","ok-text":t.$t("Yes"),"cancel-text":t.$t("No"),onConfirm:function(t){return $.remove(e.id)}},{title:(0,a.w5)((function(){return[(0,a._)("p",null,(0,i.zw)(t.$t("Tip")),1),(0,a._)("p",null,(0,i.zw)(t.$t("Are you sure to delete this?")),1)]})),default:(0,a.w5)((function(){return[(0,a._)("a",null,(0,i.zw)(t.$t("delete")),1)]})),_:2},1032,["ok-text","cancel-text","onConfirm"])]})),_:2},1024)]})),_:2},1024)]})),default:(0,a.w5)((function(){return[(0,a._)("a",null,[(0,a.Wm)(O)])]})),_:2},1024)])])])])]})),_:2},1024)})),128))]})),_:1},8,["pagination"])]})),_:1},8,["value"])]})),_:1},8,["loading"]),(0,a.Wm)(I,{"destroy-on-close":!0,visible:D.visible,"onUpdate:visible":e[7]||(e[7]=function(t){return D.visible=t}),title:t.$t("Test Report Detail"),footer:null,width:"70%"},{default:(0,a.w5)((function(){return[(0,a.Wm)(F,{reports:D.selectReports},null,8,["reports"])]})),_:1},8,["visible","title"])]})),_:1},8,["title"])}],["__scopeId","data-v-48a41a01"]])}}]);