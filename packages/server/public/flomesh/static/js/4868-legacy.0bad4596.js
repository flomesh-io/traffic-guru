(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[4868],{79797:function(t,n,e){!function(){"use strict";var n=e(17536).typeOf;t.exports.stringify=function(t){var e,i="";return"---"+(e={undefined:function(){return"null"},null:function(){return"null"},number:function(t){return t},boolean:function(t){return t?"true":"false"},string:function(t){return JSON.stringify(t)},array:function(t){var a="";return 0===t.length?a+="[]":(i=i.replace(/$/,"  "),t.forEach((function(t){var r=e[n(t)];if(!r)throw new Error("what the crap: "+n(t));a+="\n"+i+"- "+r(t)})),i=i.replace(/  /,""),a)},object:function(t){var a="";return 0===Object.keys(t).length?a+="{}":(i=i.replace(/$/,"  "),Object.keys(t).forEach((function(r){var o=t[r],u=e[n(o)];if(void 0!==o){if(!u)throw new Error("what the crap: "+n(o));a+="\n"+i+r+": "+u(o)}})),i=i.replace(/  /,""),a)},function:function(){return"[object Function]"}})[n(t)](t)+"\n"}}()},17536:function(t){!function(){"use strict";var n,e,i=Function("return this")(),a="Boolean Number String Function Array Date RegExp Object".split(" "),r={};for(n in a)a.hasOwnProperty(n)&&(e=a[n],r["[object "+e+"]"]=e.toLowerCase());function o(t){return null==t?String(t):r[Object.prototype.toString.call(t)]||"object"}function u(t){var n,e;if("object"===o(t))for(n in t)if(void 0!==(e=t[n])&&"function"!==o(e))return!1;return!0}String.prototype.entityify||(String.prototype.entityify=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}),String.prototype.quote||(String.prototype.quote=function(){var t,n,e=this.length,i='"';for(n=0;n<e;n+=1)if((t=this.charAt(n))>=" ")"\\"!==t&&'"'!==t||(i+="\\"),i+=t;else switch(t){case"\b":i+="\\b";break;case"\f":i+="\\f";break;case"\n":i+="\\n";break;case"\r":i+="\\r";break;case"\t":i+="\\t";break;default:t=t.charCodeAt(),i+="\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16)}return i+'"'}),String.prototype.supplant||(String.prototype.supplant=function(t){return this.replace(/{([^{}]*)}/g,(function(n,e){var i=t[e];return"string"==typeof i||"number"==typeof i?i:n}))}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s*(\S*(?:\s+\S+)*)\s*$/,"$1")}),t.exports={typeOf:o,isEmpty:u},i.typeOf=i.typeOf||o,i.isEmpty=i.isEmpty||u}()},44107:function(t,n,e){"use strict";e.d(n,{Z:function(){return f}});var i=e(66252),a=e(3577);var r=e(3336),o=(e(38862),e(41539),e(21936)),u=e(8333),s=e(79797),c=e(93320),l={name:"Json2YamlCard",components:{JsonEditor:o.Z,YamlEditor:u.Z},props:["jsonVal","isCreate","height","isReadonly","url","isPop"],i18n:e(89234),data:function(){return{configTab:[{key:"YAML",tab:"YAML"},{key:"JSON",tab:"JSON"}],configKey:"YAML",json:"{}",yaml:""}},watch:{json:function(t,n){t!=n&&this.jsonInput(t)},yaml:function(t,n){t!=n&&this.yamlInput(t)},jsonVal:{handler:function(t,n){if("{}"!=t&&""!=t||(t='{"key":"value"}'),t!=n){var e=JSON.parse(t);"object"==(0,r.Z)(e)&&(this.json=t)}},immediate:!0}},created:function(){},mounted:function(){this.init()},methods:{onTabChange:function(t,n){this[n]=t},jsonInput:function(t){try{var n=JSON.parse(t);"object"==(0,r.Z)(n)&&(this.yaml=this.convertToYaml(t),this.$emit("update:jsonVal",this.json),this.$emit("change",this.json))}catch(t){}},yamlInput:function(t){var n=c.load(t),e=JSON.stringify(n,null,"  "),i=JSON.parse(e);"object"==(0,r.Z)(i)&&(this.$emit("update:jsonVal",e),this.$emit("change",e))},getDefaultYamlConfig:function(){var t=this;if(!this.url)return this.yaml=this.convertToYaml(this.jsonVal),void this.yamlInput(this.yaml);fetch(this.url).then((function(t){return t.text()})).then((function(n){t.url.indexOf(".yaml");var e=c.load(n),i=JSON.stringify(e,null,"  "),a=JSON.parse(i);a.spec&&a.spec.namespace&&(a.spec.namespace="_all"==localStorage.getItem("NAMESPACE")?"default":localStorage.getItem("NAMESPACE"));var r=JSON.stringify(a);t.yaml=t.convertToYaml(r),setTimeout((function(){t.yamlInput(t.yaml)}),2e3)})).catch((function(){}))},convertToYaml:function(t){if(""==t)return"";var n=JSON.parse(t);return s.stringify(n)},init:function(){this.isCreate?this.getDefaultYamlConfig():(this.yaml=this.convertToYaml(this.jsonVal),this.yamlInput(this.yaml))}}};var f=(0,e(83744).Z)(l,[["render",function(t,n,e,r,o,u){var s=(0,i.up)("YamlEditor"),c=(0,i.up)("JsonEditor"),l=(0,i.up)("a-button"),f=(0,i.up)("a-card");return(0,i.wg)(),(0,i.j4)(f,{class:(0,a.C_)(["card nopd",e.isPop?"isPop":""]),"tab-list":o.configTab,"active-tab-key":o.configKey,onTabChange:n[2]||(n[2]=function(t){return u.onTabChange(t,"configKey")}),bordered:!1},{tabBarExtraContent:(0,i.w5)((function(){return[e.url?((0,i.wg)(),(0,i.j4)(l,{key:0,type:"dashed",onClick:u.getDefaultYamlConfig},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("reset")),1)]})),_:1},8,["onClick"])):(0,i.kq)("",!0)]})),default:(0,i.w5)((function(){return["YAML"==o.configKey?((0,i.wg)(),(0,i.j4)(s,{key:0,height:e.height,"is-readonly":e.isReadonly,value:o.yaml,"onUpdate:value":n[0]||(n[0]=function(t){return o.yaml=t})},null,8,["height","is-readonly","value"])):(0,i.kq)("",!0),"JSON"==o.configKey?((0,i.wg)(),(0,i.j4)(c,{key:1,height:e.height,"is-readonly":e.isReadonly,"is-json":!0,noreset:!e.isReadonly,value:o.json,"onUpdate:value":n[1]||(n[1]=function(t){return o.json=t})},null,8,["height","is-readonly","noreset","value"])):(0,i.kq)("",!0)]})),_:1},8,["class","tab-list","active-tab-key"])}]])},74868:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return w}});e(74916),e(64765),e(92222),e(68309);var i=e(66252),a=e(3577),r=["onClick"],o=["onClick"],u=["onClick"],s={class:"list-content"},c={key:0,class:"list-content-item"},l={key:1},f={key:1,class:"list-content-item"};e(57658),e(41539),e(54747),e(38862);var p=e(44107),d=e(2692),g=e(99684),h=e(21826),y=e(30631),m=e(3075),v={name:"RegistryList",i18n:e(89234),components:{MoreOutlined:d.Z,PlusCircleTwoTone:g.Z,SyncOutlined:h.Z,EyeOutlined:y.Z,Json2YamlCard:p.Z},data:function(){return{service:"{\n\t  }",RegistrySvg:m,key:"",pageSize:10,pageNo:1,total:0,loading:!0,list:[]}},computed:{start:function(){return(this.pageNo-1)*this.pageSize}},created:function(){this.search()},methods:{loadService:function(t){this.service=t.services},newLb:function(){this.$router.push({path:"/ops-center/registry/create"})},detail:function(t){this.$router.push({path:"/ops-center/registry/detail/"+t})},remove:function(t){var n=this;this.$gql.mutation("deleteRegistry(id:".concat(t,"){data{id}}")).then((function(){n.$message.success(n.$t("Deleted successfully"),3),n.search()}))},tosync:function(t){var n=this;t.sync=!0,this.$gql.mutation("refreshRegistry(id:".concat(t.id,")")).then((function(){n.$message.success(n.$t("Sync successfully"),3),t.sync=!1,n.search()}))},toimport:function(){},search:function(t,n){var e=this;t&&(this.pageNo=t,this.pageSize=n);var i={start:this.start,limit:this.pageSize};this.loading=!0;var a={name:{contains:this.key}};this.$gql.query("registries(filters: $filters, pagination: $pagination){\n\t\t\t\t\t\tdata{id,attributes{\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\taddress,\n\t\t\t\t\t\t\tservices(pagination: {limit: 9999 }){data{id,attributes{name}}},\n\t\t\t\t\t\t\tnamespaces(pagination: {limit: 9999 }){data{id,attributes{\n\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\tservices{data{id,attributes{\n\t\t\t\t\t\t\t\t\tuid,\n\t\t\t\t\t\t\t\t\tfleet{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\t\torganization{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\t\tnamespace,\n\t\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\t\tregistry{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\t\tcontent,\n\t\t\t\t\t\t\t\t\tcreatedAt\n\t\t\t\t\t\t\t\t}}}\n\t\t\t\t\t\t\t}}}\n\t\t\t\t\t\t}},\n\t\t\t\t\t\tmeta{pagination{total}}\n\t\t\t\t\t}",{filters:a,pagination:i},{filters:"RegistryFiltersInput",pagination:"PaginationArg"}).then((function(t){e.list=t.data,e.list.forEach((function(t){t.namespacesString=t.namespaces?JSON.stringify(t.namespaces):"{}"})),e.total=t.pagination.total,e.loading=!1}))}}};var w=(0,e(83744).Z)(v,[["render",function(t,n,e,p,d,g){var h=(0,i.up)("a-input-search"),y=(0,i.up)("a-divider"),m=(0,i.up)("PlusCircleTwoTone"),v=(0,i.up)("a-button"),w=(0,i.up)("SyncOutlined"),k=(0,i.up)("a-avatar"),S=(0,i.up)("a-list-item-meta"),b=(0,i.up)("a-menu-item"),j=(0,i.up)("a-popconfirm"),C=(0,i.up)("a-menu"),_=(0,i.up)("MoreOutlined"),$=(0,i.up)("a-dropdown"),O=(0,i.up)("a-tag"),z=(0,i.up)("a-badge"),N=(0,i.up)("Json2YamlCard"),E=(0,i.up)("EyeOutlined"),J=(0,i.up)("a-popover"),T=(0,i.up)("a-list-item"),Y=(0,i.up)("a-list"),W=(0,i.up)("a-card"),A=(0,i.Q2)("permission");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(W,{bordered:!1,title:t.$t("Registry"),loading:d.loading},{extra:(0,i.w5)((function(){return[(0,i._)("div",null,[(0,i.Wm)(h,{value:d.key,"onUpdate:value":n[0]||(n[0]=function(t){return d.key=t}),onSearch:n[1]||(n[1]=function(t){return g.search()}),class:"right-search-input",placeholder:t.$t("search")},null,8,["value","placeholder"]),(0,i.wy)((0,i.Wm)(y,{type:"vertical"},null,512),[[A,["registry:create"]]]),(0,i.wy)(((0,i.wg)(),(0,i.j4)(v,{type:"link",shape:"circle",onClick:g.newLb},{icon:(0,i.w5)((function(){return[(0,i.Wm)(m,{class:"font-20 icon-menu-sm rotate-icon"})]})),_:1},8,["onClick"])),[[A,["registry:create"]]])])]})),default:(0,i.w5)((function(){return[(0,i.Wm)(Y,{size:"large",pagination:{showSizeChanger:!0,showQuickJumper:!1,onShowSizeChange:g.search,onChange:g.search,current:d.pageNo,pageSize:d.pageSize,showTotal:function(n,e){return"".concat(t.$t("Total")," ").concat(n)},total:d.total}},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(d.list,(function(n,e){return(0,i.wg)(),(0,i.j4)(T,{key:e},{actions:(0,i.w5)((function(){return[(0,i._)("div",null,[(0,i.Wm)($,null,{overlay:(0,i.w5)((function(){return[(0,i.Wm)(C,null,{default:(0,i.w5)((function(){return[(0,i.Wm)(b,null,{default:(0,i.w5)((function(){return[(0,i.wy)(((0,i.wg)(),(0,i.iD)("a",{onClick:function(t){return g.tosync(n)}},[(0,i.Uk)((0,a.zw)(t.$t("Sync")),1)],8,o)),[[A,["registry:update"]]])]})),_:2},1024),(0,i.Wm)(b,null,{default:(0,i.w5)((function(){return[(0,i.wy)(((0,i.wg)(),(0,i.iD)("a",{onClick:function(t){return g.detail(n.id)}},[(0,i.Uk)((0,a.zw)(t.$t("edit")),1)],8,u)),[[A,["registry:update"]]])]})),_:2},1024),(0,i.Wm)(b,null,{default:(0,i.w5)((function(){return[(0,i.Wm)(j,{placement:"topLeft","ok-text":t.$t("Yes"),"cancel-text":t.$t("No"),onConfirm:function(t){return g.remove(n.id)}},{title:(0,i.w5)((function(){return[(0,i._)("p",null,(0,a.zw)(t.$t("Tip")),1),(0,i._)("p",null,(0,a.zw)(t.$t("Are you sure to delete this?")),1)]})),default:(0,i.w5)((function(){return[(0,i.wy)(((0,i.wg)(),(0,i.iD)("a",null,[(0,i.Uk)((0,a.zw)(t.$t("delete")),1)])),[[A,["registry:delete"]]])]})),_:2},1032,["ok-text","cancel-text","onConfirm"])]})),_:2},1024)]})),_:2},1024)]})),default:(0,i.w5)((function(){return[(0,i._)("a",null,[(0,i.Wm)(_)])]})),_:2},1024)])]})),default:(0,i.w5)((function(){var e;return[(0,i.Wm)(S,null,{avatar:(0,i.w5)((function(){return[n.sync?((0,i.wg)(),(0,i.j4)(w,{key:0,class:"font-30 gray",spin:""})):((0,i.wg)(),(0,i.j4)(k,{key:1,class:"avatar-img font-30 primary schedule",size:"small",shape:"square",src:d.RegistrySvg},null,8,["src"]))]})),title:(0,i.w5)((function(){return[(0,i._)("a",{onClick:function(t){return g.detail(n.id)}},(0,a.zw)(n.name?n.name:"Unnamed"),9,r)]})),description:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(t.$t("Type"))+"："+(0,a.zw)(n.type),1)]})),_:2},1024),(0,i._)("div",s,[n.address?((0,i.wg)(),(0,i.iD)("div",c,[(0,i._)("span",null,(0,a.zw)(t.$t("Location")),1),(0,i._)("p",null,[n.address?((0,i.wg)(),(0,i.j4)(O,{key:0},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.zw)(n.address),1)]})),_:2},1024)):((0,i.wg)(),(0,i.iD)("span",l,"-"))])])):(0,i.kq)("",!0),n.namespaces&&n.namespaces.length>0?((0,i.wg)(),(0,i.iD)("div",f,[(0,i._)("span",null,(0,a.zw)(t.$t("Service")),1),(0,i._)("p",null,[(0,i.Wm)(z,{count:null===(e=n.services)||void 0===e?void 0:e.length},null,8,["count"]),(0,i.Wm)(J,{title:t.$t("Services"),trigger:"click"},{content:(0,i.w5)((function(){return[(0,i.Wm)(N,{class:"card nopd width-500","is-readonly":!1,"is-create":!1,jsonVal:n.namespacesString,"onUpdate:jsonVal":function(t){return n.namespacesString=t}},null,8,["jsonVal","onUpdate:jsonVal"])]})),default:(0,i.w5)((function(){return[(0,i.Wm)(v,{type:"link",onClick:function(t){return g.loadService(n)}},{default:(0,i.w5)((function(){return[(0,i.Wm)(E,{class:"eye relative",style:{top:"4px"}})]})),_:2},1032,["onClick"])]})),_:2},1032,["title"])])])):(0,i.kq)("",!0)])]})),_:2},1024)})),128))]})),_:1},8,["pagination"])]})),_:1},8,["title","loading"])])}],["__scopeId","data-v-1b9f90c2"]])}}]);