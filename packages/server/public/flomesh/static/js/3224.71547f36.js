"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[3224],{76629:function(e,t,i){i.d(t,{Z:function(){return p}});var a=i(66252),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},l=i(33058);function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?Object(arguments[t]):{},a=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),a.forEach((function(t){r(e,t,i[t])}))}return e}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var o=function(e,t){var i=n({},e,t.attrs);return(0,a.Wm)(l.Z,n({},i,{icon:s}),null)};o.displayName="ClearOutlined",o.inheritAttrs=!1;var p=o},27780:function(e,t,i){i.d(t,{Z:function(){return p}});var a=i(66252),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M709.6 210l.4-.2h.2L512 96 313.9 209.8h-.2l.7.3L151.5 304v416L512 928l360.5-208V304l-162.9-94zM482.7 843.6L339.6 761V621.4L210 547.8V372.9l272.7 157.3v313.4zM238.2 321.5l134.7-77.8 138.9 79.7 139.1-79.9 135.2 78-273.9 158-274-158zM814 548.3l-128.8 73.1v139.1l-143.9 83V530.4L814 373.1v175.2z"}}]},name:"code-sandbox",theme:"outlined"},l=i(33058);function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?Object(arguments[t]):{},a=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),a.forEach((function(t){r(e,t,i[t])}))}return e}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var o=function(e,t){var i=n({},e,t.attrs);return(0,a.Wm)(l.Z,n({},i,{icon:s}),null)};o.displayName="CodeSandboxOutlined",o.inheritAttrs=!1;var p=o},14941:function(e,t,i){i.d(t,{Z:function(){return p}});var a=i(66252),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M957.6 507.4L603.2 158.2a7.9 7.9 0 00-11.2 0L353.3 393.4a8.03 8.03 0 00-.1 11.3l.1.1 40 39.4-117.2 115.3a8.03 8.03 0 00-.1 11.3l.1.1 39.5 38.9-189.1 187H72.1c-4.4 0-8.1 3.6-8.1 8V860c0 4.4 3.6 8 8 8h344.9c2.1 0 4.1-.8 5.6-2.3l76.1-75.6 40.4 39.8a7.9 7.9 0 0011.2 0l117.1-115.6 40.1 39.5a7.9 7.9 0 0011.2 0l238.7-235.2c3.4-3 3.4-8 .3-11.2zM389.8 796.2H229.6l134.4-133 80.1 78.9-54.3 54.1zm154.8-62.1L373.2 565.2l68.6-67.6 171.4 168.9-68.6 67.6zM713.1 658L450.3 399.1 597.6 254l262.8 259-147.3 145z"}}]},name:"highlight",theme:"outlined"},l=i(33058);function n(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?Object(arguments[t]):{},a=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),a.forEach((function(t){r(e,t,i[t])}))}return e}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var o=function(e,t){var i=n({},e,t.attrs);return(0,a.Wm)(l.Z,n({},i,{icon:s}),null)};o.displayName="HighlightOutlined",o.inheritAttrs=!1;var p=o},33224:function(e,t,i){i.d(t,{Z:function(){return M}});i(57658);var a=i(66252),s=i(3577);const l={class:"search-content"},n={class:"mb-5"},r={key:0,class:"absolute right-10",style:{top:"5px"}},o={class:"relative"},p={class:"content full result-content"},c={class:"result-margin result-mask"},u={class:"result-margin result-mask"},d={key:0},h={key:1},g={key:2},b={key:3},m={key:0,class:"result-chart"},v={key:1,class:"result-chart"},w=(e=>((0,a.dD)("data-v-08969294"),e=e(),(0,a.Cn)(),e))((()=>(0,a._)("div",{class:"swagger",id:"swagger"},null,-1))),y={class:"result-card-warpper"},f={class:"inline-block vm"},k={key:1,class:"inline-block vm"};var A=i(11416),O=i.n(A),$=i(76629),j=i(27780),S=i(54367),C=i(75053),z=i(14941),_=i(30631),x=i(16527),L=i(52255),D=i(34531),q=i(33907),E=i(69596),P=i(48551),W=i(85263),N=i(70473),V=i(62382),Z=i(96486),R=i.n(Z);let U=i(93320);var H={name:"ApiListResults",i18n:i(89234),components:{ClearOutlined:$.Z,CodeSandboxOutlined:j.Z,CloseOutlined:S.Z,CardList:E.Z,ApiOutlined:C.Z,HighlightOutlined:z.Z,EyeOutlined:_.Z,RocketOutlined:x.Z,PauseOutlined:L.Z,MiniArea:P.Z,CardSelector:D.Z},props:["apis","total","pageNo","pageSize","loading","embed","mode"],data(){return{pageNoVal:0,CodeSandboxOutlined:j.Z,approvalLevels:[],hideApps:!0,key:"",filterApp:"",simpleImage:W.Z.PRESENTED_IMAGE_SIMPLE,visible:!1,cartVisible:!1,showApp:!1,screenWidth:document.body.clientWidth,json:"{}",applications:[],subApis:[],categray:[{value:-1,label:"All"},{value:0,label:"Design"},{value:1,label:"Review"},{value:2,label:"Run"},{value:3,label:"Stop"}]}},computed:{...(0,q.rn)("setting",["layout","pageWidth"]),...(0,q.Se)("account",["user"]),subApisApprovalLevels(){let e=this.subApis;return e.forEach((e=>{this.approvalLevels.forEach((t=>{t.value==e.approvalLevel&&(e.approvalLevelName=t.label,e.approvalRoles=t.approvalRoles)}))})),e}},watch:{pageNoVal:{deep:!0,handler(){this.$emit("update:pageNo",this.pageNoVal)}}},mounted(){this.pageNoVal=this.pageNo,this.$gql.query("applications{data{id,attributes{name,apis{data{id,attributes{name}}},project{data{id,attributes{name}}}}}}").then((e=>{this.applications=e.data})),this.$gql.query('systemSettings(filters:{type:{eq:"ApiApprovalLevelType"}}){data{id,attributes{mode,content}}}').then((e=>{this.approvalLevels=e.data[0].content,this.approvalLevels.forEach((e=>{e.value=1*e.value}))}));const e=this;window&&(window.onresize=()=>{window.screenWidth=document.body.clientWidth,e.screenWidth=window.screenWidth})},methods:{saveApplication(e){if(0==this.applications.length)return void this.openNotification();let t=[],i=[];this.subApis.forEach((e=>{e.approvalLevel>0?t.push(e):i.push(e)}));let a=[];e.apis=e.apis.concat(i),e.apis.forEach((e=>{-1==a.indexOf(e.id)&&a.push(e.id)})),0==i.length?(this.$message.success(this.$t("Subscription request has been sent"),3),this.$emit("subApisChange",this.subApis),this.cartVisible=!1,this.subApis=[]):this.$gql.mutation(`updateApplication(id:${e.id}, data: $data){data{id}}`,{data:{apis:a}},{data:"ApplicationInput!"}).then((()=>{this.cartVisible=!1,this.subApis=[],this.$message.success(this.$t("Subscription request has been sent"),3),this.$emit("subApisChange",this.subApis)})),t.forEach((t=>{this.$gql.mutation("createSubscribeApiApply(data: $data){data{id}}",{data:{api:t.id,status:0,approvalStep:0,applyUser:this.user.id,application:e.id}},{data:"SubscribeApiApplyInput!"}).then((()=>{}))}))},hideNotification(){this.hideApps=!0},openNotification(){const e=`open${Date.now()}`;N.Z.open({message:this.$t("Tip"),description:this.$t("There is no app at present. Please add an app first"),btn:(0,a.h)(V.Z,{type:"primary",size:"small",onClick:()=>{N.Z.close(e),this.createApp()}},this.$("Add app")),key:e,placement:"bottomRight"})},createApp(){this.$router.push({path:"/openapi/application/create"})},add(){this.$router.push({path:"/openapi/api/create"})},addpolicy(){this.$router.push({path:"/openapi/api/create/Policy"})},detail(e,t,i){this.$router.push({path:"/openapi/api/detail/"+i.id})},exportApi(e,t,i){let a=new Blob([JSON.stringify(i.content)],{type:"application/json"}),s=URL.createObjectURL(a),l=document.createElement("a"),n=i.name;l.setAttribute("download",n),l.href=s,l.click()},importApi(){let e=document.createElement("input");e.type="file",e.click();let t=null;e.addEventListener("change",(e=>{t=e.target.files[0];let i=t,a=new FileReader;if("undefined"==typeof FileReader)return;a.readAsText(i,"gb2312");const s=this;a.onload=function(){s.$nextTick().then((()=>{s.content=a.result,s.$router.push({name:"API Create",params:{content:s.content}})}))}}))},remove(e,t,i){this.$gql.mutation(`deleteApi(id:${i.id}){data{id}}`).then((()=>{this.$message.success(this.$t("Deleted successfully"),3),this.search()}))},search(e,t,i){this.$emit("search",e,t,i)},getDummtSGdata(){fetch("swagger.yaml").then((e=>e.text())).then((e=>{let t=U.load(e),i=JSON.stringify(t,null,"  ");this.swaggerchange(i)})).catch((e=>{}))},openSubscriptionCart(){this.cartVisible=!0},show(e,t,i){this.visible=!0,this.swaggerchange(i.spec)},clear(e){e>=0?this.subApis.splice(e,1):(this.subApis=[],this.$message.success(this.$t("Subscription car has been emptied"),3)),this.$emit("subApisChange",this.subApis)},push(e,t,i){let a=!1;this.subApis.forEach((e=>{e.id==i.id&&(a=!0)})),a?this.$message.success(this.$t("Do not add repeatedly"),3):(this.subApis.push(i),this.$message.success(this.$t("Subscription car added"),3)),this.$emit("subApisChange",this.subApis)},swaggerchange(e){setTimeout((()=>{O()({spec:R().cloneDeep(e),dom_id:"#swagger",deepLinking:!1,presets:[O().presets.apis,O().SwaggerUIStandalonePreset],plugins:[O().plugins.DownloadUrl]})}),300)}}};var M=(0,i(83744).Z)(H,[["render",function(e,t,i,A,O,$){const j=(0,a.up)("a-tag"),S=(0,a.up)("a-badge"),C=(0,a.up)("a-card-meta"),z=(0,a.up)("HighlightOutlined"),_=(0,a.up)("EyeOutlined"),x=(0,a.up)("RocketOutlined"),L=(0,a.up)("PauseOutlined"),D=(0,a.up)("MiniArea"),q=(0,a.up)("CardList"),E=(0,a.up)("a-pagination"),P=(0,a.up)("a-drawer"),W=(0,a.up)("ClearOutlined"),N=(0,a.up)("a-button"),V=(0,a.up)("CardSelector"),Z=(0,a.up)("a-empty"),R=(0,a.up)("ApiOutlined"),U=(0,a.up)("a-step"),H=(0,a.up)("a-steps"),M=(0,a.up)("CloseOutlined");return(0,a.up)("CodeSandboxOutlined"),(0,a.wg)(),(0,a.iD)("div",l,[(0,a.Wm)(q,{"result-empty":{status:404,title:e.$t("No data")},loading:i.loading,"data-source":i.apis||[],"hide-action-title":!0,type:"component",actions:0==i.mode?[{icon:"EyeOutlined",text:e.$t("Preview"),call:$.show},{icon:"ShoppingCartOutlined",className:"primary",text:e.$t("Add to subscription car"),call:$.push,showFun:e=>2==e.step||i.embed},{icon:"ExportOutlined",text:e.$t("Export"),call:$.exportApi}]:[{icon:"EyeOutlined",text:e.$t("Preview"),call:$.show},{icon:"ShoppingCartOutlined",className:"primary",text:e.$t("Add to subscription car"),call:$.push,showFun:e=>2==e.step||i.embed},{icon:"EditOutlined",text:e.$t("edit"),call:$.detail},{icon:"ExportOutlined",text:e.$t("Export"),call:$.exportApi},{icon:"DeleteOutlined",text:e.$t("delete"),call:$.remove,hide:!0,permissionWhere:["api:delete:project:","project","api:delete"]}]},{default:(0,a.w5)((({item:t})=>[(0,a.Wm)(C,null,{title:(0,a.w5)((()=>[(0,a._)("div",n,[(0,a.Uk)((0,s.zw)(t.name)+" ",1),t.project?((0,a.wg)(),(0,a.j4)(j,{key:0,color:"pink",class:"result-tag"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t.project.name),1)])),_:2},1024)):(0,a.kq)("",!0),t.policy?((0,a.wg)(),(0,a.j4)(j,{key:1,color:"cyan",class:"result-tag"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t.policy.name),1)])),_:2},1024)):(0,a.kq)("",!0),1==t.status?((0,a.wg)(),(0,a.j4)(j,{key:2,color:"orange",class:"result-tag"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("PENDING")),1)])),_:1})):(0,a.kq)("",!0),2==t.status?((0,a.wg)(),(0,a.j4)(j,{key:3,color:"red",class:"result-tag"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("ERROR")),1)])),_:1})):(0,a.kq)("",!0)]),t.appliesCnt>0&&1==i.mode?((0,a.wg)(),(0,a.iD)("span",r,[(0,a.Wm)(S,{count:t.appliesCnt},null,8,["count"])])):(0,a.kq)("",!0)])),avatar:(0,a.w5)((()=>[0==t.status?((0,a.wg)(),(0,a.j4)(S,{key:0,status:"processing"})):(0,a.kq)("",!0),1==t.status?((0,a.wg)(),(0,a.j4)(S,{key:1,status:"warning"})):(0,a.kq)("",!0),2==t.status?((0,a.wg)(),(0,a.j4)(S,{key:2,status:"error"})):(0,a.kq)("",!0)])),description:(0,a.w5)((()=>[])),_:2},1024),(0,a._)("div",o,[(0,a._)("div",p,[(0,a._)("div",c,[(0,a._)("p",null,(0,s.zw)(e.$t("Subscription")),1),(0,a._)("p",null,(0,s.zw)(t.applications.length),1)]),(0,a._)("div",u,[0==t.step?((0,a.wg)(),(0,a.iD)("p",d,(0,s.zw)(e.$t("In Design")),1)):(0,a.kq)("",!0),1==t.step?((0,a.wg)(),(0,a.iD)("p",h,(0,s.zw)(e.$t("Under Review")),1)):(0,a.kq)("",!0),2==t.step?((0,a.wg)(),(0,a.iD)("p",g,(0,s.zw)(e.$t("Running")),1)):(0,a.kq)("",!0),3==t.step?((0,a.wg)(),(0,a.iD)("p",b,(0,s.zw)(e.$t("Stop")),1)):(0,a.kq)("",!0),(0,a._)("p",null,[0==t.step?((0,a.wg)(),(0,a.j4)(z,{key:0,class:"primary"})):(0,a.kq)("",!0),1==t.step?((0,a.wg)(),(0,a.j4)(_,{key:1,class:"primary"})):(0,a.kq)("",!0),2==t.step?((0,a.wg)(),(0,a.j4)(x,{key:2,class:"primary"})):(0,a.kq)("",!0),3==t.step?((0,a.wg)(),(0,a.j4)(L,{key:3,class:"danger"})):(0,a.kq)("",!0)])])]),t.chart&&t.chart.length>0?((0,a.wg)(),(0,a.iD)("div",m,[(0,a.Wm)(D,{colors:["#8be4c1"],height:100,id:t.id,padding:[0,0,0,0],axis:!1,ver:O.screenWidth,showy:!1,dv:t.chart},null,8,["id","ver","dv"])])):((0,a.wg)(),(0,a.iD)("div",v,[(0,a.Wm)(D,{colors:["#8be4c1"],height:100,id:t.id,padding:[0,0,0,0],axis:!1,"hide-legend":!0,ver:O.screenWidth,showy:!1,dv:[{type:"-",date:(new Date).toLocaleDateString(),value:0}]},null,8,["id","ver","dv"])]))])])),_:1},8,["result-empty","loading","data-source","actions"]),i.pageNo>=0?((0,a.wg)(),(0,a.j4)(E,{key:0,onChange:$.search,current:O.pageNoVal,"onUpdate:current":t[0]||(t[0]=e=>O.pageNoVal=e),total:i.total,"page-size":i.pageSize,"show-less-items":""},null,8,["onChange","current","total","page-size"])):(0,a.kq)("",!0),(0,a.Wm)(P,{title:e.$t("Specs"),placement:"right",closable:!1,width:"50%",visible:O.visible,"onUpdate:visible":t[1]||(t[1]=e=>O.visible=e)},{default:(0,a.w5)((()=>[w])),_:1},8,["title","visible"]),(0,a.Wm)(P,{placement:"right",closable:!1,visible:O.cartVisible,"onUpdate:visible":t[2]||(t[2]=e=>O.cartVisible=e),"after-visible-change":e.afterVisibleChange},{title:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("Subscription Cart"))+" ",1),(0,a.Wm)(W,{onClick:$.clear,class:"click-icon primary"},null,8,["onClick"])])),default:(0,a.w5)((()=>[(0,a._)("div",y,[(0,a.Wm)(V,{search:!0,col:2,icon:O.CodeSandboxOutlined,onSelect:$.saveApplication,"get-tag":e=>e.project?e.project.name:"no project",options:O.applications},{default:(0,a.w5)((()=>[(0,a._)("a",null,[(0,a.Wm)(N,{key:"submit",type:"primary",class:"full"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("Add To Application")),1)])),_:1})])])),_:1},8,["icon","onSelect","get-tag","options"])]),0==O.subApis.length?((0,a.wg)(),(0,a.j4)(Z,{key:0,image:O.simpleImage,class:"mt-100"},{description:(0,a.w5)((()=>[(0,a._)("span",null,(0,s.zw)(e.$t("Please select from the API list first")),1)])),_:1},8,["image"])):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)($.subApisApprovalLevels,((t,i)=>((0,a.wg)(),(0,a.iD)("div",{class:"mini-linedata",key:i},[(0,a.Wm)(R,{class:"ApiOutlined primary"}),(0,a.Uk)(" "+(0,s.zw)(t.name)+" ",1),(0,a._)("div",null,[(0,a._)("div",f,(0,s.zw)(e.$t("Approval Process"))+" : ",1),t.approvalLevel>0?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"inline-block relative vm",style:(0,s.j5)([{top:"-7px",left:"10px"},"width:"+80*t.approvalLevel+"px"])},[(0,a.Wm)(H,{class:"inline-block",current:-1,size:"small"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.approvalRoles,((e,t)=>((0,a.wg)(),(0,a.j4)(U,{key:t,title:e.label},null,8,["title"])))),128))])),_:2},1024)],4)):((0,a.wg)(),(0,a.iD)("div",k,(0,s.zw)(e.$t("Free Subscribe")),1))]),(0,a.Wm)(M,{class:"close",onClick:e=>$.clear(i)},null,8,["onClick"])])))),128))])),_:1},8,["visible","after-visible-change"]),(0,a.kq)("",!0)])}],["__scopeId","data-v-08969294"]])}}]);