"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[6931],{9294:function(t,n,e){e.d(n,{Z:function(){return c}});var i=e(66252);e(74916),e(15306);var o=e(29764);(0,e(25552).H)({id:"javascript",extensions:[".js",".es6",".jsx",".mjs"],firstLine:"^#!.*\\bnode",filenames:["jakefile"],aliases:["JavaScript","javascript","js"],mimetypes:["text/javascript"],loader:function(){return e.e(6015).then(e.bind(e,6015))}});var a={name:"JsEditor",components:{monacoeditor:o.Z},props:["value","height","isReadonly","id","theme"],data:function(){return{code:"",cmOptions:{lineNumbers:!0,mode:"javascript",readOnly:!1,lint:!0}}},watch:{value:function(t,n){t!==n&&this.setValue()}},mounted:function(){this.setValue()},methods:{change:function(t){"string"==typeof t&&(this.$emit("update:value",t),this.$emit("change",t))},setValue:function(){null!=this.value.replace&&(this.code=this.value)}}};var c=(0,e(83744).Z)(a,[["render",function(t,n,e,o,a,c){var s=(0,i.up)("monacoeditor");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(s,{id:e.id||"JsEditor",content:a.code,"onUpdate:content":n[0]||(n[0]=function(t){return a.code=t}),option:a.cmOptions,onChange:c.change,height:e.height,theme:e.theme,"is-readonly":e.isReadonly},null,8,["id","content","option","onChange","height","theme","is-readonly"])])}]])},26931:function(t,n,e){e.r(n),e.d(n,{default:function(){return h}});e(68309);var i=e(66252),o=e(3577);var a=e(95082),c=(e(38862),e(41539),e(96486)),s=e.n(c),u=e(61103),r=e(21936),l=e(9294),d=e(76754),f=e(33907),p={name:"Profile",components:{PageLayout:u.Z,JsonEditor:r.Z,JsEditor:l.Z,FormItem:d.Z},i18n:e(89234),data:function(){return{pid:"",json:{name:"",content:{pipy_config:"",tcp_config:"{}"}},loading:!0}},computed:(0,a.Z)((0,a.Z)({},(0,f.rn)("rules",["rules"])),{},{dataColumns:function(){}}),created:function(){this.pid=this.$route.params.id||""},mounted:function(){var t=this;""!=this.pid?(this.loading=!0,this.$gql.query("profile(id: ".concat(this.pid,"){data{id,attributes{name,content}}}")).then((function(n){t.json=n.data,t.json.content.tcp_config=JSON.stringify(t.json.content.tcp_config),t.loading=!1}))):(this.json.name="",this.json.content={pipy_config:"",tcp_config:"{}"},this.getDefaultPipyConfig(),this.loading=!1)},methods:{valid:function(){return""!=this.json.name||(this.$message.error(this.$t("The name cannot be empty"),3),!1)},validate:function(){var t=this;this.$refs.layout.$refs.form.validateFields().then((function(){t.save()})).catch((function(){}))},save:function(){var t=this;if(this.valid()){var n=s().cloneDeep(this.json);n.content=s().cloneDeep(this.json.content),content.pipy_config=this.json.content.pipy_config,content.tcp_config=JSON.parse(this.json.content.tcp_config),""!=this.pid?this.$gql.mutation("updateProfile(id:".concat(this.pid,", data: $data){data{id}}"),{data:n},{data:"ProfileInput!"}).then((function(){t.$message.success(t.$t("Save successfully"),3),t.$closePage(t.$route)})):this.$gql.mutation("createProfile(data: $data){data{id}}",{data:n},{data:"ProfileInput!"}).then((function(n){t.pid=n.data.id,t.$message.success(t.$t("Created successfully"),3),t.$closePage(t.$route)}))}},getDefaultPipyConfig:function(){var t=this;fetch("pipy-4lb.js").then((function(t){return t.text()})).then((function(n){t.json.content.pipy_config=n})).catch((function(t){}))}}};var h=(0,e(83744).Z)(p,[["render",function(t,n,e,a,c,s){var u=(0,i.up)("a-input"),r=(0,i.up)("FormItem"),l=(0,i.up)("a-button"),d=(0,i.up)("JsEditor"),f=(0,i.up)("a-card"),p=(0,i.up)("a-col"),h=(0,i.up)("JsonEditor"),m=(0,i.up)("a-row"),g=(0,i.up)("PageLayout");return(0,i.wg)(),(0,i.j4)(g,{title:t.$t("profile"),bordered:!1,"form-state":c.json,ref:"layout"},{headerContent:(0,i.w5)((function(){return[(0,i.Wm)(r,{name:"name",rules:t.rules.uniqueName("profiles",{id:c.pid})},{default:(0,i.w5)((function(){return[(0,i.Wm)(u,{placeholder:t.$t("as"),value:c.json.name,"onUpdate:value":n[0]||(n[0]=function(t){return c.json.name=t}),class:"width-200"},null,8,["placeholder","value"])]})),_:1},8,["rules"])]})),action:(0,i.w5)((function(){return[(0,i.Wm)(l,{type:"primary",onClick:s.validate},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,o.zw)(c.pid?t.$t("save"):t.$t("create")),1)]})),_:1},8,["onClick"])]})),default:(0,i.w5)((function(){return[(0,i.Wm)(m,{class:"row-mg"},{default:(0,i.w5)((function(){return[(0,i.Wm)(p,{class:"col-pd",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((function(){return[(0,i.Wm)(f,{class:"card mb-24",title:"Pipy "+t.$t("config"),bordered:!1},{default:(0,i.w5)((function(){return[(0,i.Wm)(l,{onClick:s.getDefaultPipyConfig,class:"profile-btn"},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,o.zw)(t.$t("reset")),1)]})),_:1},8,["onClick"]),(0,i.Wm)(d,{value:c.json.content.pipy_config,"onUpdate:value":n[1]||(n[1]=function(t){return c.json.content.pipy_config=t})},null,8,["value"])]})),_:1},8,["title"])]})),_:1}),(0,i.Wm)(p,{class:"col-pd",xl:12,lg:24,md:24,sm:24,xs:24},{default:(0,i.w5)((function(){return[(0,i.Wm)(f,{class:"card mb-24",title:"TCP "+t.$t("config"),bordered:!1},{default:(0,i.w5)((function(){return[(0,i.Wm)(h,{value:c.json.content.tcp_config,"onUpdate:value":n[2]||(n[2]=function(t){return c.json.content.tcp_config=t})},null,8,["value"])]})),_:1},8,["title"])]})),_:1})]})),_:1})]})),_:1},8,["title","form-state"])}],["__scopeId","data-v-31635114"]])}}]);