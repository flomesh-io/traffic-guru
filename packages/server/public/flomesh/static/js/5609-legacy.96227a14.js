"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[5609],{72744:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});a(68309);var n=a(66252),i=a(3577),s=a(87932),r=function(e){return(0,n.dD)("data-v-13190fca"),e=e(),(0,n.Cn)(),e}((function(){return(0,n._)("img",{src:s,style:{width:"200px"}},null,-1)}));var o=a(95082),u=(a(41539),a(54747),a(57658),a(9294)),c=a(93327),l=a(33907),d=a(54721),f=a(48025),g=a(13554),p={name:"RegistryDetail",i18n:a(89234),components:{JsEditor:u.Z,ServiceList:g.Z,Lb7Detail:d.Z,Lb4Detail:f.Z,RegistryBaseDetail:c.Z},data:function(){return{selectedKeys:"",selectedNS:[],namespaces:[],detail:{organization:null,type:"k8s",name:"",content:{domain:"",credit:"",autoUpstream:!1,autoApplication:!1,isGateway:!0,gatewayPath:"",gatewayPort:0},address:""},types:[{name:"eureka"},{name:"nacos"},{name:"zookeeper"},{name:"k8s"},{name:"consul"}],orgs:[],pjsConfig:"",pid:"",json:'{ "":"" }',config:"",noTitleKey:""}},computed:(0,o.Z)((0,o.Z)({},(0,l.rn)("setting",["isMobile"])),{},{namespaceTabs:function(){var e=[];return this.namespaces.forEach((function(t){e.push({key:t.id,tab:t.name,services:t.services.length})})),e}}),created:function(){var e=this;this.$gql.query("organizations{data{id,attributes{name}}}").then((function(t){e.orgs=t.data})),this.pid=this.$route.params.id||""},methods:{enabledChange:function(e){var t=this;this.$gql.mutation("updateServiceSync(id: ".concat(e.id,", data: $data){data{id}}"),{data:{deleted:!e.enabled}},{data:"ServiceInput!"}).then((function(){t.$message.success(t.$t("Save successfully"),3)}))},getDetail:function(e){this.detail=e.detail,this.namespaces=e.namespaces,this.selectedKeys=e.selectedKeys,this.selectedNS=e.selectedNS||[]},selectNS:function(e){var t=this;this.selectedNS={services:[]},this.detail.namespaces.forEach((function(a){a.id==e&&(t.selectedNS=a)}))},save7lb:function(e){this.$refs.Lb7Detail.save(e)},assignOrganization:function(){var e=this;this.$gql.mutation("updateNamespace(id:".concat(this.selectedNS.id,", data: $data){data{id}}"),{data:{organization:this.selectedNS.organizationId}},{data:"NamespaceInput!"}).then((function(){e.$refs.RegistryBaseDetail.loaddata(),e.$message.success(e.$t("Save successfully"),3)}))},assignOrganizationByItem:function(e,t){var a=this;this.$gql.mutation("updateService(id:".concat(e,", data: $data){data{id,attributes{organization{data{id}}}}}"),{data:{organization:t}},{data:"ServiceInput!"}).then((function(){a.$refs.RegistryBaseDetail.loaddata(),a.$message.success(a.$t("Save successfully"),3)}))},pjsChange:function(e){this.pjsConfig=e},getDefaultPjsConfig:function(){var e=this;fetch("pipy-4lb.js").then((function(e){return e.text()})).then((function(t){e.pjsConfig=t})).catch((function(e){}))},handleChange:function(){}}};var h=(0,a(83744).Z)(p,[["render",function(e,t,a,s,o,u){var c=(0,n.up)("a-result"),l=(0,n.up)("a-select-option"),d=(0,n.up)("a-select"),f=(0,n.up)("a-button"),g=(0,n.up)("ServiceList"),p=(0,n.up)("a-col"),h=(0,n.up)("a-row"),m=(0,n.up)("a-tab-pane"),v=(0,n.up)("a-card"),y=((0,n.up)("Lb4Detail"),(0,n.up)("Lb7Detail"),(0,n.up)("JsEditor")),b=(0,n.up)("a-tabs"),w=(0,n.up)("RegistryBaseDetail");return(0,n.wg)(),(0,n.j4)(w,{ref:"RegistryBaseDetail",pid:o.pid,types:o.types,onGetDetail:u.getDetail},{tabs:(0,n.w5)((function(){return[(0,n.Wm)(b,{type:"card",onChange:e.cardchange},{default:(0,n.w5)((function(){return[(0,n.Wm)(m,{key:"1",tab:e.$t("Namespace")},{default:(0,n.w5)((function(){return[""==o.pid?((0,n.wg)(),(0,n.j4)(c,{key:0,"sub-title":e.$t("Please save the registration certificate first")},{icon:(0,n.w5)((function(){return[r]})),_:1},8,["sub-title"])):(0,n.kq)("",!0),""!=o.pid?((0,n.wg)(),(0,n.j4)(h,{key:1,class:"row-mg"},{default:(0,n.w5)((function(){return[(0,n.Wm)(p,{class:"col-pd",xl:24,lg:24,md:24,sm:24,xs:24},{default:(0,n.w5)((function(){return[(0,n.Wm)(g,{mode:"registry","embed-services":o.selectedNS.services,"tab-list":u.namespaceTabs,tabKey:o.selectedKeys,"onUpdate:tabKey":t[1]||(t[1]=function(e){return o.selectedKeys=e}),embed:!0,metric:!1,"has-search":!1,onNsChange:u.selectNS,onEnabledChange:u.enabledChange},(0,n.Nv)({organization:(0,n.w5)((function(t){var a=t.item;return[a.organization?((0,n.wg)(),(0,n.j4)(d,{key:0,placeholder:e.$t("unset"),value:a.organization.id,"onUpdate:value":function(e){return a.organization.id=e},onChange:function(e){return u.assignOrganizationByItem(a.id,a.organization.id)},class:"width-180",ref:"select"},{default:(0,n.w5)((function(){return[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(o.orgs,(function(e,t){return(0,n.wg)(),(0,n.j4)(l,{value:e.id,key:t},{default:(0,n.w5)((function(){return[(0,n.Uk)((0,i.zw)(e.name),1)]})),_:2},1032,["value"])})),128))]})),_:2},1032,["placeholder","value","onUpdate:value","onChange"])):(0,n.kq)("",!0)]})),_:2},[e.$isPro?{name:"extra",fn:(0,n.w5)((function(){return[(0,n.Wm)(d,{placeholder:e.$t("unset"),value:o.selectedNS.organizationId,"onUpdate:value":t[0]||(t[0]=function(e){return o.selectedNS.organizationId=e}),class:"width-180",ref:"select"},{default:(0,n.w5)((function(){return[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(o.orgs,(function(e,t){return(0,n.wg)(),(0,n.j4)(l,{value:e.id,key:t},{default:(0,n.w5)((function(){return[(0,n.Uk)((0,i.zw)(e.name),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["placeholder","value"]),(0,n.Wm)(f,{class:"ml-10",type:"primary",onClick:u.assignOrganization},{default:(0,n.w5)((function(){return[(0,n.Uk)((0,i.zw)(e.$t("Assign Organization")),1)]})),_:1},8,["onClick"])]})),key:"0"}:void 0]),1032,["embed-services","tab-list","tabKey","onNsChange","onEnabledChange"])]})),_:1})]})),_:1})):(0,n.kq)("",!0)]})),_:1},8,["tab"]),(0,n.kq)("",!0),e.$isPro&&"k8s"!=o.detail.type?((0,n.wg)(),(0,n.j4)(m,{key:"3",tab:e.$t("config")},{default:(0,n.w5)((function(){return[(0,n.Wm)(v,{class:"card mb-24 nopd",bordered:!1},{default:(0,n.w5)((function(){return[(0,n.Wm)(y,{value:o.pjsConfig,onInput:u.pjsChange},null,8,["value","onInput"])]})),_:1})]})),_:1},8,["tab"])):(0,n.kq)("",!0)]})),_:1},8,["onChange"])]})),_:1},8,["pid","types","onGetDetail"])}],["__scopeId","data-v-13190fca"]])}}]);