"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[6019],{18531:function(t,e,n){n.r(e),n.d(e,{default:function(){return H}});var o=n(66252),a=n(3577),s=n.p+"static/img/flomesh-short.0517966e.png",r=n.p+"static/img/logo1.166eada4.png",i=function(t){return(0,o.dD)("data-v-f5fe9576"),t=t(),(0,o.Cn)(),t},l={class:"login-warpper"},u={class:"top"},c={class:"header"},d=i((function(){return(0,o._)("div",{class:"logo-mask"},null,-1)})),m=i((function(){return(0,o._)("img",{class:"logo-back",src:s},null,-1)})),f=i((function(){return(0,o._)("img",{alt:"logo",class:"logo",src:r},null,-1)})),p={key:"reg"},g={key:"forget"},h={key:"login"};var v=n(49963),w={key:1};n(34553),n(68309),n(69826),n(41539);var y=n(53962),F={name:"PageToggleTransition",props:{disabled:{type:Boolean},animate:{type:String,validator:function(t){return-1!=y.preset.findIndex((function(e){return e.name==t}))},default:"bounce"},direction:{type:String,default:null,validator:function(t){return["x","y","left","right","up","down","downLeft","upRight","downRight","upLeft","downBig","upBig","downLeft","downRight","topRight","bottomLeft","topLeft","bottomRight","default"].indexOf(t)>-1}},reverse:{type:[Boolean],default:!0}},computed:{enterAnimate:function(){return this.activeClass(!1)},leaveAnimate:function(){return this.activeClass(!0)}},methods:{activeClass:function(t){var e=this,n=y.preset.find((function(t){return e.animate==t.name}));if(null==n)return"";var o="";""!=(o=null==(o=null==this.direction?n.directions[0]:n.directions.find((function(t){return t==e.direction})))||"default"===o?"":o)&&(o=(o=t&&this.reverse?this.reversePosition(o,n.directions):o)[0].toUpperCase()+o.substring(1));var a=t?"Out":"In";return n.name+a+o},reversePosition:function(t,e){if(0==t.length||"x"==t||"y"==t)return t;var n=e.indexOf(t);return e[n=n%2==1?n-1:n+1]}}},S=n(83744);var k=(0,S.Z)(F,[["render",function(t,e,n,a,s,r){return n.disabled?((0,o.wg)(),(0,o.iD)("div",w,[(0,o.WI)(t.$slots,"default")])):((0,o.wg)(),(0,o.j4)(v.uT,{key:0,"enter-active-class":"animated ".concat(r.enterAnimate," page-toggle-enter-active"),"leave-active-class":"animated ".concat(r.leaveAnimate," page-toggle-leave-active")},{default:(0,o.w5)((function(){return[(0,o.WI)(t.$slots,"default")]})),_:3},8,["enter-active-class","leave-active-class"]))}]]),b={class:"common-layout"},$={class:"content"};var _=n(95082),Z=n(34238),I=n(33907),P={name:"CommonLayout",components:{PageFooter:Z.Z},computed:(0,_.Z)({},(0,I.rn)("setting",["footerLinks","copyright"]))};var W=(0,S.Z)(P,[["render",function(t,e,n,a,s,r){var i=(0,o.up)("PageFooter");return(0,o.wg)(),(0,o.iD)("div",b,[(0,o._)("div",$,[(0,o.WI)(t.$slots,"default",{},void 0,!0)]),(0,o.Wm)(i,{"link-list":t.footerLinks,copyright:t.copyright},null,8,["link-list","copyright"])])}],["__scopeId","data-v-1af41482"]]),z={class:"login login-form"},C={class:"login-foot"};n(57658),n(92222),n(54747);var R=n(93099),U=n(84471),T=n(8910),L=n(53539),j=n(70262),x=n(58426),E=n(70473),A=n(68695),O=n(76754),D=n(5216),q={name:"LoginForm",components:{SnsCode:L.Z,MdInput:T.Z,ArrowRightOutlined:x.Z,FormItem:O.Z},i18n:n(1610),inject:["last","next"],data:function(){return{loginCode:"pass",snsloading:!1,snsstatus:"free",snsnum:0,hover:!1,logging:!1,error:"",activeKey:"1",password:"",formState:{snscode:"",name:"",password:"",automatic:!0}}},computed:(0,_.Z)((0,_.Z)((0,_.Z)({},(0,I.rn)("rules",["rules"])),(0,I.Se)("account",["user"])),{},{systemName:function(){return this.$store.state.setting.systemName}}),methods:(0,_.Z)((0,_.Z)({},(0,I.OI)("account",["setUser","setPermissions","setRoles"])),{},{getCookies:function(){if(this.formState.name){var t=j.Z.get(this.formState.name);t&&(this.formState.password=(0,D.decrypt)(t))}},forget:function(){this.next()},handleFinish:function(){var t=this;this.logging=!0;var e=this.formState.name,n=this.formState.password,o=this.formState.snscode;(0,R.x4)(e,n,o,!0).then(this.afterLogin).catch((function(){t.logging=!1,t.$message.error(t.$t("The password or verification code is incorrect"),3)}))},passwordfocus:function(){this.$refs.password.getfocus()},snsfocus:function(){this.$refs.snscode.getfocus()},handleFinishFailed:function(){},validate:function(){var t=this;this.$refs.form.validateFields().then((function(){t.handleFinish()})).catch((function(){}))},afterLogin:function(t){var e=this;this.logging=!1;var a=t||{};if(!t.errors)if(a.jwt){this.formState.automatic?j.Z.set(this.formState.name,(0,D.encrypt)(this.formState.password)):j.Z.remove(this.formState.name),this.setUser((0,_.Z)({name:this.formState.name,avatar:"@AVATAR",address:"@CITY",position:"@POSITION"},a.user)),(0,U.EP)({token:a.jwt,expireAt:new Date((new Date).getTime()+72e5)},"basic");var s=n(61006);E.Z.open({message:this.$t("Login successfully"),icon:(0,o.h)("img",{src:s,width:35,height:35,style:"posirion:relative,left:-30px"}),placement:"bottomRight",description:this.formState.name+"，"+this.$t("Welcome back")});var r=null;(0,R.bG)().then((function(t){var n;null!==(n=t.data.role)&&void 0!==n&&n.id&&((0,R.Yj)({id:t.data.role.id}).then((function(t){r=t,e.setRoles(t),setTimeout((function(){e.$router.push("/workplace")}),300)})),e.$gql.query("userOrganizationRoles(pagination:{limit: ".concat(e.$DFT_LIMIT,"},filters:{user:{id:{eq:").concat(a.user.id,"}}}){data{id,attributes{\n\t\t\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\t\t\tproject{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\t\torganization{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\t\trole{data{id,attributes{name}}}\n\t\t\t\t\t\t\t\t}}}")).then((function(t){e.setPermissions(t.data),t.data.forEach((function(t){t.role&&t.role.id&&(0,R.Yj)({id:t.role.id}).then((function(n){var o=[];n.permissions.forEach((function(e){o.push((0,_.Z)((0,_.Z)({},e),{},{type:t.type,project:t.project,organization:t.organization}))})),r.permissions=r.permissions.concat(o),e.setRoles(r)}))}))})))}));var i=n(75688)("./config".concat(".pro")).default;(0,A.tO)(i)}else this.error=a.message}})};const M=(0,S.Z)(q,[["render",function(t,e,n,s,r,i){var l=(0,o.up)("a-alert"),u=(0,o.up)("MdInput"),c=(0,o.up)("FormItem"),d=(0,o.up)("SnsCode"),m=(0,o.up)("a-switch"),f=(0,o.up)("ArrowRightOutlined"),p=(0,o.up)("a-button"),g=(0,o.up)("a-form-item"),h=(0,o.up)("a-form");return(0,o.wg)(),(0,o.iD)("div",z,[(0,o.Wm)(h,{model:r.formState,"wrapper-col":{span:24},onFinish:i.handleFinish,onFinishFailed:i.handleFinishFailed,ref:"form"},{default:(0,o.w5)((function(){var n;return[(0,o.wy)((0,o.Wm)(l,{type:"error",closable:!0,message:r.error,"show-icon":"",class:"mb-24"},null,8,["message"]),[[v.F8,r.error]]),(0,o.Wm)(c,{class:"mb-20",name:"name",rules:t.rules.name},{default:(0,o.w5)((function(){return[(0,o.Wm)(u,{icon:"email",size:"large","auto-complete":"new-password",value:r.formState.name,"onUpdate:value":e[0]||(e[0]=function(t){return r.formState.name=t}),placeholder:t.$t("Please input user or email"),onPressEnter:i.passwordfocus},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)(t.$t("User")),1)]})),_:1},8,["value","placeholder","onPressEnter"])]})),_:1},8,["rules"]),(0,o.Wm)(c,{class:"mb-20",name:"password",rules:t.rules.password},{default:(0,o.w5)((function(){return[(0,o.Wm)(u,{type:"password",icon:"password",ref:"password",onFocus:i.getCookies,"auto-complete":"new-password",size:"large",value:r.formState.password,"onUpdate:value":e[1]||(e[1]=function(t){return r.formState.password=t}),name:"title",onPressEnter:i.snsfocus,placeholder:t.$t("Please input password")},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)(t.$t("Password")),1)]})),_:1},8,["onFocus","value","onPressEnter","placeholder"])]})),_:1},8,["rules"]),(null===(n=t.user)||void 0===n?void 0:n.name)!=r.formState.name?((0,o.wg)(),(0,o.j4)(d,{key:0,class:"mb-20",ref:"snscode",value:r.formState.snscode,"onUpdate:value":e[2]||(e[2]=function(t){return r.formState.snscode=t}),onValidate:i.validate,username:r.formState.name},null,8,["value","onValidate","username"])):(0,o.kq)("",!0),(0,o._)("div",C,[(0,o.Wm)(m,{checked:r.formState.automatic,"onUpdate:checked":e[3]||(e[3]=function(t){return r.formState.automatic=t}),size:"small","default-checked":"",class:"login-switch"},null,8,["checked"]),(0,o.Uk)(" "+(0,a.zw)(t.$t("Trust device"))+" ",1),"pass"!=r.loginCode?((0,o.wg)(),(0,o.iD)("a",{key:0,onClick:e[4]||(e[4]=function(){return i.forget&&i.forget.apply(i,arguments)}),class:"float-right"},[(0,o.Uk)((0,a.zw)(t.$t("Forget"))+" ",1),(0,o.Wm)(f)])):(0,o.kq)("",!0)]),(0,o.Wm)(g,null,{default:(0,o.w5)((function(){return[(0,o.Wm)(p,{loading:r.logging,class:"login-btn",size:"large",onClick:i.validate,type:"primary"},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)(t.$t("Login")),1)]})),_:1},8,["loading","onClick"])]})),_:1})]})),_:1},8,["model","onFinish","onFinishFailed"])])}],["__scopeId","data-v-070b7eac"]]);var N=M,V=n(72424),Y={class:"login reg-form"};var B={name:"RegForm",components:{MdInput:T.Z,ArrowRightOutlined:x.Z,FormItem:O.Z,SnsCode:L.Z},i18n:n(1610),inject:["next"],props:["nofoot"],data:function(){return{snsloading:!1,snsstatus:"free",snsnum:0,hover:!1,logging:!1,error:"",activeKey:"1",user:"",password:"",formState:{snscode:"",name:"",email:"",password:"",automatic:!0}}},computed:(0,_.Z)((0,_.Z)({},(0,I.rn)("rules",["rules"])),{},{systemName:function(){return this.$store.state.setting.systemName}}),methods:(0,_.Z)((0,_.Z)({},(0,I.OI)("account",["setUser","setPermissions","setRoles"])),{},{gologin:function(){this.next()},handleFinish:function(){var t=this;this.logging=!0;var e=this.formState.name,n=this.formState.email,o=this.formState.snscode,a=this.formState.password;(0,R.z2)(e,n,a,o).then(this.afterLogin).catch((function(e){t.logging=!1,e.length&&e[0].message?t.$message.error(t.$t(e[0].message),3):t.$message.error(t.$t("The email already exists"),3)}))},passwordfocus:function(){this.$refs.password.getfocus()},snsfocus:function(){this.$refs.snscode.getfocus()},handleFinishFailed:function(){},validate:function(){var t=this;this.$refs.form.validateFields().then((function(){t.handleFinish()})).catch((function(){}))},afterLogin:function(t){var e=this;this.logging=!1;var a=t;if(!t.errors)if(a.jwt){this.setUser({name:this.formState.name,avatar:"@AVATAR",address:"@CITY",position:"@POSITION"}),(0,U.EP)({token:a.jwt,expireAt:new Date((new Date).getTime()+18e5)},"basic");var s=n(61006);E.Z.open({message:this.$t("Login successfully"),icon:(0,o.h)("img",{src:s,width:35,height:35,style:"posirion:relative,left:-30px"}),placement:"bottomRight",description:this.formState.name+"，"+this.$t("Welcome back")});var r=null;(0,R.bG)().then((function(t){var n;null!==(n=t.data.role)&&void 0!==n&&n.id&&(0,R.Yj)({id:t.data.role.id}).then((function(t){r=t,e.setRoles(t),setTimeout((function(){e.$router.push("/workplace")}),300),e.$gql.query("userOrganizationRoles(pagination:{limit: ".concat(e.$DFT_LIMIT,"},filters:{user:{id:{eq:").concat(a.user.id,"}}}){data{id,attributes{\n\t\t\t\t\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\t\t\t\t\tproject{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\t\t\t\torganization{data{id,attributes{name}}},\n\t\t\t\t\t\t\t\t\t\t\trole{data{id,attributes{name}}}\n\t\t\t\t\t\t\t\t\t\t}}}")).then((function(t){e.setPermissions(t.data),t.data.forEach((function(t){t.role&&t.role.id&&(0,R.Yj)({id:t.role.id}).then((function(n){var o=[];n.permissions.forEach((function(e){o.push((0,_.Z)((0,_.Z)({},e),{},{type:t.type,project:t.project,organization:t.organization}))})),r.permissions=r.permissions.concat(o),e.setRoles(r)}))}))}))}))}))}else this.error=a.message}})};var G=(0,S.Z)(B,[["render",function(t,e,n,s,r,i){var l=(0,o.up)("a-alert"),u=(0,o.up)("MdInput"),c=(0,o.up)("FormItem"),d=(0,o.up)("SnsCode"),m=((0,o.up)("ArrowRightOutlined"),(0,o.up)("a-button")),f=(0,o.up)("a-form-item"),p=(0,o.up)("a-form");return(0,o.wg)(),(0,o.iD)("div",Y,[(0,o.Wm)(p,{model:r.formState,"wrapper-col":{span:24},onFinish:i.handleFinish,onFinishFailed:i.handleFinishFailed,rules:t.getRules,ref:"form"},{default:(0,o.w5)((function(){return[(0,o.wy)((0,o.Wm)(l,{type:"error",closable:!0,message:r.error,"show-icon":"",class:"mb-24"},null,8,["message"]),[[v.F8,r.error]]),(0,o.Wm)(c,{class:"mb-20",name:"name",rules:t.rules.name},{default:(0,o.w5)((function(){return[(0,o.Wm)(u,{icon:"user",size:"large",value:r.formState.name,"onUpdate:value":e[0]||(e[0]=function(t){return r.formState.name=t}),placeholder:t.$t("Please input user name"),onPressEnter:i.passwordfocus},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)(t.$t("User")),1)]})),_:1},8,["value","placeholder","onPressEnter"])]})),_:1},8,["rules"]),(0,o.Wm)(c,{class:"mb-20",name:"email",rules:t.rules.email},{default:(0,o.w5)((function(){return[(0,o.Wm)(u,{icon:"email",size:"large",value:r.formState.email,"onUpdate:value":e[1]||(e[1]=function(t){return r.formState.email=t}),placeholder:t.$t("Please input email"),onPressEnter:i.passwordfocus},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)(t.$t("Email")),1)]})),_:1},8,["value","placeholder","onPressEnter"])]})),_:1},8,["rules"]),(0,o.Wm)(d,{class:"mb-20",ref:"snscode",value:r.formState.snscode,"onUpdate:value":e[2]||(e[2]=function(t){return r.formState.snscode=t}),onValidate:i.validate,username:r.formState.email},null,8,["value","onValidate","username"]),(0,o.Wm)(c,{class:"mb-20",name:"password",rules:t.rules.password},{default:(0,o.w5)((function(){return[(0,o.Wm)(u,{type:"password",icon:"password",ref:"password","auto-complete":"new-password",size:"large",value:r.formState.password,"onUpdate:value":e[3]||(e[3]=function(t){return r.formState.password=t}),name:"title",onPressEnter:i.snsfocus,placeholder:t.$t("Please input password")},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)(t.$t("Password")),1)]})),_:1},8,["value","onPressEnter","placeholder"])]})),_:1},8,["rules"]),(0,o.kq)("",!0),n.nofoot?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(f,{key:1},{default:(0,o.w5)((function(){return[(0,o.Wm)(m,{loading:r.logging,class:"login-btn primary",size:"large",onClick:i.validate,type:"dashed",ghost:""},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)(t.$t("Register initial user")),1)]})),_:1},8,["loading","onClick"])]})),_:1}))]})),_:1},8,["model","onFinish","onFinishFailed","rules"])])}],["__scopeId","data-v-28b1ecdf"]]),K={name:"Login",components:{CommonLayout:W,LoginForm:N,ForgetForm:V.Z,RegForm:G,PageToggleTransition:k},i18n:n(1610),provide:function(){return{next:this.next,last:this.last}},data:function(){return{step:0,direction:0,version:"pro"}},created:function(){this.isInitialized()},methods:{isInitialized:function(){var t=this;this.$gql.query("getInitialized").then((function(e){e||t.last()}))},next:function(){this.direction=1,this.step+=this.direction},last:function(){this.direction=-1,this.step+=this.direction}}};var H=(0,S.Z)(K,[["render",function(t,e,n,s,r,i){var v=(0,o.up)("a-tag"),w=(0,o.up)("RegForm"),y=(0,o.up)("ForgetForm"),F=(0,o.up)("LoginForm"),S=(0,o.up)("PageToggleTransition"),k=(0,o.up)("CommonLayout");return(0,o.wg)(),(0,o.j4)(k,null,{default:(0,o.w5)((function(){return[(0,o._)("div",l,[(0,o._)("div",u,[(0,o._)("div",c,[d,m,f,(0,o.Wm)(v,{class:"logo-tag",color:"#00adef"},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)("free"==r.version?"Community":r.version),1)]})),_:1})])]),(0,o.Wm)(S,{direction:r.direction<0?"left":"right",animate:"bounce"},{default:(0,o.w5)((function(){return[-1==r.step?((0,o.wg)(),(0,o.iD)("div",p,[(0,o.Wm)(w)])):1==r.step?((0,o.wg)(),(0,o.iD)("div",g,[(0,o.Wm)(y)])):((0,o.wg)(),(0,o.iD)("div",h,[(0,o.Wm)(F)]))]})),_:1},8,["direction"])])]})),_:1})}],["__scopeId","data-v-f5fe9576"]])}}]);