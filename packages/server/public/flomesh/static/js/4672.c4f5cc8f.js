"use strict";(self.webpackChunkflomesh_load_balancer=self.webpackChunkflomesh_load_balancer||[]).push([[4672],{1299:function(e,t,a){a.d(t,{Z:function(){return r}});var l=a(66252),s=a(3577);const i={key:0,class:"title"};var d={name:"DetailList",props:{title:{type:String,required:!1,default:""},col:{type:Number,required:!1,default:3},size:{type:String,required:!1,default:"large"},layout:{type:String,required:!1,default:"horizontal"}}};var r=(0,a(83744).Z)(d,[["render",function(e,t,a,d,r,n){const u=(0,l.up)("a-row");return(0,l.wg)(),(0,l.iD)("div",{class:(0,s.C_)(["detail-list","small"===a.size?"small":"large","vertical"===a.layout?"vertical":"horizontal"]),style:(0,s.j5)("flex-"+a.col)},[a.title?((0,l.wg)(),(0,l.iD)("div",i,(0,s.zw)(a.title),1)):(0,l.kq)("",!0),(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l.WI)(e.$slots,"default")])),_:3})],6)}]])},13589:function(e,t,a){a.d(t,{Z:function(){return n}});var l=a(66252),s=a(3577);const i={class:"detail-content"};const d={1:{xs:24},2:{xs:24,sm:12},3:{xs:24,sm:12,md:8},4:{xs:24,sm:12,md:6}};var r={name:"DetailListItem",i18n:a(39945),props:{name:{type:String,required:!1,default:""},rules:{type:Array,required:!1,default(){return[]}},term:{type:String,required:!1,default:""},termTop:{type:Boolean}},data(){return{col:2,responsive:d}},computed:{getRules(){return this.rules.map((e=>(e.message=this.$t(e.message),e))),this.rules}},created(){this.$parent&&this.$parent.$parent&&this.$parent.$parent.col>0&&(this.col=this.$parent.$parent.col)},methods:{}};var n=(0,a(83744).Z)(r,[["render",function(e,t,a,d,r,n){const u=(0,l.up)("a-form-item"),c=(0,l.up)("a-col");return(0,l.wg)(),(0,l.j4)(c,(0,l.dG)({class:"detail-list-content flex"},r.responsive[r.col]),{default:(0,l.w5)((()=>[(0,l._)("div",{class:(0,s.C_)(a.termTop?"term top":"term")},(0,s.zw)(a.term),3),(0,l._)("div",i,[a.rules?((0,l.wg)(),(0,l.j4)(u,{key:0,name:a.name,rules:n.getRules},{default:(0,l.w5)((()=>[(0,l.WI)(e.$slots,"default")])),_:3},8,["name","rules"])):(0,l.WI)(e.$slots,"default",{key:1})])])),_:3},16)}]])},73589:function(e,t,a){a.r(t),a.d(t,{default:function(){return o}});var l=a(66252),s=a(3577);var i=a(61103),d=a(1299),r=a(33907),n=a(50976),u=a(13589),c={name:"Detail",i18n:a(89234),components:{DetailListItem:u.Z,DetailList:d.Z,PageLayout:i.Z,AutoForm:n.Z},data(){return{type:"7",Active:[{label:"Active Healthcheck - Healthy",data:[[{label:"HTTP Statuses",value:[200,302]}]]},{label:"Active Healthcheck - Unhealthy",data:[[{label:"HTTP Statuses",value:[404,429,500,501,502,503,504,505]}]]}],Passive:[{label:"Passive Healthcheck - Healthy",data:[[{label:"HTTP Statuses",value:[200,201,202,203,204,205,206,300]}]]},{label:"Passive Healthcheck - Unhealthy",data:[[{label:"HTTP Statuses",value:[404,500,503]}]]}],visible:!1,visible2:!1,detail:{isActive:!0,content:[],name:""},loading:!0,logs:[],pid:"",param:{lbId:"",query:"",startTime:"",endTime:"",pageNo:1,pageSize:10},profiles:[],clusters:[],tps:[],activeTabKey:"2"}},computed:{...(0,r.rn)({rules:e=>e.rules.rules,isMobile:e=>e.setting.isMobile})},created(){this.pid=this.$route.params.id||"",""!=this.pid?(this.loading=!0,this.$gql.query(`healthcheck(id: ${this.pid}){data{id,attributes{content,name,createdAt}}}`).then((e=>{this.detail=e.data,this.detail.isActive=!0,this.Active[0].data[0][0].value=this.detail.content.success,this.Active[1].data[0][0].value=this.detail.content.failure,this.loading=!1}))):(this.detail={isActive:!0,name:""},this.loading=!1)},methods:{onTabChange(e){},validForm(){return""==this.detail.name?(this.$message.error(this.$t("The name cannot be empty"),3),!1):0==this.Active[0].data[0][0].value.length?(this.$message.error(this.$t("The HTTP Statuses cannot be empty"),3),!1):0!=this.Active[1].data[0][0].value.length||(this.$message.error(this.$t("The HTTP Statuses cannot be empty"),3),!1)},valid(){this.$refs.layout.$refs.form.validateFields().then((()=>{this.save()})).catch((()=>{}))},save(){if(!this.validForm())return;let e={};this.detail.isActive?(e.success=this.Active[0].data[0][0].value,e.failure=this.Active[1].data[0][0].value):(e.success=this.Passive[0].data[0][0].value,e.failure=this.Passive[1].data[0][0].value),""!=this.pid?this.$gql.mutation(`updateHealthcheck(id:${this.pid}, data: $data){data{id}}`,{data:{name:this.detail.name,content:e}},{data:"HealthcheckInput!"}).then((()=>{this.$message.success(this.$t("Save successfully"),3),this.$closePage(this.$route)})):this.$gql.mutation("createHealthcheck(data: $data){data{id}}",{data:{name:this.detail.name,content:e}},{data:"HealthcheckInput!"}).then((e=>{this.pid=e.data.id,this.$message.success(this.$t("Created successfully"),3),this.$closePage(this.$route)}))},handleChange(){},hide(){this.visible=!1,this.save()}}};var o=(0,a(83744).Z)(c,[["render",function(e,t,a,i,d,r){const n=(0,l.up)("a-input"),u=(0,l.up)("DetailListItem"),c=(0,l.up)("a-switch"),o=(0,l.up)("a-typography-text"),h=(0,l.up)("DetailList"),m=(0,l.up)("a-button"),p=(0,l.up)("AutoForm"),v=(0,l.up)("a-card"),f=(0,l.up)("a-col"),g=(0,l.up)("a-row"),$=(0,l.up)("PageLayout");return(0,l.wg)(),(0,l.j4)($,{title:d.detail.name?d.detail.name:e.$t("Healthcheck"),"form-state":d.detail,ref:"layout"},{headerContent:(0,l.w5)((()=>[(0,l.Wm)(h,{size:"small",col:1},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{term:e.$t("as"),rules:e.rules.uniqueName("healthchecks",{id:d.pid}),name:"name"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{placeholder:e.$t("unset"),value:d.detail.name,"onUpdate:value":t[0]||(t[0]=e=>d.detail.name=e),class:"width-200"},null,8,["placeholder","value"])])),_:1},8,["term","rules"]),(0,l.Wm)(u,{term:e.$t("Type")},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{size:"small",checked:d.detail.isActive,"onUpdate:checked":t[1]||(t[1]=e=>d.detail.isActive=e),class:"a-switch"},null,8,["checked"]),(0,l.Wm)(o,{type:"secondary"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(d.detail.isActive?e.$t("Active Healthcheck"):e.$t("Passive Healthcheck")),1)])),_:1})])),_:1},8,["term"])])),_:1})])),action:(0,l.w5)((()=>[(0,l.Wm)(m,{type:"primary",onClick:r.valid},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(""!=d.pid?e.$t("save"):e.$t("create")),1)])),_:1},8,["onClick"])])),default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:"row-mg"},{default:(0,l.w5)((()=>[d.detail.isActive?((0,l.wg)(),(0,l.j4)(f,{key:0,class:"col-pd",xl:24,lg:24,md:24,sm:24,xs:24},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.Active,((t,a)=>((0,l.wg)(),(0,l.j4)(v,{key:a,class:"card mb-24",title:e.$t(t.label),bordered:!1,loading:d.loading},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{fields:t.data},null,8,["fields"])])),_:2},1032,["title","loading"])))),128))])),_:1})):(0,l.kq)("",!0),d.detail.isActive?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(f,{key:1,class:"col-pd",xl:24,lg:24,md:24,sm:24,xs:24},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.Passive,((t,a)=>((0,l.wg)(),(0,l.j4)(v,{key:a,class:"card mb-24",title:e.$t(t.label),bordered:!1,loading:d.loading},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{fields:t.data},null,8,["fields"])])),_:2},1032,["title","loading"])))),128))])),_:1}))])),_:1})])),_:1},8,["title","form-state"])}],["__scopeId","data-v-35e2abac"]])}}]);